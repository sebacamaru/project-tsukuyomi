const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./browserAll-Csf_PADn.js","./Filter-BEjgMG_t.js","./DOMContainer-BHNsiAfU.js","./FilterSystem-DrHbQy25.js","./CanvasPool-CcMbyN3l.js","./init-dmmqi5Ze.js","./webworkerAll-Ckec8k24.js","./WebGPURenderer-B3DD5gR8.js","./SharedSystems-BiYNgiaQ.js","./WebGPURenderer-DyQmMnaz.js","./WebGLRenderer-BEQqwbMU.js","./WebGLRenderer-DMVCX7Hw.js"])))=>i.map(i=>d[i]);
import{$ as e,$t as t,A as n,An as r,At as i,B as a,Bn as o,Bt as s,C as c,Cn as l,Ct as u,D as d,Dn as f,Dt as p,E as m,En as h,Et as g,F as _,Fn as v,Ft as y,G as b,Gn as x,Gt as S,H as ee,Hn as C,Ht as w,I as T,In as E,It as D,J as O,Jt as k,K as A,Kt as j,L as te,Ln as ne,Lt as M,M as re,Mn as ie,Mt as N,N as ae,Nn as P,Nt as oe,O as se,On as F,Ot as ce,P as le,Pn as ue,Pt as de,Q as I,Qt as L,R as fe,Rn as pe,Rt as me,S as he,Sn as ge,St as _e,T as ve,Tn as ye,Tt as be,U as xe,Un as R,Ut as z,V as B,Vn as Se,Vt as Ce,W as we,Wn as Te,Wt as Ee,X as De,Xt as Oe,Y as V,Yt as ke,Z as Ae,Zt as je,_ as Me,_n as Ne,_t as Pe,a as Fe,an as Ie,at as Le,b as Re,bn as ze,bt as Be,c as Ve,cn as He,ct as Ue,d as We,dn as Ge,dt as Ke,en as qe,et as Je,f as Ye,fn as Xe,ft as Ze,g as Qe,gn as $e,gt as et,h as tt,hn as nt,ht as rt,i as it,in as at,it as ot,j as st,jn as ct,jt as lt,k as ut,kn as H,kt as dt,l as ft,ln as pt,lt as mt,m as ht,mn as gt,mt as _t,n as vt,nn as yt,nt as bt,o as xt,on as St,ot as Ct,p as wt,pn as Tt,pt as Et,q as Dt,qt as Ot,r as kt,rn as At,rt as jt,s as Mt,sn as Nt,st as Pt,t as Ft,tn as It,tt as Lt,u as Rt,un as zt,ut as Bt,v as Vt,vn as Ht,vt as Ut,w as Wt,wn as Gt,wt as U,x as Kt,xn as qt,xt as Jt,y as Yt,yn as Xt,yt as Zt,z as Qt,zn as $t,zt as W}from"./Filter-BEjgMG_t.js";import{f as en}from"./index-fQczqod7.js";import{a as tn,c as nn,d as rn,f as an,i as on,l as sn,m as cn,n as ln,o as un,p as dn,r as fn,s as pn,t as mn,u as hn}from"./DOMContainer-BHNsiAfU.js";import{$ as gn,$t as _n,A as vn,An as yn,At as bn,B as xn,Bn as Sn,Bt as Cn,C as wn,Cn as Tn,Ct as En,D as Dn,Dn as On,Dt as kn,E as An,En as jn,Et as Mn,F as Nn,Fn as Pn,Ft as Fn,G as In,Gn as Ln,Gt as Rn,H as zn,Hn as Bn,Ht as Vn,I as Hn,In as Un,It as Wn,J as Gn,Jt as Kn,K as qn,Kt as Jn,L as Yn,Ln as Xn,Lt as Zn,M as Qn,Mn as $n,Mt as er,N as tr,Nn as nr,Nt as rr,O as ir,On as ar,Ot as or,P as sr,Pn as cr,Pt as lr,Q as ur,Qt as dr,R as fr,Rn as pr,Rt as mr,S as hr,Sn as gr,St as _r,T as vr,Tn as G,Tt as yr,U as br,Un as K,Ut as xr,V as Sr,Vn as Cr,Vt as wr,W as Tr,Wn as Er,Wt as Dr,X as Or,Xt as kr,Y as Ar,Yt as jr,Z as Mr,Zt as Nr,_ as Pr,_n as Fr,_t as Ir,a as Lr,an as Rr,at as zr,b as Br,bn as Vr,bt as Hr,c as Ur,cn as Wr,ct as Gr,d as Kr,dn as qr,dt as Jr,en as Yr,et as Xr,f as Zr,fn as Qr,ft as $r,g as ei,gn as ti,gt as ni,h as ri,hn as ii,ht as ai,i as oi,in as si,it as ci,j as li,jn as ui,jt as di,k as fi,kn as pi,kt as mi,l as hi,ln as gi,lt as _i,m as vi,mn as yi,mt as bi,n as xi,nn as Si,nt as Ci,o as wi,on as Ti,ot as Ei,p as Di,pn as Oi,pt as ki,q as Ai,qt as ji,r as Mi,rn as Ni,rt as Pi,s as Fi,sn as Ii,st as Li,t as Ri,tn as zi,tt as Bi,u as Vi,un as Hi,ut as Ui,v as Wi,vn as Gi,vt as Ki,w as qi,wn as Ji,wt as Yi,x as Xi,xn as Zi,xt as Qi,y as $i,yn as ea,yt as ta,z as na,zn as ra,zt as ia}from"./FilterSystem-DrHbQy25.js";import{n as aa,r as oa,t as sa}from"./CanvasPool-CcMbyN3l.js";import{$ as ca,A as la,B as ua,C as da,D as fa,E as pa,F as ma,G as ha,H as ga,I as _a,J as va,K as ya,L as ba,M as xa,N as Sa,O as Ca,P as wa,Q as Ta,R as Ea,S as Da,T as Oa,U as ka,V as Aa,W as ja,X as Ma,Y as Na,Z as Pa,_ as Fa,a as Ia,at as La,b as Ra,c as za,d as Ba,et as Va,f as Ha,g as Ua,h as Wa,i as Ga,it as Ka,j as qa,k as Ja,l as Ya,m as Xa,n as Za,nt as Qa,o as $a,ot as eo,p as to,q as no,r as ro,rt as io,s as ao,t as oo,tt as so,u as co,v as lo,w as uo,x as fo,y as po,z as mo}from"./SharedSystems-BiYNgiaQ.js";import{$ as ho,A as go,B as _o,C as vo,D as yo,E as bo,F as xo,G as So,H as Co,I as wo,J as To,K as Eo,L as Do,M as Oo,N as ko,O as Ao,P as jo,Q as Mo,R as No,S as Po,T as Fo,U as Io,V as Lo,W as Ro,X as zo,Y as Bo,Z as Vo,_ as Ho,a as Uo,at as Wo,b as Go,c as Ko,d as qo,et as Jo,f as Yo,g as Xo,h as Zo,i as Qo,it as $o,j as es,k as ts,l as ns,m as rs,n as is,nt as as,o as os,ot as ss,p as cs,q as ls,r as us,rt as ds,s as fs,st as ps,t as ms,tt as hs,u as gs,v as _s,w as vs,x as ys,y as bs,z as xs}from"./WebGLRenderer-DMVCX7Hw.js";import{A as Ss,C as Cs,D as ws,E as Ts,M as Es,O as Ds,S as Os,T as ks,_ as As,a as js,b as Ms,c as Ns,d as Ps,f as Fs,g as Is,h as Ls,i as Rs,j as zs,k as Bs,l as Vs,m as Hs,n as Us,o as Ws,p as Gs,r as Ks,s as qs,t as Js,u as Ys,v as Xs,w as Zs,x as Qs,y as $s}from"./WebGPURenderer-DyQmMnaz.js";function ec(e,t,n,r,i,a,o,s){let c=o-n,l=s-r,u=i-n,d=a-r,f=e-n,p=t-r,m=c*c+l*l,h=c*u+l*d,g=c*f+l*p,_=u*u+d*d,v=u*f+d*p,y=1/(m*_-h*h),b=(_*g-h*v)*y,x=(m*v-h*g)*y;return b>=0&&x>=0&&b+x<1}var tc=class e{constructor(e=0,t=0,n=0,r=0,i=0,a=0){this.type=`triangle`,this.x=e,this.y=t,this.x2=n,this.y2=r,this.x3=i,this.y3=a}contains(e,t){let n=(this.x-this.x3)*(t-this.y3)-(this.y-this.y3)*(e-this.x3),r=(this.x2-this.x)*(t-this.y)-(this.y2-this.y)*(e-this.x);if(n<0!=r<0&&n!==0&&r!==0)return!1;let i=(this.x3-this.x2)*(t-this.y2)-(this.y3-this.y2)*(e-this.x2);return i===0||i<0==n+r<=0}strokeContains(e,t,n,r=.5){let i=n/2,a=i*i,{x:o,x2:s,x3:c,y:l,y2:u,y3:d}=this;return or(e,t,o,l,s,d)<=a||or(e,t,s,u,c,d)<=a||or(e,t,c,d,o,l)<=a}clone(){return new e(this.x,this.y,this.x2,this.y2,this.x3,this.y3)}copyFrom(e){return this.x=e.x,this.y=e.y,this.x2=e.x2,this.y2=e.y2,this.x3=e.x3,this.y3=e.y3,this}copyTo(e){return e.copyFrom(this),e}getBounds(e){e||=new Tt;let t=Math.min(this.x,this.x2,this.x3),n=Math.max(this.x,this.x2,this.x3),r=Math.min(this.y,this.y2,this.y3),i=Math.max(this.y,this.y2,this.y3);return e.x=t,e.y=r,e.width=n-t,e.height=i-r,e}},nc={extension:{type:C.Environment,name:`browser`,priority:-1},test:()=>!0,load:async()=>{await en(()=>import(`./browserAll-Csf_PADn.js`),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url)}},rc={extension:{type:C.Environment,name:`webworker`,priority:0},test:()=>typeof self<`u`&&self.WorkerGlobalScope!==void 0,load:async()=>{await en(()=>import(`./webworkerAll-Ckec8k24.js`),__vite__mapDeps([6,1,3,4,5]),import.meta.url)}},ic=`
in vec2 vTextureCoord;
in vec4 vColor;

out vec4 finalColor;

uniform float uBlend;

uniform sampler2D uTexture;
uniform sampler2D uBackTexture;

{FUNCTIONS}

void main()
{ 
    vec4 back = texture(uBackTexture, vTextureCoord);
    vec4 front = texture(uTexture, vTextureCoord);
    float blendedAlpha = front.a + back.a * (1.0 - front.a);
    
    {MAIN}
}
`,ac=`in vec2 aPosition;
out vec2 vTextureCoord;
out vec2 backgroundUv;

uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,oc=`
struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct BlendUniforms {
  uBlend:f32,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;
@group(0) @binding(3) var uBackTexture: texture_2d<f32>;

@group(1) @binding(0) var<uniform> blendUniforms : BlendUniforms;


struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}
  
@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition)
  );
}

{FUNCTIONS}

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>
) -> @location(0) vec4<f32> {


   var back =  textureSample(uBackTexture, uSampler, uv);
   var front = textureSample(uTexture, uSampler, uv);
   var blendedAlpha = front.a + back.a * (1.0 - front.a);
   
   var out = vec4<f32>(0.0,0.0,0.0,0.0);

   {MAIN}

   return out;
}`,q=class extends Ft{constructor(e){let t=e.gpu,n=sc({source:oc,...t}),r=B.from({vertex:{source:n,entryPoint:`mainVertex`},fragment:{source:n,entryPoint:`mainFragment`}}),i=e.gl,a=sc({source:ic,...i}),o=V.from({vertex:ac,fragment:a}),s=new tt({uBlend:{value:1,type:`f32`}});super({gpuProgram:r,glProgram:o,blendRequired:!0,resources:{blendUniforms:s,uBackTexture:W.EMPTY}})}};function sc(e){let{source:t,functions:n,main:r}=e;return t.replace(`{FUNCTIONS}`,n).replace(`{MAIN}`,r)}var cc=`
	float getLuminosity(vec3 c) {
		return 0.3 * c.r + 0.59 * c.g + 0.11 * c.b;
	}

	vec3 setLuminosity(vec3 c, float lum) {
		float modLum = lum - getLuminosity(c);
		vec3 color = c.rgb + vec3(modLum);

		// clip back into legal range
		modLum = getLuminosity(color);
		vec3 modLumVec = vec3(modLum);

		float cMin = min(color.r, min(color.g, color.b));
		float cMax = max(color.r, max(color.g, color.b));

		if(cMin < 0.0) {
			color = mix(modLumVec, color, modLum / (modLum - cMin));
		}

		if(cMax > 1.0) {
			color = mix(modLumVec, color, (1.0 - modLum) / (cMax - modLum));
		}

		return color;
	}

	float getSaturation(vec3 c) {
		return max(c.r, max(c.g, c.b)) - min(c.r, min(c.g, c.b));
	}

	vec3 setSaturationMinMidMax(vec3 cSorted, float s) {
		vec3 colorSorted = cSorted;

		if(colorSorted.z > colorSorted.x) {
			colorSorted.y = (((colorSorted.y - colorSorted.x) * s) / (colorSorted.z - colorSorted.x));
			colorSorted.z = s;
		}
		else {
			colorSorted.y = 0.0;
			colorSorted.z = 0.0;
		}

		colorSorted.x = 0.0;

		return colorSorted;
	}

	vec3 setSaturation(vec3 c, float s) {
		vec3 color = c;

		if(color.r <= color.g && color.r <= color.b) {
			if(color.g <= color.b) {
				color = setSaturationMinMidMax(color.rgb, s).rgb;
			}
			else {
				color = setSaturationMinMidMax(color.rbg, s).rbg;
			}
		}
		else if(color.g <= color.r && color.g <= color.b) {
			if(color.r <= color.b) {
				color = setSaturationMinMidMax(color.grb, s).grb;
			}
			else {
				color = setSaturationMinMidMax(color.gbr, s).gbr;
			}
		}
		else {
			// Using bgr for both fixes part of hue
			if(color.r <= color.g) {
				color = setSaturationMinMidMax(color.brg, s).brg;
			}
			else {
				color = setSaturationMinMidMax(color.bgr, s).bgr;
			}
		}

		return color;
	}
    `,lc=`
	fn getLuminosity(c: vec3<f32>) -> f32
	{
		return 0.3*c.r + 0.59*c.g + 0.11*c.b;
	}

	fn setLuminosity(c: vec3<f32>, lum: f32) -> vec3<f32>
	{
		var modLum: f32 = lum - getLuminosity(c);
		var color: vec3<f32> = c.rgb + modLum;

		// clip back into legal range
		modLum = getLuminosity(color);
		let modLumVec = vec3<f32>(modLum);

		let cMin: f32 = min(color.r, min(color.g, color.b));
		let cMax: f32 = max(color.r, max(color.g, color.b));

		if(cMin < 0.0)
		{
			color = mix(modLumVec, color, modLum / (modLum - cMin));
		}

		if(cMax > 1.0)
		{
			color = mix(modLumVec, color, (1 - modLum) / (cMax - modLum));
		}

		return color;
	}

	fn getSaturation(c: vec3<f32>) -> f32
	{
		return max(c.r, max(c.g, c.b)) - min(c.r, min(c.g, c.b));
	}

	fn setSaturationMinMidMax(cSorted: vec3<f32>, s: f32) -> vec3<f32>
	{
		var colorSorted = cSorted;

		if(colorSorted.z > colorSorted.x)
		{
			colorSorted.y = (((colorSorted.y - colorSorted.x) * s) / (colorSorted.z - colorSorted.x));
			colorSorted.z = s;
		}
		else
		{
			colorSorted.y = 0;
			colorSorted.z = 0;
		}

		colorSorted.x = 0;

		return colorSorted;
	}

	fn setSaturation(c: vec3<f32>, s: f32) -> vec3<f32>
	{
		var color = c;

		if (color.r <= color.g && color.r <= color.b)
		{
			if (color.g <= color.b)
			{
				color = vec3<f32>(setSaturationMinMidMax(color.rgb, s)).rgb;
			}
			else
			{
				color = vec3<f32>(setSaturationMinMidMax(color.rbg, s)).rbg;
			}
		}
		else if (color.g <= color.r && color.g <= color.b)
		{
			if (color.r <= color.b)
			{
				color = vec3<f32>(setSaturationMinMidMax(color.grb, s)).grb;
			}
			else
			{
				color = vec3<f32>(setSaturationMinMidMax(color.gbr, s)).gbr;
			}
		}
		else
		{
			// Using bgr for both fixes part of hue
			if (color.r <= color.g)
			{
				color = vec3<f32>(setSaturationMinMidMax(color.brg, s)).brg;
			}
			else
			{
				color  = vec3<f32>(setSaturationMinMidMax(color.bgr, s)).bgr;
			}
		}

		return color;
	}
	`,uc=class extends q{constructor(){super({gl:{functions:`
                ${cc}

                vec3 blendColor(vec3 base, vec3 blend,  float opacity)
                {
                    return (setLuminosity(blend, getLuminosity(base)) * opacity + base * (1.0 - opacity));
                }
                `,main:`
                finalColor = vec4(blendColor(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                ${lc}

                fn blendColorOpacity(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    return (setLuminosity(blend, getLuminosity(base)) * opacity + base * (1.0 - opacity));
                }
                `,main:`
                out = vec4<f32>(blendColorOpacity(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `}})}};uc.extension={name:`color`,type:C.BlendMode};var dc=class extends q{constructor(){super({gl:{functions:`
                float colorBurn(float base, float blend)
                {
                    return max((1.0 - ((1.0 - base) / blend)), 0.0);
                }

                vec3 blendColorBurn(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        colorBurn(base.r, blend.r),
                        colorBurn(base.g, blend.g),
                        colorBurn(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,main:`
                finalColor = vec4(blendColorBurn(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
            `},gpu:{functions:`
                fn colorBurn(base:f32, blend:f32) -> f32
                {
                    return max((1.0-((1.0-base)/blend)),0.0);
                }

                fn blendColorBurn(base: vec3<f32>, blend: vec3<f32>, opacity: f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        colorBurn(base.r, blend.r),
                        colorBurn(base.g, blend.g),
                        colorBurn(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,main:`
                out = vec4<f32>(blendColorBurn(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `}})}};dc.extension={name:`color-burn`,type:C.BlendMode};var fc=class extends q{constructor(){super({gl:{functions:`
                float colorDodge(float base, float blend)
                {
                    return base / (1.0 - blend);
                }

                vec3 blendColorDodge(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        colorDodge(base.r, blend.r),
                        colorDodge(base.g, blend.g),
                        colorDodge(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                finalColor = vec4(blendColorDodge(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                fn colorDodge(base: f32, blend: f32) -> f32
                {
                    return base / (1.0 - blend);
                }

                fn blendColorDodge(base: vec3<f32>, blend: vec3<f32>, opacity: f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        colorDodge(base.r, blend.r),
                        colorDodge(base.g, blend.g),
                        colorDodge(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                    out = vec4<f32>(blendColorDodge(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `}})}};fc.extension={name:`color-dodge`,type:C.BlendMode};var pc=class extends q{constructor(){super({gl:{functions:`
                vec3 blendDarken(vec3 base, vec3 blend, float opacity)
                {
                    return (min(base, blend) * opacity + base * (1.0 - opacity));
                }
                `,main:`
                finalColor = vec4(blendDarken(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                fn blendDarken(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    return (min(blend,base) * opacity + base * (1.0 - opacity));
                }
                `,main:`
                out = vec4<f32>(blendDarken(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `}})}};pc.extension={name:`darken`,type:C.BlendMode};var mc=class extends q{constructor(){super({gl:{functions:`
                vec3 blendDifference(vec3 base, vec3 blend,  float opacity)
                {
                    return (abs(blend - base) * opacity + base * (1.0 - opacity));
                }
            `,main:`
                finalColor = vec4(blendDifference(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
            `},gpu:{functions:`
                fn blendDifference(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    return (abs(blend - base) * opacity + base * (1.0 - opacity));
                }
            `,main:`
                out = vec4<f32>(blendDifference(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `}})}};mc.extension={name:`difference`,type:C.BlendMode};var hc=class extends q{constructor(){super({gl:{functions:`
                float divide(float base, float blend)
                {
                    return (blend > 0.0) ? clamp(base / blend, 0.0, 1.0) : 1.0;
                }

                vec3 blendDivide(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        divide(base.r, blend.r),
                        divide(base.g, blend.g),
                        divide(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                finalColor = vec4(blendDivide(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                fn divide(base: f32, blend: f32) -> f32
                {
                    return select(1.0, clamp(base / blend, 0.0, 1.0), blend > 0.0);
                }

                fn blendDivide(base: vec3<f32>, blend: vec3<f32>, opacity: f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        divide(base.r, blend.r),
                        divide(base.g, blend.g),
                        divide(base.b, blend.b)
                    );
                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,main:`
                out = vec4<f32>(blendDivide(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `}})}};hc.extension={name:`divide`,type:C.BlendMode};var gc=class extends q{constructor(){super({gl:{functions:`
                vec3 exclusion(vec3 base, vec3 blend)
                {
                    return base + blend - 2.0 * base * blend;
                }

                vec3 blendExclusion(vec3 base, vec3 blend, float opacity)
                {
                    return (exclusion(base, blend) * opacity + base * (1.0 - opacity));
                }
                `,main:`
                finalColor = vec4(blendExclusion(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                fn exclusion(base: vec3<f32>, blend: vec3<f32>) -> vec3<f32>
                {
                    return base+blend-2.0*base*blend;
                }

                fn blendExclusion(base: vec3<f32>, blend: vec3<f32>, opacity: f32) -> vec3<f32>
                {
                    return (exclusion(base, blend) * opacity + base * (1.0 - opacity));
                }
            `,main:`
                out = vec4<f32>(blendExclusion(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `}})}};gc.extension={name:`exclusion`,type:C.BlendMode};var _c=class extends q{constructor(){super({gl:{functions:`
                float hardLight(float base, float blend)
                {
                    return (blend < 0.5) ? 2.0 * base * blend : 1.0 - 2.0 * (1.0 - base) * (1.0 - blend);
                }

                vec3 blendHardLight(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        hardLight(base.r, blend.r),
                        hardLight(base.g, blend.g),
                        hardLight(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,main:`
                finalColor = vec4(blendHardLight(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
            `},gpu:{functions:`
                fn hardLight(base: f32, blend: f32) -> f32
                {
                    return select(1.0 - 2.0 * (1.0 - base) * (1.0 - blend), 2.0 * base * blend, blend < 0.5);
                }

                fn blendHardLight(base: vec3<f32>, blend: vec3<f32>, opacity: f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        hardLight(base.r, blend.r),
                        hardLight(base.g, blend.g),
                        hardLight(base.b, blend.b)
                    );
                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                out = vec4<f32>(blendHardLight(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `}})}};_c.extension={name:`hard-light`,type:C.BlendMode};var vc=class extends q{constructor(){super({gl:{functions:`
                float hardMix(float base, float blend)
                {
                    return (base + blend >= 1.0) ? 1.0 : 0.0;
                }

                vec3 blendHardMix(vec3 base, vec3 blend,  float opacity)
                {
                    vec3 blended = vec3(
                        hardMix(base.r, blend.r),
                        hardMix(base.g, blend.g),
                        hardMix(base.b, blend.b)
                    );
                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,main:`
                finalColor = vec4(blendHardMix(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
            `},gpu:{functions:`
                fn hardMix(base: f32, blend: f32) -> f32
                {
                    return select(0.0, 1.0, base + blend >= 1.0);
                }

                fn blendHardMix(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    let blended: vec3<f32> = vec3<f32>(
                        hardMix(base.r, blend.r),
                        hardMix(base.g, blend.g),
                        hardMix(base.b, blend.b)
                    );
                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,main:`
                out = vec4<f32>(blendHardMix(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `}})}};vc.extension={name:`hard-mix`,type:C.BlendMode};var yc=class extends q{constructor(){super({gl:{functions:`
                vec3 blendLighten(vec3 base, vec3 blend, float opacity)
                {
                    return (max(base, blend) * opacity + base * (1.0 - opacity));
                }
                `,main:`
                finalColor = vec4(blendLighten(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                fn blendLighten(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    return (max(base, blend) * opacity + base * (1.0 - opacity));
                }
            `,main:`
                out = vec4<f32>(blendLighten(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `}})}};yc.extension={name:`lighten`,type:C.BlendMode};var bc=class extends q{constructor(){super({gl:{functions:`
                float linearBurn(float base, float blend)
                {
                    return max(0.0, base + blend - 1.0);
                }

                vec3 blendLinearBurn(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        linearBurn(base.r, blend.r),
                        linearBurn(base.g, blend.g),
                        linearBurn(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                finalColor = vec4(blendLinearBurn(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                fn linearBurn(base: f32, blend: f32) -> f32
                {
                    return max(0.0, base + blend - 1.0);
                }

                fn blendLinearBurn(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        linearBurn(base.r, blend.r),
                        linearBurn(base.g, blend.g),
                        linearBurn(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                out = vec4<f32>(blendLinearBurn(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `}})}};bc.extension={name:`linear-burn`,type:C.BlendMode};var xc=class extends q{constructor(){super({gl:{functions:`
                float linearDodge(float base, float blend) {
                    return min(1.0, base + blend);
                }

                vec3 blendLinearDodge(vec3 base, vec3 blend, float opacity) {
                    vec3 blended = vec3(
                        linearDodge(base.r, blend.r),
                        linearDodge(base.g, blend.g),
                        linearDodge(base.b, blend.b)
                    );
                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                finalColor = vec4(blendLinearDodge(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                fn linearDodge(base: f32, blend: f32) -> f32
                {
                    return min(1, base + blend);
                }

                fn blendLinearDodge(base:vec3<f32>, blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        linearDodge(base.r, blend.r),
                        linearDodge(base.g, blend.g),
                        linearDodge(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,main:`
                out = vec4<f32>(blendLinearDodge(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `}})}};xc.extension={name:`linear-dodge`,type:C.BlendMode};var Sc=class extends q{constructor(){super({gl:{functions:`
                float linearBurn(float base, float blend) {
                    return max(0.0, base + blend - 1.0);
                }

                float linearDodge(float base, float blend) {
                    return min(1.0, base + blend);
                }

                float linearLight(float base, float blend) {
                    return (blend <= 0.5) ? linearBurn(base,2.0*blend) : linearBurn(base,2.0*(blend-0.5));
                }

                vec3 blendLinearLight(vec3 base, vec3 blend, float opacity) {
                    vec3 blended = vec3(
                        linearLight(base.r, blend.r),
                        linearLight(base.g, blend.g),
                        linearLight(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,main:`
                finalColor = vec4(blendLinearLight(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                fn linearBurn(base: f32, blend: f32) -> f32
                {
                    return max(0.0, base + blend - 1.0);
                }

                fn linearDodge(base: f32, blend: f32) -> f32
                {
                    return min(1.0, base + blend);
                }

                fn linearLight(base: f32, blend: f32) -> f32
                {
                    return select(linearBurn(base,2.0*(blend-0.5)), linearBurn(base,2.0*blend), blend <= 0.5);
                }

                fn blendLinearLightOpacity(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        linearLight(base.r, blend.r),
                        linearLight(base.g, blend.g),
                        linearLight(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,main:`
                out = vec4<f32>(blendLinearLightOpacity(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `}})}};Sc.extension={name:`linear-light`,type:C.BlendMode};var Cc=class extends q{constructor(){super({gl:{functions:`
                ${cc}

                vec3 blendLuminosity(vec3 base, vec3 blend,  float opacity)
                {
                    vec3 blendLuminosity = setLuminosity(base, getLuminosity(blend));
                    return (blendLuminosity * opacity + base * (1.0 - opacity));
                }
                `,main:`
                finalColor = vec4(blendLuminosity(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                ${lc}

                fn blendLuminosity(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    let blendLuminosity: vec3<f32> = setLuminosity(base, getLuminosity(blend));
                    return (blendLuminosity * opacity + base * (1.0 - opacity));
                }
            `,main:`
                out = vec4<f32>(blendLuminosity(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `}})}};Cc.extension={name:`luminosity`,type:C.BlendMode};var wc=class extends q{constructor(){super({gl:{functions:`
                vec3 negation(vec3 base, vec3 blend)
                {
                    return 1.0-abs(1.0-base-blend);
                }

                vec3 blendNegation(vec3 base, vec3 blend, float opacity)
                {
                    return (negation(base, blend) * opacity + base * (1.0 - opacity));
                }
                `,main:`
                finalColor = vec4(blendNegation(back.rgb, front.rgb, front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                fn blendNegation(base: vec3<f32>, blend: vec3<f32>) -> vec3<f32>
                {
                    return 1.0-abs(1.0-base-blend);
                }

                fn blendNegationOpacity(base: vec3<f32>, blend: vec3<f32>, opacity: f32) -> vec3<f32>
                {
                    return (blendNegation(base, blend) * opacity + base * (1.0 - opacity));
                }
            `,main:`
                out = vec4<f32>(blendNegationOpacity(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `}})}};wc.extension={name:`negation`,type:C.BlendMode};var Tc=class extends q{constructor(){super({gl:{functions:`
                float overlay(float base, float blend)
                {
                    return (base < 0.5) ? (2.0*base*blend) : (1.0-2.0*(1.0-base)*(1.0-blend));
                }

                vec3 blendOverlay(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        overlay(base.r, blend.r),
                        overlay(base.g, blend.g),
                        overlay(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                finalColor = vec4(blendOverlay(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                fn overlay(base: f32, blend: f32) -> f32
                {
                    return select((1.0-2.0*(1.0-base)*(1.0-blend)), (2.0*base*blend), base < 0.5);
                }

                fn blendOverlay(base: vec3<f32>, blend: vec3<f32>, opacity: f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        overlay(base.r, blend.r),
                        overlay(base.g, blend.g),
                        overlay(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                out = vec4<f32>(blendOverlay(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `}})}};Tc.extension={name:`overlay`,type:C.BlendMode};var Ec=class extends q{constructor(){super({gl:{functions:`
                float pinLight(float base, float blend)
                {
                    return (blend <= 0.5) ? min(base, 2.0 * blend) : max(base, 2.0 * (blend - 0.5));
                }

                vec3 blendPinLight(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        pinLight(base.r, blend.r),
                        pinLight(base.g, blend.g),
                        pinLight(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,main:`
                finalColor = vec4(blendPinLight(back.rgb, front.rgb, front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                fn pinLight(base: f32, blend: f32) -> f32
                {
                    return select(max(base,2.0*(blend-0.5)), min(base,2.0*blend), blend <= 0.5);
                }

                fn blendPinLight(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        pinLight(base.r, blend.r),
                        pinLight(base.g, blend.g),
                        pinLight(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                out = vec4<f32>(blendPinLight(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `}})}};Ec.extension={name:`pin-light`,type:C.BlendMode};var Dc=class extends q{constructor(){super({gl:{functions:`
                ${cc}

                vec3 blendSaturation(vec3 base, vec3 blend,  float opacity)
                {
                    vec3 blendSaturation = setLuminosity(setSaturation(base, getSaturation(blend)), getLuminosity(base));
                    return (blendSaturation * opacity + base * (1.0 - opacity));
                }
            `,main:`
                finalColor = vec4(blendSaturation(back.rgb, front.rgb, front.a), blendedAlpha) * uBlend;
            `},gpu:{functions:`
                ${lc}

                fn blendSaturation(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    let blendSaturation = setLuminosity(setSaturation(base, getSaturation(blend)), getLuminosity(base));
                    return (blendSaturation * opacity + base * (1.0 - opacity));
                }
            `,main:`
                out = vec4<f32>(blendSaturation(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `}})}};Dc.extension={name:`saturation`,type:C.BlendMode};var Oc=class extends q{constructor(){super({gl:{functions:`
                float softLight(float base, float blend)
                {
                    return (blend < 0.5) ? (2.0 * base * blend + base * base * (1.0 - 2.0 * blend)) : (sqrt(base) * (2.0 * blend - 1.0) + 2.0 * base * (1.0 - blend));
                }

                vec3 blendSoftLight(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        softLight(base.r, blend.r),
                        softLight(base.g, blend.g),
                        softLight(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                finalColor = vec4(blendSoftLight(back.rgb, front.rgb, front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                fn softLight(base: f32, blend: f32) -> f32
                {
                    return select(2.0 * base * blend + base * base * (1.0 - 2.0 * blend), sqrt(base) * (2.0 * blend - 1.0) + 2.0 * base * (1.0 - blend), blend < 0.5);
                }

                fn blendSoftLight(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    let blended: vec3<f32> = vec3<f32>(
                        softLight(base.r, blend.r),
                        softLight(base.g, blend.g),
                        softLight(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                out = vec4<f32>(blendSoftLight(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `}})}};Oc.extension={name:`soft-light`,type:C.BlendMode};var kc=class extends q{constructor(){super({gl:{functions:`
                float subtract(float base, float blend)
                {
                    return max(0.0, base - blend);
                }

                vec3 blendSubtract(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        subtract(base.r, blend.r),
                        subtract(base.g, blend.g),
                        subtract(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                finalColor = vec4(blendSubtract(back.rgb, front.rgb, front.a), blendedAlpha) * uBlend;
                `},gpu:{functions:`
                fn subtract(base: f32, blend: f32) -> f32
                {
                    return max(0, base - blend);
                }

                fn blendSubtract(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        subtract(base.r, blend.r),
                        subtract(base.g, blend.g),
                        subtract(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                out = vec4<f32>(blendSubtract(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `}})}};kc.extension={name:`subtract`,type:C.BlendMode};var Ac=class extends q{constructor(){super({gl:{functions:`
                float colorBurn(float base, float blend)
                {
                    return max((1.0-((1.0-base)/blend)),0.0);
                }

                float colorDodge(float base, float blend)
                {
                    return min(1.0, base / (1.0-blend));
                }

                float vividLight(float base, float blend)
                {
                    return (blend < 0.5) ? colorBurn(base,(2.0*blend)) : colorDodge(base,(2.0*(blend-0.5)));
                }

                vec3 blendVividLight(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        vividLight(base.r, blend.r),
                        vividLight(base.g, blend.g),
                        vividLight(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,main:`
                finalColor = vec4(blendVividLight(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
            `},gpu:{functions:`
                fn colorBurn(base:f32, blend:f32) -> f32
                {
                    return max((1.0-((1.0-base)/blend)),0.0);
                }

                fn colorDodge(base: f32, blend: f32) -> f32
                {
                    return min(1.0, base / (1.0-blend));
                }

                fn vividLight(base: f32, blend: f32) -> f32
                {
                    return select(colorDodge(base,(2.0*(blend-0.5))), colorBurn(base,(2.0*blend)), blend<0.5);
                }

                fn blendVividLight(base: vec3<f32>, blend: vec3<f32>, opacity: f32) -> vec3<f32>
                {
                    let blended: vec3<f32> = vec3<f32>(
                        vividLight(base.r, blend.r),
                        vividLight(base.g, blend.g),
                        vividLight(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,main:`
                out = vec4<f32>(blendVividLight(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `}})}};Ac.extension={name:`vivid-light`,type:C.BlendMode};var jc;function Mc(e){return jc===void 0&&(jc=(()=>{let t={stencil:!0,failIfMajorPerformanceCaveat:e??so.defaultOptions.failIfMajorPerformanceCaveat};try{if(!U.get().getWebGLRenderingContext())return!1;let e=U.get().createCanvas().getContext(`webgl`,t),n=!!e?.getContextAttributes()?.stencil;if(e){let t=e.getExtension(`WEBGL_lose_context`);t&&t.loseContext()}return e=null,n}catch{return!1}})()),jc}var Nc;async function Pc(e={}){return Nc===void 0&&(Nc=await(async()=>{let t=U.get().getNavigator().gpu;if(!t)return!1;try{return await(await t.requestAdapter(e)).requestDevice(),!0}catch{return!1}})()),Nc}var Fc=[`webgl`,`webgpu`,`canvas`];async function Ic(e){let t=[];e.preference?(t.push(e.preference),Fc.forEach(n=>{n!==e.preference&&t.push(n)})):t=Fc.slice();let n,r={};for(let i=0;i<t.length;i++){let a=t[i];if(a===`webgpu`&&await Pc()){let{WebGPURenderer:t}=await en(async()=>{let{WebGPURenderer:e}=await import(`./WebGPURenderer-B3DD5gR8.js`);return{WebGPURenderer:e}},__vite__mapDeps([7,1,8,9,4]),import.meta.url);n=t,r={...e,...e.webgpu};break}else if(a===`webgl`&&Mc(e.failIfMajorPerformanceCaveat??so.defaultOptions.failIfMajorPerformanceCaveat)){let{WebGLRenderer:t}=await en(async()=>{let{WebGLRenderer:e}=await import(`./WebGLRenderer-BEQqwbMU.js`);return{WebGLRenderer:e}},__vite__mapDeps([10,1,8,11]),import.meta.url);n=t,r={...e,...e.webgl};break}else if(a===`canvas`)throw r={...e},Error(`CanvasRenderer is not yet implemented`)}if(delete r.webgpu,delete r.webgl,!n)throw Error(`No available renderer for the current environment`);let i=new n;return await i.init(r),i}var Lc=class e{constructor(...e){this.stage=new i,e[0]!==void 0&&F(H,`Application constructor options are deprecated, please use Application.init() instead.`)}async init(t){t={...t},this.stage||=new i,this.renderer=await Ic(t),e._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return F(H,`Application.view is deprecated, please use Application.canvas instead.`),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(t=!1,n=!1){let r=e._plugins.slice(0);r.reverse(),r.forEach(e=>{e.destroy.call(this)}),this.stage.destroy(n),this.stage=null,this.renderer.destroy(t),this.renderer=null}};Lc._plugins=[];var Rc=Lc;R.handleByList(C.Application,Rc._plugins),R.add(Pa);var zc=class extends zn{constructor(e,t){super();let{textures:n,data:r}=e;Object.keys(r.pages).forEach(e=>{let t=n[r.pages[parseInt(e,10)].id];this.pages.push({texture:t})}),Object.keys(r.chars).forEach(e=>{let t=r.chars[e],{frame:i,source:a,rotate:o}=n[t.page],s=new W({frame:z.transformRectCoords(t,i,o,new Tt),orig:new Tt(0,0,t.width,t.height),source:a,rotate:o});this.chars[e]={id:e.codePointAt(0),xOffset:t.xOffset,yOffset:t.yOffset,xAdvance:t.xAdvance,kerning:t.kerning??{},texture:s}}),this.baseRenderedFontSize=r.fontSize,this.baseMeasurementFontSize=r.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:r.fontSize},this.baseLineOffset=r.baseLineOffset,this.lineHeight=r.lineHeight,this.fontFamily=r.fontFamily,this.distanceField=r.distanceField??{type:`none`,range:0},this.url=t}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){let{texture:t}=this.pages[e];t.destroy(!0)}this.pages=null}static install(e){fr.install(e)}static uninstall(e){fr.uninstall(e)}},Bc={test(e){return typeof e==`string`&&e.startsWith(`info face=`)},parse(e){let t=e.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(let e in t){let r=t[e].match(/^[a-z]+/gm)[0],i=t[e].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),a={};for(let e in i){let t=i[e].split(`=`),n=t[0],r=t[1].replace(/"/gm,``),o=parseFloat(r);a[n]=isNaN(o)?r:o}n[r].push(a)}let r={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:``,distanceField:null,baseLineOffset:0},[i]=n.info,[a]=n.common,[o]=n.distanceField??[];o&&(r.distanceField={range:parseInt(o.distanceRange,10),type:o.fieldType}),r.fontSize=parseInt(i.size,10),r.fontFamily=i.face,r.lineHeight=parseInt(a.lineHeight,10);let s=n.page;for(let e=0;e<s.length;e++)r.pages.push({id:parseInt(s[e].id,10)||0,file:s[e].file});let c={};r.baseLineOffset=r.lineHeight-parseInt(a.base,10);let l=n.char;for(let e=0;e<l.length;e++){let t=l[e],n=parseInt(t.id,10),i=t.letter??t.char??String.fromCharCode(n);i===`space`&&(i=` `),c[n]=i,r.chars[i]={id:n,page:parseInt(t.page,10)||0,x:parseInt(t.x,10),y:parseInt(t.y,10),width:parseInt(t.width,10),height:parseInt(t.height,10),xOffset:parseInt(t.xoffset,10),yOffset:parseInt(t.yoffset,10),xAdvance:parseInt(t.xadvance,10),kerning:{}}}let u=n.kerning||[];for(let e=0;e<u.length;e++){let t=parseInt(u[e].first,10),n=parseInt(u[e].second,10),i=parseInt(u[e].amount,10);r.chars[c[n]].kerning[c[t]]=i}return r}},Vc={test(e){let t=e;return typeof t!=`string`&&`getElementsByTagName`in t&&t.getElementsByTagName(`page`).length&&t.getElementsByTagName(`info`)[0].getAttribute(`face`)!==null},parse(e){let t={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:``,distanceField:null,baseLineOffset:0},n=e.getElementsByTagName(`info`)[0],r=e.getElementsByTagName(`common`)[0],i=e.getElementsByTagName(`distanceField`)[0];i&&(t.distanceField={type:i.getAttribute(`fieldType`),range:parseInt(i.getAttribute(`distanceRange`),10)});let a=e.getElementsByTagName(`page`),o=e.getElementsByTagName(`char`),s=e.getElementsByTagName(`kerning`);t.fontSize=parseInt(n.getAttribute(`size`),10),t.fontFamily=n.getAttribute(`face`),t.lineHeight=parseInt(r.getAttribute(`lineHeight`),10);for(let e=0;e<a.length;e++)t.pages.push({id:parseInt(a[e].getAttribute(`id`),10)||0,file:a[e].getAttribute(`file`)});let c={};t.baseLineOffset=t.lineHeight-parseInt(r.getAttribute(`base`),10);for(let e=0;e<o.length;e++){let n=o[e],r=parseInt(n.getAttribute(`id`),10),i=n.getAttribute(`letter`)??n.getAttribute(`char`)??String.fromCharCode(r);i===`space`&&(i=` `),c[r]=i,t.chars[i]={id:r,page:parseInt(n.getAttribute(`page`),10)||0,x:parseInt(n.getAttribute(`x`),10),y:parseInt(n.getAttribute(`y`),10),width:parseInt(n.getAttribute(`width`),10),height:parseInt(n.getAttribute(`height`),10),xOffset:parseInt(n.getAttribute(`xoffset`),10),yOffset:parseInt(n.getAttribute(`yoffset`),10),xAdvance:parseInt(n.getAttribute(`xadvance`),10),kerning:{}}}for(let e=0;e<s.length;e++){let n=parseInt(s[e].getAttribute(`first`),10),r=parseInt(s[e].getAttribute(`second`),10),i=parseInt(s[e].getAttribute(`amount`),10);t.chars[c[r]].kerning[c[n]]=i}return t}},Hc={test(e){return typeof e==`string`&&e.match(/<font(\s|>)/)?Vc.test(U.get().parseXML(e)):!1},parse(e){return Vc.parse(U.get().parseXML(e))}},Uc=[`.xml`,`.fnt`],Wc={extension:{type:C.CacheParser,name:`cacheBitmapFont`},test:e=>e instanceof zc,getCacheableAssets(e,t){let n={};return e.forEach(e=>{n[e]=t,n[`${e}-bitmap`]=t}),n[`${t.fontFamily}-bitmap`]=t,n}},Gc={extension:{type:C.LoadParser,priority:K.Normal},name:`loadBitmapFont`,id:`bitmap-font`,test(e){return Uc.includes(Bn.extname(e).toLowerCase())},async testParse(e){return Bc.test(e)||Hc.test(e)},async parse(e,t,n){let r=Bc.test(e)?Bc.parse(e):Hc.parse(e),{src:i}=t,{pages:a}=r,o=[],s=r.distanceField?{scaleMode:`linear`,alphaMode:`premultiply-alpha-on-upload`,autoGenerateMipmaps:!1,resolution:1}:{};for(let e=0;e<a.length;++e){let t=a[e].file,n=Bn.join(Bn.dirname(i),t);n=Un(n,i),o.push({src:n,data:s})}let c=await n.load(o);return new zc({data:r,textures:o.map(e=>c[e.src])},i)},async load(e,t){return await(await U.get().fetch(e)).text()},async unload(e,t,n){await Promise.all(e.pages.map(e=>n.unload(e.texture.source._sourceOrigin))),e.destroy()}},Kc=class{constructor(e,t=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=t}add(e){e.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log(`[BackgroundLoader] assets: `,this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;let e=[],t=Math.min(this._assetList.length,this._maxConcurrent);for(let n=0;n<t;n++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}},qc={extension:{type:C.CacheParser,name:`cacheTextureArray`},test:e=>Array.isArray(e)&&e.every(e=>e instanceof W),getCacheableAssets:(e,t)=>{let n={};return e.forEach(e=>{t.forEach((t,r)=>{n[e+(r===0?``:r+1)]=t})}),n}};async function Jc(e){if(`Image`in globalThis)return new Promise(t=>{let n=new Image;n.onload=()=>{t(!0)},n.onerror=()=>{t(!1)},n.src=e});if(`createImageBitmap`in globalThis&&`fetch`in globalThis){try{let t=await(await fetch(e)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}var Yc={extension:{type:C.DetectionParser,priority:1},test:async()=>Jc(`data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=`),add:async e=>[...e,`avif`],remove:async e=>e.filter(e=>e!==`avif`)},Xc=[`png`,`jpg`,`jpeg`],Zc={extension:{type:C.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async e=>[...e,...Xc],remove:async e=>e.filter(e=>!Xc.includes(e))},Qc=`WorkerGlobalScope`in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function $c(e){return Qc?!1:document.createElement(`video`).canPlayType(e)!==``}var el={extension:{type:C.DetectionParser,priority:0},test:async()=>$c(`video/mp4`),add:async e=>[...e,`mp4`,`m4v`],remove:async e=>e.filter(e=>e!==`mp4`&&e!==`m4v`)},tl={extension:{type:C.DetectionParser,priority:0},test:async()=>$c(`video/ogg`),add:async e=>[...e,`ogv`],remove:async e=>e.filter(e=>e!==`ogv`)},nl={extension:{type:C.DetectionParser,priority:0},test:async()=>$c(`video/webm`),add:async e=>[...e,`webm`],remove:async e=>e.filter(e=>e!==`webm`)},rl={extension:{type:C.DetectionParser,priority:0},test:async()=>Jc(`data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=`),add:async e=>[...e,`webp`],remove:async e=>e.filter(e=>e!==`webp`)},il=class e{constructor(){this.loadOptions={...e.defaultOptions},this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,t,n)=>(this._parsersValidated=!1,e[t]=n,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,t){let n={promise:null,parser:null};return n.promise=(async()=>{let r=null,i=null;if((t.parser||t.loadParser)&&(i=this._parserHash[t.parser||t.loadParser],t.loadParser&&f(`[Assets] "loadParser" is deprecated, use "parser" instead for ${e}`),i||f(`[Assets] specified load parser "${t.parser||t.loadParser}" not found while loading ${e}`)),!i){for(let n=0;n<this.parsers.length;n++){let r=this.parsers[n];if(r.load&&r.test?.(e,t,this)){i=r;break}}if(!i)return f(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}r=await i.load(e,t,this),n.parser=i;for(let e=0;e<this.parsers.length;e++){let i=this.parsers[e];i.parse&&i.parse&&await i.testParse?.(r,t,this)&&(r=await i.parse(r,t,this)||r,n.parser=i)}return r})(),n}async load(t,n){this._parsersValidated||this._validateParsers();let{onProgress:r,onError:i,strategy:a,retryCount:o,retryDelay:s}=typeof n==`function`?{...e.defaultOptions,...this.loadOptions,onProgress:n}:{...e.defaultOptions,...this.loadOptions,...n||{}},c=0,l={},u=ra(t),d=Cr(t,e=>({alias:[e],src:e,data:{}})),f=d.reduce((e,t)=>e+(t.progressSize||1),0),p=d.map(async e=>{let t=Bn.toAbsolute(e.src);l[e.src]||(await this._loadAssetWithRetry(t,e,{onProgress:r,onError:i,strategy:a,retryCount:o,retryDelay:s},l),c+=e.progressSize||1,r&&r(c/f))});return await Promise.all(p),u?l[d[0].src]:l}async unload(e){let t=Cr(e,e=>({alias:[e],src:e})).map(async e=>{let t=Bn.toAbsolute(e.src),n=this.promiseCache[t];if(n){let r=await n.promise;delete this.promiseCache[t],await n.parser?.unload?.(r,e,this)}});await Promise.all(t)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name||e.id).reduce((e,t)=>(!t.name&&!t.id?f(`[Assets] parser should have an id`):(e[t.name]||e[t.id])&&f(`[Assets] parser id conflict "${t.id}"`),e[t.name]=t,t.id&&(e[t.id]=t),e),{})}async _loadAssetWithRetry(e,t,n,r){let i=0,{onError:a,strategy:o,retryCount:s,retryDelay:c}=n,l=e=>new Promise(t=>setTimeout(t,e));for(;;)try{this.promiseCache[e]||(this.promiseCache[e]=this._getLoadPromiseAndParser(e,t)),r[t.src]=await this.promiseCache[e].promise;return}catch(n){if(delete this.promiseCache[e],delete r[t.src],i++,o===`retry`&&!(o!==`retry`||i>s)){a&&a(n,t),await l(c);continue}if(o===`skip`){a&&a(n,t);return}throw a&&a(n,t),Error(`[Loader.load] Failed to load ${e}.
${n}`)}}};il.defaultOptions={onProgress:void 0,onError:void 0,strategy:`throw`,retryCount:3,retryDelay:250};var al=il;function ol(e,t){if(Array.isArray(t)){for(let n of t)if(e.startsWith(`data:${n}`))return!0;return!1}return e.startsWith(`data:${t}`)}function J(e,t){let n=e.split(`?`)[0],r=Bn.extname(n).toLowerCase();return Array.isArray(t)?t.includes(r):r===t}var sl=`.json`,cl=`application/json`,ll={extension:{type:C.LoadParser,priority:K.Low},name:`loadJson`,id:`json`,test(e){return ol(e,cl)||J(e,sl)},async load(e){return await(await U.get().fetch(e)).json()}},ul=`.txt`,dl=`text/plain`,fl={name:`loadTxt`,id:`text`,extension:{type:C.LoadParser,priority:K.Low,name:`loadTxt`},test(e){return ol(e,dl)||J(e,ul)},async load(e){return await(await U.get().fetch(e)).text()}},pl=[`normal`,`bold`,`100`,`200`,`300`,`400`,`500`,`600`,`700`,`800`,`900`],ml=[`.ttf`,`.otf`,`.woff`,`.woff2`],hl=[`font/ttf`,`font/otf`,`font/woff`,`font/woff2`],gl=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function _l(e){let t=Bn.extname(e),n=Bn.basename(e,t).replace(/(-|_)/g,` `).toLowerCase().split(` `).map(e=>e.charAt(0).toUpperCase()+e.slice(1)),r=n.length>0;for(let e of n)if(!e.match(gl)){r=!1;break}let i=n.join(` `);return r||(i=`"${i.replace(/[\\"]/g,`\\$&`)}"`),i}var vl=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function yl(e){return vl.test(e)?e:encodeURI(e)}var bl={extension:{type:C.LoadParser,priority:K.Low},name:`loadWebFont`,id:`web-font`,test(e){return ol(e,hl)||J(e,ml)},async load(e,t){let n=U.get().getFontFaceSet();if(n){let r=[],i=t.data?.family??_l(e),a=t.data?.weights?.filter(e=>pl.includes(e))??[`normal`],o=t.data??{};for(let t=0;t<a.length;t++){let s=a[t],c=new FontFace(i,`url(${yl(e)})`,{...o,weight:s});await c.load(),n.add(c),r.push(c)}return G.has(`${i}-and-url`)?G.get(`${i}-and-url`).entries.push({url:e,faces:r}):G.set(`${i}-and-url`,{entries:[{url:e,faces:r}]}),r.length===1?r[0]:r}return f(`[loadWebFont] FontFace API is not supported. Skipping loading font`),null},unload(e){let t=Array.isArray(e)?e:[e],n=t[0].family,r=G.get(`${n}-and-url`),i=r.entries.find(e=>e.faces.some(e=>t.indexOf(e)!==-1));i.faces=i.faces.filter(e=>t.indexOf(e)===-1),i.faces.length===0&&(r.entries=r.entries.filter(e=>e!==i)),t.forEach(e=>{U.get().getFontFaceSet().delete(e)}),r.entries.length===0&&G.remove(`${n}-and-url`)}};function xl(e,t=1){let n=Xn.RETINA_PREFIX?.exec(e);return n?parseFloat(n[1]):t}function Sl(e,t,n){e.label=n,e._sourceOrigin=n;let r=new W({source:e,label:n}),i=()=>{delete t.promiseCache[n],G.has(n)&&G.remove(n)};return r.source.once(`destroy`,()=>{t.promiseCache[n]&&(f(`[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource.`),i())}),r.once(`destroy`,()=>{e.destroyed||(f(`[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture.`),i())}),r}var Cl=`.svg`,wl=`image/svg+xml`,Tl={extension:{type:C.LoadParser,priority:K.Low,name:`loadSVG`},name:`loadSVG`,id:`svg`,config:{crossOrigin:`anonymous`,parseAsGraphicsContext:!1},test(e){return ol(e,wl)||J(e,Cl)},async load(e,t,n){return t.data?.parseAsGraphicsContext??this.config.parseAsGraphicsContext?Dl(e):El(e,t,n,this.config.crossOrigin)},unload(e){e.destroy(!0)}};async function El(e,t,n,r){let i=await U.get().fetch(e),a=U.get().createImage();a.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(await i.text())}`,a.crossOrigin=r,await a.decode();let o=t.data?.width??a.width,s=t.data?.height??a.height,c=t.data?.resolution||xl(e),l=Math.ceil(o*c),u=Math.ceil(s*c),d=U.get().createCanvas(l,u),f=d.getContext(`2d`);f.imageSmoothingEnabled=!0,f.imageSmoothingQuality=`high`,f.drawImage(a,0,0,o*c,s*c);let{parseAsGraphicsContext:p,...m}=t.data??{};return Sl(new ar({resource:d,alphaMode:`premultiply-alpha-on-upload`,resolution:c,...m}),n,e)}async function Dl(e){let t=await(await U.get().fetch(e)).text(),n=new Pi;return n.svg(t),n}var Ol=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (_e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`,kl=null,Al=class{constructor(){kl||=URL.createObjectURL(new Blob([Ol],{type:`application/javascript`})),this.worker=new Worker(kl)}};Al.revokeObjectURL=function(){kl&&=(URL.revokeObjectURL(kl),null)};var jl=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`,Ml=null,Nl=class{constructor(){Ml||=URL.createObjectURL(new Blob([jl],{type:`application/javascript`})),this.worker=new Worker(Ml)}};Nl.revokeObjectURL=function(){Ml&&=(URL.revokeObjectURL(Ml),null)};var Pl=0,Fl,Il=new class{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported===void 0&&(this._isImageBitmapSupported=new Promise(e=>{let{worker:t}=new Al;t.addEventListener(`message`,n=>{t.terminate(),Al.revokeObjectURL(),e(n.data)})})),this._isImageBitmapSupported}loadImageBitmap(e,t){return this._run(`loadImageBitmap`,[e,t?.data?.alphaMode])}async _initWorkers(){this._initialized||=!0}_getWorker(){Fl===void 0&&(Fl=navigator.hardwareConcurrency||4);let e=this._workerPool.pop();return!e&&this._createdWorkers<Fl&&(this._createdWorkers++,e=new Nl().worker,e.addEventListener(`message`,e=>{this._complete(e.data),this._returnWorker(e.target),this._next()})),e}_returnWorker(e){this._workerPool.push(e)}_complete(e){this._resolveHash[e.uuid]&&(e.error===void 0?this._resolveHash[e.uuid].resolve(e.data):this._resolveHash[e.uuid].reject(e.error),delete this._resolveHash[e.uuid])}async _run(e,t){await this._initWorkers();let n=new Promise((n,r)=>{this._queue.push({id:e,arguments:t,resolve:n,reject:r})});return this._next(),n}_next(){if(!this._queue.length)return;let e=this._getWorker();if(!e)return;let t=this._queue.pop(),n=t.id;this._resolveHash[Pl]={resolve:t.resolve,reject:t.reject},e.postMessage({data:t.arguments,uuid:Pl++,id:n})}reset(){this._workerPool.forEach(e=>e.terminate()),this._workerPool.length=0,Object.values(this._resolveHash).forEach(({reject:e})=>{e?.(Error(`WorkerManager has been reset before completion`))}),this._resolveHash={},this._queue.length=0,this._initialized=!1,this._createdWorkers=0}},Ll=[`.jpeg`,`.jpg`,`.png`,`.webp`,`.avif`],Rl=[`image/jpeg`,`image/png`,`image/webp`,`image/avif`];async function zl(e,t){let n=await U.get().fetch(e);if(!n.ok)throw Error(`[loadImageBitmap] Failed to fetch ${e}: ${n.status} ${n.statusText}`);let r=await n.blob();return t?.data?.alphaMode===`premultiplied-alpha`?createImageBitmap(r,{premultiplyAlpha:`none`}):createImageBitmap(r)}var Bl={name:`loadTextures`,id:`texture`,extension:{type:C.LoadParser,priority:K.High,name:`loadTextures`},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:`anonymous`},test(e){return ol(e,Rl)||J(e,Ll)},async load(e,t,n){let r=null;return r=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await Il.isImageBitmapSupported()?await Il.loadImageBitmap(e,t):await zl(e,t):await new Promise((t,n)=>{r=U.get().createImage(),r.crossOrigin=this.config.crossOrigin,r.src=e,r.complete?t(r):(r.onload=()=>{t(r)},r.onerror=n)}),Sl(new ar({resource:r,alphaMode:`premultiply-alpha-on-upload`,resolution:t.data?.resolution||xl(e),...t.data}),n,e)},unload(e){e.destroy(!0)}},Vl=[`.mp4`,`.m4v`,`.webm`,`.ogg`,`.ogv`,`.h264`,`.avi`,`.mov`],Hl,Ul;function Wl(e,t,n){n===void 0&&!t.startsWith(`data:`)?e.crossOrigin=Kl(t):n!==!1&&(e.crossOrigin=typeof n==`string`?n:`anonymous`)}function Gl(e){return new Promise((t,n)=>{e.addEventListener(`canplaythrough`,r),e.addEventListener(`error`,i),e.load();function r(){a(),t()}function i(e){a(),n(e)}function a(){e.removeEventListener(`canplaythrough`,r),e.removeEventListener(`error`,i)}})}function Kl(e,t=globalThis.location){if(e.startsWith(`data:`))return``;t||=globalThis.location;let n=new URL(e,document.baseURI);return n.hostname!==t.hostname||n.port!==t.port||n.protocol!==t.protocol?`anonymous`:``}function ql(){let e=[],t=[];for(let n of Vl){let r=jn.MIME_TYPES[n.substring(1)]||`video/${n.substring(1)}`;$c(r)&&(e.push(n),t.includes(r)||t.push(r))}return{validVideoExtensions:e,validVideoMime:t}}var Jl={name:`loadVideo`,id:`video`,extension:{type:C.LoadParser,name:`loadVideo`},test(e){if(!Hl||!Ul){let{validVideoExtensions:e,validVideoMime:t}=ql();Hl=e,Ul=t}let t=ol(e,Ul),n=J(e,Hl);return t||n},async load(e,t,n){let r={...jn.defaultOptions,resolution:t.data?.resolution||xl(e),alphaMode:t.data?.alphaMode||await On(),...t.data},i=document.createElement(`video`),a={preload:r.autoLoad===!1?void 0:`auto`,"webkit-playsinline":r.playsinline===!1?void 0:``,playsinline:r.playsinline===!1?void 0:``,muted:r.muted===!0?``:void 0,loop:r.loop===!0?``:void 0,autoplay:r.autoPlay===!1?void 0:``};Object.keys(a).forEach(e=>{let t=a[e];t!==void 0&&i.setAttribute(e,t)}),r.muted===!0&&(i.muted=!0),Wl(i,e,r.crossorigin);let o=document.createElement(`source`),s;if(r.mime)s=r.mime;else if(e.startsWith(`data:`))s=e.slice(5,e.indexOf(`;`));else if(!e.startsWith(`blob:`)){let t=e.split(`?`)[0].slice(e.lastIndexOf(`.`)+1).toLowerCase();s=jn.MIME_TYPES[t]||`video/${t}`}return o.src=e,s&&(o.type=s),new Promise(a=>{let s=async()=>{let o=new jn({...r,resource:i});i.removeEventListener(`canplay`,s),t.data.preload&&await Gl(i),a(Sl(o,n,e))};r.preload&&!r.autoPlay&&i.load(),i.addEventListener(`canplay`,s),i.appendChild(o)})},unload(e){e.destroy(!0)}},Yl={extension:{type:C.ResolveParser,name:`resolveTexture`},test:Bl.test,parse:e=>({resolution:parseFloat(Xn.RETINA_PREFIX.exec(e)?.[1]??`1`),format:e.split(`.`).pop(),src:e})},Xl={extension:{type:C.ResolveParser,priority:-2,name:`resolveJson`},test:e=>Xn.RETINA_PREFIX.test(e)&&e.endsWith(`.json`),parse:Yl.parse},Zl=class{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Xn,this.loader=new al,this.cache=G,this._backgroundLoader=new Kc(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){if(this._initialized){f(`[Assets]AssetManager already initialized, did you load before calling this Assets.init()?`);return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let t=e.manifest;typeof t==`string`&&(t=await this.load(t)),this.resolver.addManifest(t)}let t=e.texturePreference?.resolution??1,n=typeof t==`number`?[t]:t,r=await this._detectFormats({preferredFormats:e.texturePreference?.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:r,resolution:n}}),e.preferences&&this.setPreferences(e.preferences),e.loadOptions&&(this.loader.loadOptions={...this.loader.loadOptions,...e.loadOptions})}add(e){this.resolver.add(e)}async load(e,t){this._initialized||await this.init();let n=ra(e),r=Cr(e).map(e=>{if(typeof e!=`string`){let t=this.resolver.getAlias(e);return t.some(e=>!this.resolver.hasKey(e))&&this.add(e),Array.isArray(t)?t[0]:t}return this.resolver.hasKey(e)||this.add({alias:e,src:e}),e}),i=this.resolver.resolve(r),a=await this._mapLoadToResolve(i,t);return n?a[r[0]]:a}addBundle(e,t){this.resolver.addBundle(e,t)}async loadBundle(e,t){this._initialized||await this.init();let n=!1;typeof e==`string`&&(n=!0,e=[e]);let r=this.resolver.resolveBundle(e),i={},a=Object.keys(r),o=0,s=[],c=()=>{t?.(s.reduce((e,t)=>e+t,0)/o)},l=a.map((e,t)=>{let n=r[e],a=Object.values(n),l=[...new Set(a.flat())].reduce((e,t)=>e+(t.progressSize||1),0);return s.push(0),o+=l,this._mapLoadToResolve(n,e=>{s[t]=e*l,c()}).then(t=>{i[e]=t})});return await Promise.all(l),n?i[e[0]]:i}async backgroundLoad(e){this._initialized||await this.init(),typeof e==`string`&&(e=[e]);let t=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(t))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e==`string`&&(e=[e]);let t=this.resolver.resolveBundle(e);Object.values(t).forEach(e=>{this._backgroundLoader.add(Object.values(e))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e==`string`)return G.get(e);let t={};for(let n=0;n<e.length;n++)t[n]=G.get(e[n]);return t}async _mapLoadToResolve(e,t){let n=[...new Set(Object.values(e))];this._backgroundLoader.active=!1;let r=await this.loader.load(n,t);this._backgroundLoader.active=!0;let i={};return n.forEach(e=>{let t=r[e.src],n=[e.src];e.alias&&n.push(...e.alias),n.forEach(e=>{i[e]=t}),G.set(n,t)}),i}async unload(e){this._initialized||await this.init();let t=Cr(e).map(e=>typeof e==`string`?e:e.src),n=this.resolver.resolve(t);await this._unloadFromResolved(n)}async unloadBundle(e){this._initialized||await this.init(),e=Cr(e);let t=this.resolver.resolveBundle(e),n=Object.keys(t).map(e=>this._unloadFromResolved(t[e]));await Promise.all(n)}async _unloadFromResolved(e){let t=Object.values(e);t.forEach(e=>{G.remove(e.src)}),await this.loader.unload(t)}async _detectFormats(e){let t=[];e.preferredFormats&&(t=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(let n of e.detections)e.skipDetections||await n.test()?t=await n.add(t):e.skipDetections||(t=await n.remove(t));return t=t.filter((e,n)=>t.indexOf(e)===n),t}get detections(){return this._detections}setPreferences(e){this.loader.parsers.forEach(t=>{t.config&&Object.keys(t.config).filter(t=>t in e).forEach(n=>{t.config[n]=e[n]})})}},Ql=new Zl;R.handleByList(C.LoadParser,Ql.loader.parsers).handleByList(C.ResolveParser,Ql.resolver.parsers).handleByList(C.CacheParser,Ql.cache.parsers).handleByList(C.DetectionParser,Ql.detections),R.add(qc,Zc,Yc,rl,el,tl,nl,ll,fl,bl,Tl,Bl,Jl,Gc,Wc,Yl,Xl);var $l={loader:C.LoadParser,resolver:C.ResolveParser,cache:C.CacheParser,detection:C.DetectionParser};R.handle(C.Asset,e=>{let t=e.ref;Object.entries($l).filter(([e])=>!!t[e]).forEach(([e,n])=>R.add(Object.assign(t[e],{extension:t[e].extension??n})))},e=>{let t=e.ref;Object.keys($l).filter(e=>!!t[e]).forEach(e=>R.remove(t[e]))});var eu={extension:{type:C.DetectionParser,priority:3},test:async()=>!!(await Pc()||Mc()),add:async e=>[...e,`basis`],remove:async e=>e.filter(e=>e!==`basis`)},tu=class extends Ee{constructor(e){super(e),this.uploadMethodId=`compressed`,this.resource=e.resource,this.mipLevelCount=this.resource.length}},nu;function ru(){if(nu)return nu;let e=U.get().createCanvas(1,1).getContext(`webgl`);return e?(nu=[...e.getExtension(`EXT_texture_compression_bptc`)?[`bc6h-rgb-ufloat`,`bc6h-rgb-float`,`bc7-rgba-unorm`,`bc7-rgba-unorm-srgb`]:[],...e.getExtension(`WEBGL_compressed_texture_s3tc`)?[`bc1-rgba-unorm`,`bc2-rgba-unorm`,`bc3-rgba-unorm`]:[],...e.getExtension(`WEBGL_compressed_texture_s3tc_srgb`)?[`bc1-rgba-unorm-srgb`,`bc2-rgba-unorm-srgb`,`bc3-rgba-unorm-srgb`]:[],...e.getExtension(`EXT_texture_compression_rgtc`)?[`bc4-r-unorm`,`bc4-r-snorm`,`bc5-rg-unorm`,`bc5-rg-snorm`]:[],...e.getExtension(`WEBGL_compressed_texture_etc`)?[`etc2-rgb8unorm`,`etc2-rgb8unorm-srgb`,`etc2-rgba8unorm`,`etc2-rgba8unorm-srgb`,`etc2-rgb8a1unorm`,`etc2-rgb8a1unorm-srgb`,`eac-r11unorm`,`eac-rg11unorm`]:[],...e.getExtension(`WEBGL_compressed_texture_astc`)?`astc-4x4-unorm.astc-4x4-unorm-srgb.astc-5x4-unorm.astc-5x4-unorm-srgb.astc-5x5-unorm.astc-5x5-unorm-srgb.astc-6x5-unorm.astc-6x5-unorm-srgb.astc-6x6-unorm.astc-6x6-unorm-srgb.astc-8x5-unorm.astc-8x5-unorm-srgb.astc-8x6-unorm.astc-8x6-unorm-srgb.astc-8x8-unorm.astc-8x8-unorm-srgb.astc-10x5-unorm.astc-10x5-unorm-srgb.astc-10x6-unorm.astc-10x6-unorm-srgb.astc-10x8-unorm.astc-10x8-unorm-srgb.astc-10x10-unorm.astc-10x10-unorm-srgb.astc-12x10-unorm.astc-12x10-unorm-srgb.astc-12x12-unorm.astc-12x12-unorm-srgb`.split(`.`):[]],nu):[]}var iu;async function au(){if(iu)return iu;let e=await U.get().getNavigator().gpu.requestAdapter();return iu=[...e.features.has(`texture-compression-bc`)?[`bc1-rgba-unorm`,`bc1-rgba-unorm-srgb`,`bc2-rgba-unorm`,`bc2-rgba-unorm-srgb`,`bc3-rgba-unorm`,`bc3-rgba-unorm-srgb`,`bc4-r-unorm`,`bc4-r-snorm`,`bc5-rg-unorm`,`bc5-rg-snorm`,`bc6h-rgb-ufloat`,`bc6h-rgb-float`,`bc7-rgba-unorm`,`bc7-rgba-unorm-srgb`]:[],...e.features.has(`texture-compression-etc2`)?[`etc2-rgb8unorm`,`etc2-rgb8unorm-srgb`,`etc2-rgb8a1unorm`,`etc2-rgb8a1unorm-srgb`,`etc2-rgba8unorm`,`etc2-rgba8unorm-srgb`,`eac-r11unorm`,`eac-r11snorm`,`eac-rg11unorm`,`eac-rg11snorm`]:[],...e.features.has(`texture-compression-astc`)?`astc-4x4-unorm.astc-4x4-unorm-srgb.astc-5x4-unorm.astc-5x4-unorm-srgb.astc-5x5-unorm.astc-5x5-unorm-srgb.astc-6x5-unorm.astc-6x5-unorm-srgb.astc-6x6-unorm.astc-6x6-unorm-srgb.astc-8x5-unorm.astc-8x5-unorm-srgb.astc-8x6-unorm.astc-8x6-unorm-srgb.astc-8x8-unorm.astc-8x8-unorm-srgb.astc-10x5-unorm.astc-10x5-unorm-srgb.astc-10x6-unorm.astc-10x6-unorm-srgb.astc-10x8-unorm.astc-10x8-unorm-srgb.astc-10x10-unorm.astc-10x10-unorm-srgb.astc-12x10-unorm.astc-12x10-unorm-srgb.astc-12x12-unorm.astc-12x12-unorm-srgb`.split(`.`):[]],iu}var ou;async function su(){return ou===void 0&&(ou=await(async()=>{let e=await Pc(),t=Mc();if(e&&t){let e=await au(),t=ru();return e.filter(e=>t.includes(e))}else if(e)return await au();else if(t)return ru();return[]})()),ou}var cu=`r8unorm.r8snorm.r8uint.r8sint.r16uint.r16sint.r16float.rg8unorm.rg8snorm.rg8uint.rg8sint.r32uint.r32sint.r32float.rg16uint.rg16sint.rg16float.rgba8unorm.rgba8unorm-srgb.rgba8snorm.rgba8uint.rgba8sint.bgra8unorm.bgra8unorm-srgb.rgb9e5ufloat.rgb10a2unorm.rg11b10ufloat.rg32uint.rg32sint.rg32float.rgba16uint.rgba16sint.rgba16float.rgba32uint.rgba32sint.rgba32float.stencil8.depth16unorm.depth24plus.depth24plus-stencil8.depth32float.depth32float-stencil8`.split(`.`),lu;async function uu(){if(lu!==void 0)return lu;let e=await su();return lu=[...cu,...e],lu}var du=`(function () {
    'use strict';

    function createLevelBuffers(basisTexture, basisTranscoderFormat) {
      const images = basisTexture.getNumImages();
      const levels = basisTexture.getNumLevels(0);
      const success = basisTexture.startTranscoding();
      if (!success) {
        throw new Error("startTranscoding failed");
      }
      const levelBuffers = [];
      for (let levelIndex = 0; levelIndex < levels; ++levelIndex) {
        for (let sliceIndex = 0; sliceIndex < images; ++sliceIndex) {
          const transcodeSize = basisTexture.getImageTranscodedSizeInBytes(sliceIndex, levelIndex, basisTranscoderFormat);
          const levelBuffer = new Uint8Array(transcodeSize);
          const success2 = basisTexture.transcodeImage(levelBuffer, sliceIndex, levelIndex, basisTranscoderFormat, 1, 0);
          if (!success2) {
            throw new Error("transcodeImage failed");
          }
          levelBuffers.push(levelBuffer);
        }
      }
      return levelBuffers;
    }

    const gpuFormatToBasisTranscoderFormatMap = {
      "bc3-rgba-unorm": 3,
      // cTFBC3_RGBA
      "bc7-rgba-unorm": 6,
      // cTFBC7_RGBA,
      "etc2-rgba8unorm": 1,
      // cTFETC2_RGBA,
      "astc-4x4-unorm": 10,
      // cTFASTC_4x4_RGBA,
      // Uncompressed
      rgba8unorm: 13,
      // cTFRGBA32,
      rgba4unorm: 16
      // cTFRGBA4444,
    };
    function gpuFormatToBasisTranscoderFormat(transcoderFormat) {
      const format = gpuFormatToBasisTranscoderFormatMap[transcoderFormat];
      if (format) {
        return format;
      }
      throw new Error(\`Unsupported transcoderFormat: \${transcoderFormat}\`);
    }

    const settings = {
      jsUrl: "basis/basis_transcoder.js",
      wasmUrl: "basis/basis_transcoder.wasm"
    };
    let basisTranscoderFormat;
    let basisTranscodedTextureFormat;
    let basisPromise;
    async function getBasis() {
      if (!basisPromise) {
        const absoluteJsUrl = new URL(settings.jsUrl, location.origin).href;
        const absoluteWasmUrl = new URL(settings.wasmUrl, location.origin).href;
        importScripts(absoluteJsUrl);
        basisPromise = new Promise((resolve) => {
          BASIS({
            locateFile: (_file) => absoluteWasmUrl
          }).then((module) => {
            module.initializeBasis();
            resolve(module.BasisFile);
          });
        });
      }
      return basisPromise;
    }
    async function fetchBasisTexture(url, BasisTexture) {
      const basisResponse = await fetch(url);
      if (basisResponse.ok) {
        const basisArrayBuffer = await basisResponse.arrayBuffer();
        return new BasisTexture(new Uint8Array(basisArrayBuffer));
      }
      throw new Error(\`Failed to load Basis texture: \${url}\`);
    }
    const preferredTranscodedFormat = [
      "bc7-rgba-unorm",
      "astc-4x4-unorm",
      "etc2-rgba8unorm",
      "bc3-rgba-unorm",
      "rgba8unorm"
    ];
    async function load(url) {
      const BasisTexture = await getBasis();
      const basisTexture = await fetchBasisTexture(url, BasisTexture);
      const levelBuffers = createLevelBuffers(basisTexture, basisTranscoderFormat);
      return {
        width: basisTexture.getImageWidth(0, 0),
        height: basisTexture.getImageHeight(0, 0),
        format: basisTranscodedTextureFormat,
        resource: levelBuffers,
        alphaMode: "no-premultiply-alpha"
      };
    }
    async function init(jsUrl, wasmUrl, supportedTextures) {
      if (jsUrl)
        settings.jsUrl = jsUrl;
      if (wasmUrl)
        settings.wasmUrl = wasmUrl;
      basisTranscodedTextureFormat = preferredTranscodedFormat.filter((format) => supportedTextures.includes(format))[0];
      basisTranscoderFormat = gpuFormatToBasisTranscoderFormat(basisTranscodedTextureFormat);
      await getBasis();
    }
    const messageHandlers = {
      init: async (data) => {
        const { jsUrl, wasmUrl, supportedTextures } = data;
        await init(jsUrl, wasmUrl, supportedTextures);
      },
      load: async (data) => {
        try {
          const textureOptions = await load(data.url);
          return {
            type: "load",
            url: data.url,
            success: true,
            textureOptions,
            transferables: textureOptions.resource?.map((arr) => arr.buffer)
          };
        } catch (e) {
          throw e;
        }
      }
    };
    self.onmessage = async (messageEvent) => {
      const message = messageEvent.data;
      const response = await messageHandlers[message.type](message);
      if (response) {
        self.postMessage(response, response.transferables);
      }
    };

})();
`,fu=null,pu=class{constructor(){fu||=URL.createObjectURL(new Blob([du],{type:`application/javascript`})),this.worker=new Worker(fu)}};pu.revokeObjectURL=function(){fu&&=(URL.revokeObjectURL(fu),null)};var mu={jsUrl:`https://cdn.jsdelivr.net/npm/pixi.js/transcoders/basis/basis_transcoder.js`,wasmUrl:`https://cdn.jsdelivr.net/npm/pixi.js/transcoders/basis/basis_transcoder.wasm`};function hu(e){Object.assign(mu,e)}var gu,_u={};function vu(e){return gu||(gu=new pu().worker,gu.onmessage=e=>{let{success:t,url:n,textureOptions:r}=e.data;t||console.warn(`Failed to load Basis texture`,n),_u[n](r)},gu.postMessage({type:`init`,jsUrl:mu.jsUrl,wasmUrl:mu.wasmUrl,supportedTextures:e})),gu}function yu(e,t){let n=vu(t);return new Promise(t=>{_u[e]=t,n.postMessage({type:`load`,url:e})})}var bu={extension:{type:C.LoadParser,priority:K.High,name:`loadBasis`},name:`loadBasis`,id:`basis`,test(e){return J(e,[`.basis`])},async load(e,t,n){return Sl(new tu(await yu(e,await uu())),n,e)},unload(e){Array.isArray(e)?e.forEach(e=>e.destroy(!0)):e.destroy(!0)}};function xu(e,t){let n=e.getNumImages(),r=e.getNumLevels(0);if(!e.startTranscoding())throw Error(`startTranscoding failed`);let i=[];for(let a=0;a<r;++a)for(let r=0;r<n;++r){let n=e.getImageTranscodedSizeInBytes(r,a,t),o=new Uint8Array(n);if(!e.transcodeImage(o,r,a,t,1,0))throw Error(`transcodeImage failed`);i.push(o)}return i}var Su={"bc3-rgba-unorm":3,"bc7-rgba-unorm":6,"etc2-rgba8unorm":1,"astc-4x4-unorm":10,rgba8unorm:13,rgba4unorm:16};function Cu(e){let t=Su[e];if(t)return t;throw Error(`Unsupported transcoderFormat: ${e}`)}var wu={MAGIC:0,SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19,PF_FLAGS:20,FOURCC:21,RGB_BITCOUNT:22,R_BIT_MASK:23,G_BIT_MASK:24,B_BIT_MASK:25,A_BIT_MASK:26},Tu={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},Eu=(e=>(e[e.DXGI_FORMAT_UNKNOWN=0]=`DXGI_FORMAT_UNKNOWN`,e[e.DXGI_FORMAT_R32G32B32A32_TYPELESS=1]=`DXGI_FORMAT_R32G32B32A32_TYPELESS`,e[e.DXGI_FORMAT_R32G32B32A32_FLOAT=2]=`DXGI_FORMAT_R32G32B32A32_FLOAT`,e[e.DXGI_FORMAT_R32G32B32A32_UINT=3]=`DXGI_FORMAT_R32G32B32A32_UINT`,e[e.DXGI_FORMAT_R32G32B32A32_SINT=4]=`DXGI_FORMAT_R32G32B32A32_SINT`,e[e.DXGI_FORMAT_R32G32B32_TYPELESS=5]=`DXGI_FORMAT_R32G32B32_TYPELESS`,e[e.DXGI_FORMAT_R32G32B32_FLOAT=6]=`DXGI_FORMAT_R32G32B32_FLOAT`,e[e.DXGI_FORMAT_R32G32B32_UINT=7]=`DXGI_FORMAT_R32G32B32_UINT`,e[e.DXGI_FORMAT_R32G32B32_SINT=8]=`DXGI_FORMAT_R32G32B32_SINT`,e[e.DXGI_FORMAT_R16G16B16A16_TYPELESS=9]=`DXGI_FORMAT_R16G16B16A16_TYPELESS`,e[e.DXGI_FORMAT_R16G16B16A16_FLOAT=10]=`DXGI_FORMAT_R16G16B16A16_FLOAT`,e[e.DXGI_FORMAT_R16G16B16A16_UNORM=11]=`DXGI_FORMAT_R16G16B16A16_UNORM`,e[e.DXGI_FORMAT_R16G16B16A16_UINT=12]=`DXGI_FORMAT_R16G16B16A16_UINT`,e[e.DXGI_FORMAT_R16G16B16A16_SNORM=13]=`DXGI_FORMAT_R16G16B16A16_SNORM`,e[e.DXGI_FORMAT_R16G16B16A16_SINT=14]=`DXGI_FORMAT_R16G16B16A16_SINT`,e[e.DXGI_FORMAT_R32G32_TYPELESS=15]=`DXGI_FORMAT_R32G32_TYPELESS`,e[e.DXGI_FORMAT_R32G32_FLOAT=16]=`DXGI_FORMAT_R32G32_FLOAT`,e[e.DXGI_FORMAT_R32G32_UINT=17]=`DXGI_FORMAT_R32G32_UINT`,e[e.DXGI_FORMAT_R32G32_SINT=18]=`DXGI_FORMAT_R32G32_SINT`,e[e.DXGI_FORMAT_R32G8X24_TYPELESS=19]=`DXGI_FORMAT_R32G8X24_TYPELESS`,e[e.DXGI_FORMAT_D32_FLOAT_S8X24_UINT=20]=`DXGI_FORMAT_D32_FLOAT_S8X24_UINT`,e[e.DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS=21]=`DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS`,e[e.DXGI_FORMAT_X32_TYPELESS_G8X24_UINT=22]=`DXGI_FORMAT_X32_TYPELESS_G8X24_UINT`,e[e.DXGI_FORMAT_R10G10B10A2_TYPELESS=23]=`DXGI_FORMAT_R10G10B10A2_TYPELESS`,e[e.DXGI_FORMAT_R10G10B10A2_UNORM=24]=`DXGI_FORMAT_R10G10B10A2_UNORM`,e[e.DXGI_FORMAT_R10G10B10A2_UINT=25]=`DXGI_FORMAT_R10G10B10A2_UINT`,e[e.DXGI_FORMAT_R11G11B10_FLOAT=26]=`DXGI_FORMAT_R11G11B10_FLOAT`,e[e.DXGI_FORMAT_R8G8B8A8_TYPELESS=27]=`DXGI_FORMAT_R8G8B8A8_TYPELESS`,e[e.DXGI_FORMAT_R8G8B8A8_UNORM=28]=`DXGI_FORMAT_R8G8B8A8_UNORM`,e[e.DXGI_FORMAT_R8G8B8A8_UNORM_SRGB=29]=`DXGI_FORMAT_R8G8B8A8_UNORM_SRGB`,e[e.DXGI_FORMAT_R8G8B8A8_UINT=30]=`DXGI_FORMAT_R8G8B8A8_UINT`,e[e.DXGI_FORMAT_R8G8B8A8_SNORM=31]=`DXGI_FORMAT_R8G8B8A8_SNORM`,e[e.DXGI_FORMAT_R8G8B8A8_SINT=32]=`DXGI_FORMAT_R8G8B8A8_SINT`,e[e.DXGI_FORMAT_R16G16_TYPELESS=33]=`DXGI_FORMAT_R16G16_TYPELESS`,e[e.DXGI_FORMAT_R16G16_FLOAT=34]=`DXGI_FORMAT_R16G16_FLOAT`,e[e.DXGI_FORMAT_R16G16_UNORM=35]=`DXGI_FORMAT_R16G16_UNORM`,e[e.DXGI_FORMAT_R16G16_UINT=36]=`DXGI_FORMAT_R16G16_UINT`,e[e.DXGI_FORMAT_R16G16_SNORM=37]=`DXGI_FORMAT_R16G16_SNORM`,e[e.DXGI_FORMAT_R16G16_SINT=38]=`DXGI_FORMAT_R16G16_SINT`,e[e.DXGI_FORMAT_R32_TYPELESS=39]=`DXGI_FORMAT_R32_TYPELESS`,e[e.DXGI_FORMAT_D32_FLOAT=40]=`DXGI_FORMAT_D32_FLOAT`,e[e.DXGI_FORMAT_R32_FLOAT=41]=`DXGI_FORMAT_R32_FLOAT`,e[e.DXGI_FORMAT_R32_UINT=42]=`DXGI_FORMAT_R32_UINT`,e[e.DXGI_FORMAT_R32_SINT=43]=`DXGI_FORMAT_R32_SINT`,e[e.DXGI_FORMAT_R24G8_TYPELESS=44]=`DXGI_FORMAT_R24G8_TYPELESS`,e[e.DXGI_FORMAT_D24_UNORM_S8_UINT=45]=`DXGI_FORMAT_D24_UNORM_S8_UINT`,e[e.DXGI_FORMAT_R24_UNORM_X8_TYPELESS=46]=`DXGI_FORMAT_R24_UNORM_X8_TYPELESS`,e[e.DXGI_FORMAT_X24_TYPELESS_G8_UINT=47]=`DXGI_FORMAT_X24_TYPELESS_G8_UINT`,e[e.DXGI_FORMAT_R8G8_TYPELESS=48]=`DXGI_FORMAT_R8G8_TYPELESS`,e[e.DXGI_FORMAT_R8G8_UNORM=49]=`DXGI_FORMAT_R8G8_UNORM`,e[e.DXGI_FORMAT_R8G8_UINT=50]=`DXGI_FORMAT_R8G8_UINT`,e[e.DXGI_FORMAT_R8G8_SNORM=51]=`DXGI_FORMAT_R8G8_SNORM`,e[e.DXGI_FORMAT_R8G8_SINT=52]=`DXGI_FORMAT_R8G8_SINT`,e[e.DXGI_FORMAT_R16_TYPELESS=53]=`DXGI_FORMAT_R16_TYPELESS`,e[e.DXGI_FORMAT_R16_FLOAT=54]=`DXGI_FORMAT_R16_FLOAT`,e[e.DXGI_FORMAT_D16_UNORM=55]=`DXGI_FORMAT_D16_UNORM`,e[e.DXGI_FORMAT_R16_UNORM=56]=`DXGI_FORMAT_R16_UNORM`,e[e.DXGI_FORMAT_R16_UINT=57]=`DXGI_FORMAT_R16_UINT`,e[e.DXGI_FORMAT_R16_SNORM=58]=`DXGI_FORMAT_R16_SNORM`,e[e.DXGI_FORMAT_R16_SINT=59]=`DXGI_FORMAT_R16_SINT`,e[e.DXGI_FORMAT_R8_TYPELESS=60]=`DXGI_FORMAT_R8_TYPELESS`,e[e.DXGI_FORMAT_R8_UNORM=61]=`DXGI_FORMAT_R8_UNORM`,e[e.DXGI_FORMAT_R8_UINT=62]=`DXGI_FORMAT_R8_UINT`,e[e.DXGI_FORMAT_R8_SNORM=63]=`DXGI_FORMAT_R8_SNORM`,e[e.DXGI_FORMAT_R8_SINT=64]=`DXGI_FORMAT_R8_SINT`,e[e.DXGI_FORMAT_A8_UNORM=65]=`DXGI_FORMAT_A8_UNORM`,e[e.DXGI_FORMAT_R1_UNORM=66]=`DXGI_FORMAT_R1_UNORM`,e[e.DXGI_FORMAT_R9G9B9E5_SHAREDEXP=67]=`DXGI_FORMAT_R9G9B9E5_SHAREDEXP`,e[e.DXGI_FORMAT_R8G8_B8G8_UNORM=68]=`DXGI_FORMAT_R8G8_B8G8_UNORM`,e[e.DXGI_FORMAT_G8R8_G8B8_UNORM=69]=`DXGI_FORMAT_G8R8_G8B8_UNORM`,e[e.DXGI_FORMAT_BC1_TYPELESS=70]=`DXGI_FORMAT_BC1_TYPELESS`,e[e.DXGI_FORMAT_BC1_UNORM=71]=`DXGI_FORMAT_BC1_UNORM`,e[e.DXGI_FORMAT_BC1_UNORM_SRGB=72]=`DXGI_FORMAT_BC1_UNORM_SRGB`,e[e.DXGI_FORMAT_BC2_TYPELESS=73]=`DXGI_FORMAT_BC2_TYPELESS`,e[e.DXGI_FORMAT_BC2_UNORM=74]=`DXGI_FORMAT_BC2_UNORM`,e[e.DXGI_FORMAT_BC2_UNORM_SRGB=75]=`DXGI_FORMAT_BC2_UNORM_SRGB`,e[e.DXGI_FORMAT_BC3_TYPELESS=76]=`DXGI_FORMAT_BC3_TYPELESS`,e[e.DXGI_FORMAT_BC3_UNORM=77]=`DXGI_FORMAT_BC3_UNORM`,e[e.DXGI_FORMAT_BC3_UNORM_SRGB=78]=`DXGI_FORMAT_BC3_UNORM_SRGB`,e[e.DXGI_FORMAT_BC4_TYPELESS=79]=`DXGI_FORMAT_BC4_TYPELESS`,e[e.DXGI_FORMAT_BC4_UNORM=80]=`DXGI_FORMAT_BC4_UNORM`,e[e.DXGI_FORMAT_BC4_SNORM=81]=`DXGI_FORMAT_BC4_SNORM`,e[e.DXGI_FORMAT_BC5_TYPELESS=82]=`DXGI_FORMAT_BC5_TYPELESS`,e[e.DXGI_FORMAT_BC5_UNORM=83]=`DXGI_FORMAT_BC5_UNORM`,e[e.DXGI_FORMAT_BC5_SNORM=84]=`DXGI_FORMAT_BC5_SNORM`,e[e.DXGI_FORMAT_B5G6R5_UNORM=85]=`DXGI_FORMAT_B5G6R5_UNORM`,e[e.DXGI_FORMAT_B5G5R5A1_UNORM=86]=`DXGI_FORMAT_B5G5R5A1_UNORM`,e[e.DXGI_FORMAT_B8G8R8A8_UNORM=87]=`DXGI_FORMAT_B8G8R8A8_UNORM`,e[e.DXGI_FORMAT_B8G8R8X8_UNORM=88]=`DXGI_FORMAT_B8G8R8X8_UNORM`,e[e.DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM=89]=`DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM`,e[e.DXGI_FORMAT_B8G8R8A8_TYPELESS=90]=`DXGI_FORMAT_B8G8R8A8_TYPELESS`,e[e.DXGI_FORMAT_B8G8R8A8_UNORM_SRGB=91]=`DXGI_FORMAT_B8G8R8A8_UNORM_SRGB`,e[e.DXGI_FORMAT_B8G8R8X8_TYPELESS=92]=`DXGI_FORMAT_B8G8R8X8_TYPELESS`,e[e.DXGI_FORMAT_B8G8R8X8_UNORM_SRGB=93]=`DXGI_FORMAT_B8G8R8X8_UNORM_SRGB`,e[e.DXGI_FORMAT_BC6H_TYPELESS=94]=`DXGI_FORMAT_BC6H_TYPELESS`,e[e.DXGI_FORMAT_BC6H_UF16=95]=`DXGI_FORMAT_BC6H_UF16`,e[e.DXGI_FORMAT_BC6H_SF16=96]=`DXGI_FORMAT_BC6H_SF16`,e[e.DXGI_FORMAT_BC7_TYPELESS=97]=`DXGI_FORMAT_BC7_TYPELESS`,e[e.DXGI_FORMAT_BC7_UNORM=98]=`DXGI_FORMAT_BC7_UNORM`,e[e.DXGI_FORMAT_BC7_UNORM_SRGB=99]=`DXGI_FORMAT_BC7_UNORM_SRGB`,e[e.DXGI_FORMAT_AYUV=100]=`DXGI_FORMAT_AYUV`,e[e.DXGI_FORMAT_Y410=101]=`DXGI_FORMAT_Y410`,e[e.DXGI_FORMAT_Y416=102]=`DXGI_FORMAT_Y416`,e[e.DXGI_FORMAT_NV12=103]=`DXGI_FORMAT_NV12`,e[e.DXGI_FORMAT_P010=104]=`DXGI_FORMAT_P010`,e[e.DXGI_FORMAT_P016=105]=`DXGI_FORMAT_P016`,e[e.DXGI_FORMAT_420_OPAQUE=106]=`DXGI_FORMAT_420_OPAQUE`,e[e.DXGI_FORMAT_YUY2=107]=`DXGI_FORMAT_YUY2`,e[e.DXGI_FORMAT_Y210=108]=`DXGI_FORMAT_Y210`,e[e.DXGI_FORMAT_Y216=109]=`DXGI_FORMAT_Y216`,e[e.DXGI_FORMAT_NV11=110]=`DXGI_FORMAT_NV11`,e[e.DXGI_FORMAT_AI44=111]=`DXGI_FORMAT_AI44`,e[e.DXGI_FORMAT_IA44=112]=`DXGI_FORMAT_IA44`,e[e.DXGI_FORMAT_P8=113]=`DXGI_FORMAT_P8`,e[e.DXGI_FORMAT_A8P8=114]=`DXGI_FORMAT_A8P8`,e[e.DXGI_FORMAT_B4G4R4A4_UNORM=115]=`DXGI_FORMAT_B4G4R4A4_UNORM`,e[e.DXGI_FORMAT_P208=116]=`DXGI_FORMAT_P208`,e[e.DXGI_FORMAT_V208=117]=`DXGI_FORMAT_V208`,e[e.DXGI_FORMAT_V408=118]=`DXGI_FORMAT_V408`,e[e.DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE=119]=`DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE`,e[e.DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE=120]=`DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE`,e[e.DXGI_FORMAT_FORCE_UINT=121]=`DXGI_FORMAT_FORCE_UINT`,e))(Eu||{}),Du=(e=>(e[e.DDS_DIMENSION_TEXTURE1D=2]=`DDS_DIMENSION_TEXTURE1D`,e[e.DDS_DIMENSION_TEXTURE2D=3]=`DDS_DIMENSION_TEXTURE2D`,e[e.DDS_DIMENSION_TEXTURE3D=6]=`DDS_DIMENSION_TEXTURE3D`,e))(Du||{});function Y(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}var X=(e=>(e[e.UNKNOWN=0]=`UNKNOWN`,e[e.R8G8B8=20]=`R8G8B8`,e[e.A8R8G8B8=21]=`A8R8G8B8`,e[e.X8R8G8B8=22]=`X8R8G8B8`,e[e.R5G6B5=23]=`R5G6B5`,e[e.X1R5G5B5=24]=`X1R5G5B5`,e[e.A1R5G5B5=25]=`A1R5G5B5`,e[e.A4R4G4B4=26]=`A4R4G4B4`,e[e.R3G3B2=27]=`R3G3B2`,e[e.A8=28]=`A8`,e[e.A8R3G3B2=29]=`A8R3G3B2`,e[e.X4R4G4B4=30]=`X4R4G4B4`,e[e.A2B10G10R10=31]=`A2B10G10R10`,e[e.A8B8G8R8=32]=`A8B8G8R8`,e[e.X8B8G8R8=33]=`X8B8G8R8`,e[e.G16R16=34]=`G16R16`,e[e.A2R10G10B10=35]=`A2R10G10B10`,e[e.A16B16G16R16=36]=`A16B16G16R16`,e[e.A8P8=40]=`A8P8`,e[e.P8=41]=`P8`,e[e.L8=50]=`L8`,e[e.A8L8=51]=`A8L8`,e[e.A4L4=52]=`A4L4`,e[e.V8U8=60]=`V8U8`,e[e.L6V5U5=61]=`L6V5U5`,e[e.X8L8V8U8=62]=`X8L8V8U8`,e[e.Q8W8V8U8=63]=`Q8W8V8U8`,e[e.V16U16=64]=`V16U16`,e[e.A2W10V10U10=67]=`A2W10V10U10`,e[e.Q16W16V16U16=110]=`Q16W16V16U16`,e[e.R16F=111]=`R16F`,e[e.G16R16F=112]=`G16R16F`,e[e.A16B16G16R16F=113]=`A16B16G16R16F`,e[e.R32F=114]=`R32F`,e[e.G32R32F=115]=`G32R32F`,e[e.A32B32G32R32F=116]=`A32B32G32R32F`,e[e.UYVY=Y(`UYVY`)]=`UYVY`,e[e.R8G8_B8G8=Y(`RGBG`)]=`R8G8_B8G8`,e[e.YUY2=Y(`YUY2`)]=`YUY2`,e[e.D3DFMT_G8R8_G8B8=Y(`GRGB`)]=`D3DFMT_G8R8_G8B8`,e[e.DXT1=Y(`DXT1`)]=`DXT1`,e[e.DXT2=Y(`DXT2`)]=`DXT2`,e[e.DXT3=Y(`DXT3`)]=`DXT3`,e[e.DXT4=Y(`DXT4`)]=`DXT4`,e[e.DXT5=Y(`DXT5`)]=`DXT5`,e[e.ATI1=Y(`ATI1`)]=`ATI1`,e[e.AT1N=Y(`AT1N`)]=`AT1N`,e[e.ATI2=Y(`ATI2`)]=`ATI2`,e[e.AT2N=Y(`AT2N`)]=`AT2N`,e[e.BC4U=Y(`BC4U`)]=`BC4U`,e[e.BC4S=Y(`BC4S`)]=`BC4S`,e[e.BC5U=Y(`BC5U`)]=`BC5U`,e[e.BC5S=Y(`BC5S`)]=`BC5S`,e[e.DX10=Y(`DX10`)]=`DX10`,e))(X||{}),Ou={[X.DXT1]:`bc1-rgba-unorm`,[X.DXT2]:`bc2-rgba-unorm`,[X.DXT3]:`bc2-rgba-unorm`,[X.DXT4]:`bc3-rgba-unorm`,[X.DXT5]:`bc3-rgba-unorm`,[X.ATI1]:`bc4-r-unorm`,[X.BC4U]:`bc4-r-unorm`,[X.BC4S]:`bc4-r-snorm`,[X.ATI2]:`bc5-rg-unorm`,[X.BC5U]:`bc5-rg-unorm`,[X.BC5S]:`bc5-rg-snorm`,36:`rgba16uint`,110:`rgba16sint`,111:`r16float`,112:`rg16float`,113:`rgba16float`,114:`r32float`,115:`rg32float`,116:`rgba32float`},Z={70:`bc1-rgba-unorm`,71:`bc1-rgba-unorm`,72:`bc1-rgba-unorm-srgb`,73:`bc2-rgba-unorm`,74:`bc2-rgba-unorm`,75:`bc2-rgba-unorm-srgb`,76:`bc3-rgba-unorm`,77:`bc3-rgba-unorm`,78:`bc3-rgba-unorm-srgb`,79:`bc4-r-unorm`,80:`bc4-r-unorm`,81:`bc4-r-snorm`,82:`bc5-rg-unorm`,83:`bc5-rg-unorm`,84:`bc5-rg-snorm`,94:`bc6h-rgb-ufloat`,95:`bc6h-rgb-ufloat`,96:`bc6h-rgb-float`,97:`bc7-rgba-unorm`,98:`bc7-rgba-unorm`,99:`bc7-rgba-unorm-srgb`,28:`rgba8unorm`,29:`rgba8unorm-srgb`,87:`bgra8unorm`,91:`bgra8unorm-srgb`,41:`r32float`,49:`rg8unorm`,56:`r16uint`,61:`r8unorm`,24:`rgb10a2unorm`,11:`rgba16uint`,13:`rgba16sint`,10:`rgba16float`,54:`r16float`,34:`rg16float`,16:`rg32float`,2:`rgba32float`},Q={MAGIC_VALUE:542327876,MAGIC_SIZE:4,HEADER_SIZE:124,HEADER_DX10_SIZE:20,PIXEL_FORMAT_FLAGS:{ALPHAPIXELS:1,ALPHA:2,FOURCC:4,RGB:64,RGBA:65,YUV:512,LUMINANCE:131072,LUMINANCEA:131073},RESOURCE_MISC_TEXTURECUBE:4,HEADER_FIELDS:wu,HEADER_DX10_FIELDS:Tu,DXGI_FORMAT:Eu,D3D10_RESOURCE_DIMENSION:Du,D3DFMT:X},ku={"bc1-rgba-unorm":8,"bc1-rgba-unorm-srgb":8,"bc2-rgba-unorm":16,"bc2-rgba-unorm-srgb":16,"bc3-rgba-unorm":16,"bc3-rgba-unorm-srgb":16,"bc4-r-unorm":8,"bc4-r-snorm":8,"bc5-rg-unorm":16,"bc5-rg-snorm":16,"bc6h-rgb-ufloat":16,"bc6h-rgb-float":16,"bc7-rgba-unorm":16,"bc7-rgba-unorm-srgb":16};function Au(e,t){let{format:n,fourCC:r,width:i,height:a,dataOffset:o,mipmapCount:s}=Mu(e);if(!t.includes(n))throw Error(`Unsupported texture format: ${r} ${n}, supported: ${t}`);return s<=1?{format:n,width:i,height:a,resource:[new Uint8Array(e,o)],alphaMode:`no-premultiply-alpha`}:{format:n,width:i,height:a,resource:ju(n,i,a,o,s,e),alphaMode:`no-premultiply-alpha`}}function ju(e,t,n,r,i,a){let o=[],s=ku[e],c=t,l=n,u=r;for(let e=0;e<i;++e){let e=Math.ceil(Math.max(4,c)/4)*4,t=Math.ceil(Math.max(4,l)/4)*4,n=s?e/4*t/4*s:c*l*4,r=new Uint8Array(a,u,n);o.push(r),u+=n,c=Math.max(c>>1,1),l=Math.max(l>>1,1)}return o}function Mu(e){let t=new Uint32Array(e,0,Q.HEADER_SIZE/Uint32Array.BYTES_PER_ELEMENT);if(t[Q.HEADER_FIELDS.MAGIC]!==Q.MAGIC_VALUE)throw Error(`Invalid magic number in DDS header`);let n=t[Q.HEADER_FIELDS.HEIGHT],r=t[Q.HEADER_FIELDS.WIDTH],i=Math.max(1,t[Q.HEADER_FIELDS.MIPMAP_COUNT]),a=t[Q.HEADER_FIELDS.PF_FLAGS],o=t[Q.HEADER_FIELDS.FOURCC];return{format:Nu(t,a,o,e),fourCC:o,width:r,height:n,dataOffset:Q.MAGIC_SIZE+Q.HEADER_SIZE+(o===Q.D3DFMT.DX10?Q.HEADER_DX10_SIZE:0),mipmapCount:i}}function Nu(e,t,n,r){if(t&Q.PIXEL_FORMAT_FLAGS.FOURCC){if(n===Q.D3DFMT.DX10){let e=new Uint32Array(r,Q.MAGIC_SIZE+Q.HEADER_SIZE,Q.HEADER_DX10_SIZE/Uint32Array.BYTES_PER_ELEMENT);if(e[Q.HEADER_DX10_FIELDS.MISC_FLAG]===Q.RESOURCE_MISC_TEXTURECUBE)throw Error(`DDSParser does not support cubemap textures`);if(e[Q.HEADER_DX10_FIELDS.RESOURCE_DIMENSION]===Q.D3D10_RESOURCE_DIMENSION.DDS_DIMENSION_TEXTURE3D)throw Error(`DDSParser does not supported 3D texture data`);let t=e[Q.HEADER_DX10_FIELDS.DXGI_FORMAT];if(t in Z)return Z[t];throw Error(`DDSParser cannot parse texture data with DXGI format ${t}`)}if(n in Ou)return Ou[n];throw Error(`DDSParser cannot parse texture data with fourCC format ${n}`)}if(t&Q.PIXEL_FORMAT_FLAGS.RGB||t&Q.PIXEL_FORMAT_FLAGS.RGBA)return Pu(e);throw t&Q.PIXEL_FORMAT_FLAGS.YUV?Error(`DDSParser does not supported YUV uncompressed texture data.`):t&Q.PIXEL_FORMAT_FLAGS.LUMINANCE||t&Q.PIXEL_FORMAT_FLAGS.LUMINANCEA?Error(`DDSParser does not support single-channel (lumninance) texture data!`):t&Q.PIXEL_FORMAT_FLAGS.ALPHA||t&Q.PIXEL_FORMAT_FLAGS.ALPHAPIXELS?Error(`DDSParser does not support single-channel (alpha) texture data!`):Error(`DDSParser failed to load a texture file due to an unknown reason!`)}function Pu(e){let t=e[Q.HEADER_FIELDS.RGB_BITCOUNT],n=e[Q.HEADER_FIELDS.R_BIT_MASK],r=e[Q.HEADER_FIELDS.G_BIT_MASK],i=e[Q.HEADER_FIELDS.B_BIT_MASK],a=e[Q.HEADER_FIELDS.A_BIT_MASK];switch(t){case 32:if(n===255&&r===65280&&i===16711680&&a===4278190080)return Z[Q.DXGI_FORMAT.DXGI_FORMAT_R8G8B8A8_UNORM];if(n===16711680&&r===65280&&i===255&&a===4278190080)return Z[Q.DXGI_FORMAT.DXGI_FORMAT_B8G8R8A8_UNORM];if(n===1072693248&&r===1047552&&i===1023&&a===3221225472)return Z[Q.DXGI_FORMAT.DXGI_FORMAT_R10G10B10A2_UNORM];if(n===65535&&r===4294901760&&i===0&&a===0)return Z[Q.DXGI_FORMAT.DXGI_FORMAT_R16G16_UNORM];if(n===4294967295&&r===0&&i===0&&a===0)return Z[Q.DXGI_FORMAT.DXGI_FORMAT_R32_FLOAT];break;case 24:break;case 16:if(n===31744&&r===992&&i===31&&a===32768)return Z[Q.DXGI_FORMAT.DXGI_FORMAT_B5G5R5A1_UNORM];if(n===63488&&r===2016&&i===31&&a===0)return Z[Q.DXGI_FORMAT.DXGI_FORMAT_B5G6R5_UNORM];if(n===3840&&r===240&&i===15&&a===61440)return Z[Q.DXGI_FORMAT.DXGI_FORMAT_B4G4R4A4_UNORM];if(n===255&&r===0&&i===0&&a===65280)return Z[Q.DXGI_FORMAT.DXGI_FORMAT_R8G8_UNORM];if(n===65535&&r===0&&i===0&&a===0)return Z[Q.DXGI_FORMAT.DXGI_FORMAT_R16_UNORM];break;case 8:if(n===255&&r===0&&i===0&&a===0)return Z[Q.DXGI_FORMAT.DXGI_FORMAT_R8_UNORM];break}throw Error(`DDSParser does not support uncompressed texture with configuration:
                bitCount = ${t}, rBitMask = ${n}, gBitMask = ${r}, aBitMask = ${a}`)}var Fu={extension:{type:C.LoadParser,priority:K.High,name:`loadDDS`},name:`loadDDS`,id:`dds`,test(e){return J(e,[`.dds`])},async load(e,t,n){let r=await uu();return Sl(new tu(Au(await(await fetch(e)).arrayBuffer(),r)),n,e)},unload(e){Array.isArray(e)?e.forEach(e=>e.destroy(!0)):e.destroy(!0)}},Iu=(e=>(e[e.RGBA8_SNORM=36759]=`RGBA8_SNORM`,e[e.RGBA=6408]=`RGBA`,e[e.RGBA8UI=36220]=`RGBA8UI`,e[e.SRGB8_ALPHA8=35907]=`SRGB8_ALPHA8`,e[e.RGBA8I=36238]=`RGBA8I`,e[e.RGBA8=32856]=`RGBA8`,e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]=`COMPRESSED_RGB_S3TC_DXT1_EXT`,e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]=`COMPRESSED_RGBA_S3TC_DXT1_EXT`,e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]=`COMPRESSED_RGBA_S3TC_DXT3_EXT`,e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]=`COMPRESSED_RGBA_S3TC_DXT5_EXT`,e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]=`COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT`,e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]=`COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT`,e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]=`COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT`,e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]=`COMPRESSED_SRGB_S3TC_DXT1_EXT`,e[e.COMPRESSED_RED_RGTC1_EXT=36283]=`COMPRESSED_RED_RGTC1_EXT`,e[e.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]=`COMPRESSED_SIGNED_RED_RGTC1_EXT`,e[e.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]=`COMPRESSED_RED_GREEN_RGTC2_EXT`,e[e.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]=`COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT`,e[e.COMPRESSED_R11_EAC=37488]=`COMPRESSED_R11_EAC`,e[e.COMPRESSED_SIGNED_R11_EAC=37489]=`COMPRESSED_SIGNED_R11_EAC`,e[e.COMPRESSED_RG11_EAC=37490]=`COMPRESSED_RG11_EAC`,e[e.COMPRESSED_SIGNED_RG11_EAC=37491]=`COMPRESSED_SIGNED_RG11_EAC`,e[e.COMPRESSED_RGB8_ETC2=37492]=`COMPRESSED_RGB8_ETC2`,e[e.COMPRESSED_RGBA8_ETC2_EAC=37496]=`COMPRESSED_RGBA8_ETC2_EAC`,e[e.COMPRESSED_SRGB8_ETC2=37493]=`COMPRESSED_SRGB8_ETC2`,e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]=`COMPRESSED_SRGB8_ALPHA8_ETC2_EAC`,e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]=`COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2`,e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]=`COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2`,e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]=`COMPRESSED_RGBA_ASTC_4x4_KHR`,e[e.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]=`COMPRESSED_RGBA_ASTC_5x4_KHR`,e[e.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]=`COMPRESSED_RGBA_ASTC_5x5_KHR`,e[e.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]=`COMPRESSED_RGBA_ASTC_6x5_KHR`,e[e.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]=`COMPRESSED_RGBA_ASTC_6x6_KHR`,e[e.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]=`COMPRESSED_RGBA_ASTC_8x5_KHR`,e[e.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]=`COMPRESSED_RGBA_ASTC_8x6_KHR`,e[e.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]=`COMPRESSED_RGBA_ASTC_8x8_KHR`,e[e.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]=`COMPRESSED_RGBA_ASTC_10x5_KHR`,e[e.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]=`COMPRESSED_RGBA_ASTC_10x6_KHR`,e[e.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]=`COMPRESSED_RGBA_ASTC_10x8_KHR`,e[e.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]=`COMPRESSED_RGBA_ASTC_10x10_KHR`,e[e.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]=`COMPRESSED_RGBA_ASTC_12x10_KHR`,e[e.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]=`COMPRESSED_RGBA_ASTC_12x12_KHR`,e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]=`COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR`,e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]=`COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR`,e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]=`COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR`,e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]=`COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR`,e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]=`COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR`,e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]=`COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR`,e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]=`COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR`,e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]=`COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR`,e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]=`COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR`,e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]=`COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR`,e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]=`COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR`,e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]=`COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR`,e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]=`COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR`,e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]=`COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR`,e[e.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]=`COMPRESSED_RGBA_BPTC_UNORM_EXT`,e[e.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]=`COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT`,e[e.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]=`COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT`,e[e.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]=`COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT`,e))(Iu||{}),Lu={33776:`bc1-rgba-unorm`,33777:`bc1-rgba-unorm`,33778:`bc2-rgba-unorm`,33779:`bc3-rgba-unorm`,35916:`bc1-rgba-unorm-srgb`,35917:`bc1-rgba-unorm-srgb`,35918:`bc2-rgba-unorm-srgb`,35919:`bc3-rgba-unorm-srgb`,36283:`bc4-r-unorm`,36284:`bc4-r-snorm`,36285:`bc5-rg-unorm`,36286:`bc5-rg-snorm`,37488:`eac-r11unorm`,37490:`eac-rg11snorm`,37492:`etc2-rgb8unorm`,37496:`etc2-rgba8unorm`,37493:`etc2-rgb8unorm-srgb`,37497:`etc2-rgba8unorm-srgb`,37494:`etc2-rgb8a1unorm`,37495:`etc2-rgb8a1unorm-srgb`,37808:`astc-4x4-unorm`,37840:`astc-4x4-unorm-srgb`,37809:`astc-5x4-unorm`,37841:`astc-5x4-unorm-srgb`,37810:`astc-5x5-unorm`,37842:`astc-5x5-unorm-srgb`,37811:`astc-6x5-unorm`,37843:`astc-6x5-unorm-srgb`,37812:`astc-6x6-unorm`,37844:`astc-6x6-unorm-srgb`,37813:`astc-8x5-unorm`,37845:`astc-8x5-unorm-srgb`,37814:`astc-8x6-unorm`,37846:`astc-8x6-unorm-srgb`,37815:`astc-8x8-unorm`,37847:`astc-8x8-unorm-srgb`,37816:`astc-10x5-unorm`,37848:`astc-10x5-unorm-srgb`,37817:`astc-10x6-unorm`,37849:`astc-10x6-unorm-srgb`,37818:`astc-10x8-unorm`,37850:`astc-10x8-unorm-srgb`,37819:`astc-10x10-unorm`,37851:`astc-10x10-unorm-srgb`,37820:`astc-12x10-unorm`,37852:`astc-12x10-unorm-srgb`,37821:`astc-12x12-unorm`,37853:`astc-12x12-unorm-srgb`,36492:`bc7-rgba-unorm`,36493:`bc7-rgba-unorm-srgb`,36494:`bc6h-rgb-float`,36495:`bc6h-rgb-ufloat`,35907:`rgba8unorm-srgb`,36759:`rgba8snorm`,36220:`rgba8uint`,36238:`rgba8sint`,6408:`rgba8unorm`},Ru=[171,75,84,88,32,49,49,187,13,10,26,10],zu={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},Bu=64,Vu=67305985,Hu={5121:1,5123:2,5124:4,5125:4,5126:4,36193:8},Uu={6408:4,6407:3,33319:2,6403:1,6409:1,6410:2,6406:1},Wu={32819:2,32820:2,33635:2},$={FILE_HEADER_SIZE:Bu,FILE_IDENTIFIER:Ru,FORMATS_TO_COMPONENTS:Uu,INTERNAL_FORMAT_TO_BYTES_PER_PIXEL:{33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,36283:.5,36284:.5,36285:1,36286:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,37808:1,37840:1,37809:.8,37841:.8,37810:.64,37842:.64,37811:.53375,37843:.53375,37812:.445,37844:.445,37813:.4,37845:.4,37814:.33375,37846:.33375,37815:.25,37847:.25,37816:.32,37848:.32,37817:.26625,37849:.26625,37818:.2,37850:.2,37819:.16,37851:.16,37820:.13375,37852:.13375,37821:.11125,37853:.11125,36492:1,36493:1,36494:1,36495:1},INTERNAL_FORMAT_TO_TEXTURE_FORMATS:Lu,FIELDS:zu,TYPES_TO_BYTES_PER_COMPONENT:Hu,TYPES_TO_BYTES_PER_PIXEL:Wu,ENDIANNESS:Vu};function Gu(e,t){let n=new DataView(e);if(!Yu(n))throw Error(`Invalid KTX identifier in header`);let{littleEndian:r,glType:i,glFormat:a,glInternalFormat:o,pixelWidth:s,pixelHeight:c,numberOfMipmapLevels:l,offset:u}=Ju(n),d=$.INTERNAL_FORMAT_TO_TEXTURE_FORMATS[o];if(!d)throw Error(`Unknown texture format ${o}`);if(!t.includes(d))throw Error(`Unsupported texture format: ${d}, supportedFormats: ${t}`);return{format:d,width:s,height:c,resource:Ku(n,i,qu(i,a,o),s,c,u,l,r),alphaMode:`no-premultiply-alpha`}}function Ku(e,t,n,r,i,a,o,s){let c=r+3&-4,l=i+3&-4,u=r*i;t===0&&(u=c*l);let d=u*n,f=r,p=i,m=c,h=l,g=a,_=Array(o);for(let t=0;t<o;t++){let r=e.getUint32(g,s),i=g+4;_[t]=new Uint8Array(e.buffer,i,d),i+=d,g+=r+4,g=g%4==0?g:g+4-g%4,f=f>>1||1,p=p>>1||1,m=f+4-1&-4,h=p+4-1&-4,d=m*h*n}return _}function qu(e,t,n){let r=$.INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[n];if(e!==0&&(r=$.TYPES_TO_BYTES_PER_COMPONENT[e]?$.TYPES_TO_BYTES_PER_COMPONENT[e]*$.FORMATS_TO_COMPONENTS[t]:$.TYPES_TO_BYTES_PER_PIXEL[e]),r===void 0)throw Error(`Unable to resolve the pixel format stored in the *.ktx file!`);return r}function Ju(e){let t=e.getUint32($.FIELDS.ENDIANNESS,!0)===$.ENDIANNESS,n=e.getUint32($.FIELDS.GL_TYPE,t),r=e.getUint32($.FIELDS.GL_FORMAT,t),i=e.getUint32($.FIELDS.GL_INTERNAL_FORMAT,t),a=e.getUint32($.FIELDS.PIXEL_WIDTH,t),o=e.getUint32($.FIELDS.PIXEL_HEIGHT,t)||1,s=e.getUint32($.FIELDS.PIXEL_DEPTH,t)||1,c=e.getUint32($.FIELDS.NUMBER_OF_ARRAY_ELEMENTS,t)||1,l=e.getUint32($.FIELDS.NUMBER_OF_FACES,t),u=e.getUint32($.FIELDS.NUMBER_OF_MIPMAP_LEVELS,t),d=e.getUint32($.FIELDS.BYTES_OF_KEY_VALUE_DATA,t);if(o===0||s!==1)throw Error(`Only 2D textures are supported`);if(l!==1)throw Error(`CubeTextures are not supported by KTXLoader yet!`);if(c!==1)throw Error(`WebGL does not support array textures`);return{littleEndian:t,glType:n,glFormat:r,glInternalFormat:i,pixelWidth:a,pixelHeight:o,numberOfMipmapLevels:u,offset:$.FILE_HEADER_SIZE+d}}function Yu(e){for(let t=0;t<$.FILE_IDENTIFIER.length;t++)if(e.getUint8(t)!==$.FILE_IDENTIFIER[t])return!1;return!0}var Xu={extension:{type:C.LoadParser,priority:K.High,name:`loadKTX`},name:`loadKTX`,id:`ktx`,test(e){return J(e,`.ktx`)},async load(e,t,n){let r=await uu();return Sl(new tu(Gu(await(await fetch(e)).arrayBuffer(),r)),n,e)},unload(e){Array.isArray(e)?e.forEach(e=>e.destroy(!0)):e.destroy(!0)}},Zu=`(function () {
    'use strict';

    const converters = {
      rgb8unorm: {
        convertedFormat: "rgba8unorm",
        convertFunction: convertRGBtoRGBA
      },
      "rgb8unorm-srgb": {
        convertedFormat: "rgba8unorm-srgb",
        convertFunction: convertRGBtoRGBA
      }
    };
    function convertFormatIfRequired(textureOptions) {
      const format = textureOptions.format;
      if (converters[format]) {
        const convertFunction = converters[format].convertFunction;
        const levelBuffers = textureOptions.resource;
        for (let i = 0; i < levelBuffers.length; i++) {
          levelBuffers[i] = convertFunction(levelBuffers[i]);
        }
        textureOptions.format = converters[format].convertedFormat;
      }
    }
    function convertRGBtoRGBA(levelBuffer) {
      const pixelCount = levelBuffer.byteLength / 3;
      const levelBufferWithAlpha = new Uint32Array(pixelCount);
      for (let i = 0; i < pixelCount; ++i) {
        levelBufferWithAlpha[i] = levelBuffer[i * 3] + (levelBuffer[i * 3 + 1] << 8) + (levelBuffer[i * 3 + 2] << 16) + 4278190080;
      }
      return new Uint8Array(levelBufferWithAlpha.buffer);
    }

    function createLevelBuffersFromKTX(ktxTexture) {
      const levelBuffers = [];
      for (let i = 0; i < ktxTexture.numLevels; i++) {
        const imageData = ktxTexture.getImageData(i, 0, 0);
        const levelBuffer = new Uint8Array(imageData.byteLength);
        levelBuffer.set(imageData);
        levelBuffers.push(levelBuffer);
      }
      return levelBuffers;
    }

    const glFormatToGPUFormatMap = {
      6408: "rgba8unorm",
      32856: "bgra8unorm",
      //
      32857: "rgb10a2unorm",
      33189: "depth16unorm",
      33190: "depth24plus",
      33321: "r8unorm",
      33323: "rg8unorm",
      33325: "r16float",
      33326: "r32float",
      33327: "rg16float",
      33328: "rg32float",
      33329: "r8sint",
      33330: "r8uint",
      33331: "r16sint",
      33332: "r16uint",
      33333: "r32sint",
      33334: "r32uint",
      33335: "rg8sint",
      33336: "rg8uint",
      33337: "rg16sint",
      33338: "rg16uint",
      33339: "rg32sint",
      33340: "rg32uint",
      33778: "bc2-rgba-unorm",
      33779: "bc3-rgba-unorm",
      34836: "rgba32float",
      34842: "rgba16float",
      35056: "depth24plus-stencil8",
      35898: "rg11b10ufloat",
      35901: "rgb9e5ufloat",
      35907: "rgba8unorm-srgb",
      // bgra8unorm-srgb
      36012: "depth32float",
      36013: "depth32float-stencil8",
      36168: "stencil8",
      36208: "rgba32uint",
      36214: "rgba16uint",
      36220: "rgba8uint",
      36226: "rgba32sint",
      36232: "rgba16sint",
      36238: "rgba8sint",
      36492: "bc7-rgba-unorm",
      36756: "r8snorm",
      36757: "rg8snorm",
      36759: "rgba8snorm",
      37496: "etc2-rgba8unorm",
      37808: "astc-4x4-unorm"
    };
    function glFormatToGPUFormat(glInternalFormat) {
      const format = glFormatToGPUFormatMap[glInternalFormat];
      if (format) {
        return format;
      }
      throw new Error(\`Unsupported glInternalFormat: \${glInternalFormat}\`);
    }

    const vkFormatToGPUFormatMap = {
      23: "rgb8unorm",
      // VK_FORMAT_R8G8B8_UNORM
      37: "rgba8unorm",
      // VK_FORMAT_R8G8B8A8_UNORM
      43: "rgba8unorm-srgb"
      // VK_FORMAT_R8G8B8A8_SRGB
      // TODO add more!
    };
    function vkFormatToGPUFormat(vkFormat) {
      const format = vkFormatToGPUFormatMap[vkFormat];
      if (format) {
        return format;
      }
      throw new Error(\`Unsupported VkFormat: \${vkFormat}\`);
    }

    function getTextureFormatFromKTXTexture(ktxTexture) {
      if (ktxTexture.classId === 2) {
        return vkFormatToGPUFormat(ktxTexture.vkFormat);
      }
      return glFormatToGPUFormat(ktxTexture.glInternalformat);
    }

    const gpuFormatToBasisTranscoderFormatMap = {
      "bc3-rgba-unorm": "BC3_RGBA",
      "bc7-rgba-unorm": "BC7_M5_RGBA",
      "etc2-rgba8unorm": "ETC2_RGBA",
      "astc-4x4-unorm": "ASTC_4x4_RGBA",
      // Uncompressed
      rgba8unorm: "RGBA32",
      rg11b10ufloat: "R11F_G11F_B10F"
    };
    function gpuFormatToKTXBasisTranscoderFormat(transcoderFormat) {
      const format = gpuFormatToBasisTranscoderFormatMap[transcoderFormat];
      if (format) {
        return format;
      }
      throw new Error(\`Unsupported transcoderFormat: \${transcoderFormat}\`);
    }

    const settings = {
      jsUrl: "",
      wasmUrl: ""
    };
    let basisTranscoderFormat;
    let basisTranscodedTextureFormat;
    let ktxPromise;
    async function getKTX() {
      if (!ktxPromise) {
        const absoluteJsUrl = new URL(settings.jsUrl, location.origin).href;
        const absoluteWasmUrl = new URL(settings.wasmUrl, location.origin).href;
        importScripts(absoluteJsUrl);
        ktxPromise = new Promise((resolve) => {
          LIBKTX({
            locateFile: (_file) => absoluteWasmUrl
          }).then((libktx) => {
            resolve(libktx);
          });
        });
      }
      return ktxPromise;
    }
    async function fetchKTXTexture(url, ktx) {
      const ktx2Response = await fetch(url);
      if (ktx2Response.ok) {
        const ktx2ArrayBuffer = await ktx2Response.arrayBuffer();
        return new ktx.ktxTexture(new Uint8Array(ktx2ArrayBuffer));
      }
      throw new Error(\`Failed to load KTX(2) texture: \${url}\`);
    }
    const preferredTranscodedFormat = [
      "bc7-rgba-unorm",
      "astc-4x4-unorm",
      "etc2-rgba8unorm",
      "bc3-rgba-unorm",
      "rgba8unorm"
    ];
    async function load(url) {
      const ktx = await getKTX();
      const ktxTexture = await fetchKTXTexture(url, ktx);
      let format;
      if (ktxTexture.needsTranscoding) {
        format = basisTranscodedTextureFormat;
        const transcodeFormat = ktx.TranscodeTarget[basisTranscoderFormat];
        const result = ktxTexture.transcodeBasis(transcodeFormat, 0);
        if (result !== ktx.ErrorCode.SUCCESS) {
          throw new Error("Unable to transcode basis texture.");
        }
      } else {
        format = getTextureFormatFromKTXTexture(ktxTexture);
      }
      const levelBuffers = createLevelBuffersFromKTX(ktxTexture);
      const textureOptions = {
        width: ktxTexture.baseWidth,
        height: ktxTexture.baseHeight,
        format,
        mipLevelCount: ktxTexture.numLevels,
        resource: levelBuffers,
        alphaMode: "no-premultiply-alpha"
      };
      convertFormatIfRequired(textureOptions);
      return textureOptions;
    }
    async function init(jsUrl, wasmUrl, supportedTextures) {
      if (jsUrl)
        settings.jsUrl = jsUrl;
      if (wasmUrl)
        settings.wasmUrl = wasmUrl;
      basisTranscodedTextureFormat = preferredTranscodedFormat.filter((format) => supportedTextures.includes(format))[0];
      basisTranscoderFormat = gpuFormatToKTXBasisTranscoderFormat(basisTranscodedTextureFormat);
      await getKTX();
    }
    const messageHandlers = {
      init: async (data) => {
        const { jsUrl, wasmUrl, supportedTextures } = data;
        await init(jsUrl, wasmUrl, supportedTextures);
      },
      load: async (data) => {
        try {
          const textureOptions = await load(data.url);
          return {
            type: "load",
            url: data.url,
            success: true,
            textureOptions,
            transferables: textureOptions.resource?.map((arr) => arr.buffer)
          };
        } catch (e) {
          throw e;
        }
      }
    };
    self.onmessage = async (messageEvent) => {
      const message = messageEvent.data;
      const response = await messageHandlers[message.type]?.(message);
      if (response) {
        self.postMessage(response, response.transferables);
      }
    };

})();
`,Qu=null,$u=class{constructor(){Qu||=URL.createObjectURL(new Blob([Zu],{type:`application/javascript`})),this.worker=new Worker(Qu)}};$u.revokeObjectURL=function(){Qu&&=(URL.revokeObjectURL(Qu),null)};var ed={jsUrl:`https://cdn.jsdelivr.net/npm/pixi.js/transcoders/ktx/libktx.js`,wasmUrl:`https://cdn.jsdelivr.net/npm/pixi.js/transcoders/ktx/libktx.wasm`};function td(e){Object.assign(ed,e)}var nd,rd={};function id(e){return nd||(nd=new $u().worker,nd.onmessage=e=>{let{success:t,url:n,textureOptions:r}=e.data;t||console.warn(`Failed to load KTX texture`,n),rd[n](r)},nd.postMessage({type:`init`,jsUrl:ed.jsUrl,wasmUrl:ed.wasmUrl,supportedTextures:e})),nd}function ad(e,t){let n=id(t);return new Promise(t=>{rd[e]=t,n.postMessage({type:`load`,url:e})})}var od={extension:{type:C.LoadParser,priority:K.High,name:`loadKTX2`},name:`loadKTX2`,id:`ktx2`,test(e){return J(e,`.ktx2`)},async load(e,t,n){return Sl(new tu(await ad(e,await uu())),n,e)},async unload(e){Array.isArray(e)?e.forEach(e=>e.destroy(!0)):e.destroy(!0)}},sd={rgb8unorm:{convertedFormat:`rgba8unorm`,convertFunction:ld},"rgb8unorm-srgb":{convertedFormat:`rgba8unorm-srgb`,convertFunction:ld}};function cd(e){let t=e.format;if(sd[t]){let n=sd[t].convertFunction,r=e.resource;for(let e=0;e<r.length;e++)r[e]=n(r[e]);e.format=sd[t].convertedFormat}}function ld(e){let t=e.byteLength/3,n=new Uint32Array(t);for(let r=0;r<t;++r)n[r]=e[r*3]+(e[r*3+1]<<8)+(e[r*3+2]<<16)+4278190080;return new Uint8Array(n.buffer)}function ud(e){let t=[];for(let n=0;n<e.numLevels;n++){let r=e.getImageData(n,0,0),i=new Uint8Array(r.byteLength);i.set(r),t.push(i)}return t}var dd={6408:`rgba8unorm`,32856:`bgra8unorm`,32857:`rgb10a2unorm`,33189:`depth16unorm`,33190:`depth24plus`,33321:`r8unorm`,33323:`rg8unorm`,33325:`r16float`,33326:`r32float`,33327:`rg16float`,33328:`rg32float`,33329:`r8sint`,33330:`r8uint`,33331:`r16sint`,33332:`r16uint`,33333:`r32sint`,33334:`r32uint`,33335:`rg8sint`,33336:`rg8uint`,33337:`rg16sint`,33338:`rg16uint`,33339:`rg32sint`,33340:`rg32uint`,33778:`bc2-rgba-unorm`,33779:`bc3-rgba-unorm`,34836:`rgba32float`,34842:`rgba16float`,35056:`depth24plus-stencil8`,35898:`rg11b10ufloat`,35901:`rgb9e5ufloat`,35907:`rgba8unorm-srgb`,36012:`depth32float`,36013:`depth32float-stencil8`,36168:`stencil8`,36208:`rgba32uint`,36214:`rgba16uint`,36220:`rgba8uint`,36226:`rgba32sint`,36232:`rgba16sint`,36238:`rgba8sint`,36492:`bc7-rgba-unorm`,36756:`r8snorm`,36757:`rg8snorm`,36759:`rgba8snorm`,37496:`etc2-rgba8unorm`,37808:`astc-4x4-unorm`};function fd(e){let t=dd[e];if(t)return t;throw Error(`Unsupported glInternalFormat: ${e}`)}var pd={23:`rgb8unorm`,37:`rgba8unorm`,43:`rgba8unorm-srgb`};function md(e){let t=pd[e];if(t)return t;throw Error(`Unsupported VkFormat: ${e}`)}function hd(e){return e.classId===2?md(e.vkFormat):fd(e.glInternalformat)}var gd={"bc3-rgba-unorm":`BC3_RGBA`,"bc7-rgba-unorm":`BC7_M5_RGBA`,"etc2-rgba8unorm":`ETC2_RGBA`,"astc-4x4-unorm":`ASTC_4x4_RGBA`,rgba8unorm:`RGBA32`,rg11b10ufloat:`R11F_G11F_B10F`};function _d(e){let t=gd[e];if(t)return t;throw Error(`Unsupported transcoderFormat: ${e}`)}var vd=[`basis`,`bc7`,`bc6h`,`astc`,`etc2`,`bc5`,`bc4`,`bc3`,`bc2`,`bc1`,`eac`],yd={extension:C.ResolveParser,test:e=>J(e,[`.ktx`,`.ktx2`,`.dds`]),parse:e=>{let t,n=e.split(`.`);if(n.length>2){let e=n[n.length-2];vd.includes(e)&&(t=e)}else t=n[n.length-1];return{resolution:parseFloat(Xn.RETINA_PREFIX.exec(e)?.[1]??`1`),format:t,src:e}}},bd,xd={extension:{type:C.DetectionParser,priority:2},test:async()=>!!(await Pc()||Mc()),add:async e=>(bd=Sd(await su()),[...bd,...e]),remove:async e=>bd?e.filter(e=>!(e in bd)):e};function Sd(e){let t=[`basis`],n={};return e.forEach(e=>{let r=e.split(`-`)[0];r&&!n[r]&&(n[r]=!0,t.push(r))}),t.sort((e,t)=>{let n=vd.indexOf(e),r=vd.indexOf(t);return n===-1?1:r===-1?-1:n-r}),t}var Cd=new Xe,wd=class{cull(e,t,n=!0){this._cullRecursive(e,t,n)}_cullRecursive(e,t,n=!0){if(e.cullable&&e.measurable&&e.includeInBuild){let r=e.cullArea??Nt(e,n,Cd);e.culled=r.x>=t.x+t.width||r.y>=t.y+t.height||r.x+r.width<=t.x||r.y+r.height<=t.y}else e.culled=!1;if(!(!e.cullableChildren||e.culled||!e.renderable||!e.measurable||!e.includeInBuild))for(let r=0;r<e.children.length;r++)this._cullRecursive(e.children[r],t,n)}};wd.shared=new wd;var Td=wd,Ed=class{static init(e){this._renderRef=this.render.bind(this),this.render=()=>{let t=e?.culler?.updateTransform!==!0;Td.shared.cull(this.stage,this.renderer.screen,t),this.renderer.render({container:this.stage})}}static destroy(){this.render=this._renderRef}};Ed.extension={priority:10,type:C.Application,name:`culler`};var Dd=x((e=>{function t(e,t,n){if(n===void 0&&(n=Array.prototype),e&&typeof n.find==`function`)return n.find.call(e,t);for(var r=0;r<e.length;r++)if(Object.prototype.hasOwnProperty.call(e,r)){var i=e[r];if(t.call(void 0,i,r,e))return i}}function n(e,t){return t===void 0&&(t=Object),t&&typeof t.freeze==`function`?t.freeze(e):e}function r(e,t){if(typeof e!=`object`||!e)throw TypeError(`target is not an object`);for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}var i=n({HTML:`text/html`,isHTML:function(e){return e===i.HTML},XML_APPLICATION:`application/xml`,XML_TEXT:`text/xml`,XML_XHTML_APPLICATION:`application/xhtml+xml`,XML_SVG_IMAGE:`image/svg+xml`}),a=n({HTML:`http://www.w3.org/1999/xhtml`,isHTML:function(e){return e===a.HTML},SVG:`http://www.w3.org/2000/svg`,XML:`http://www.w3.org/XML/1998/namespace`,XMLNS:`http://www.w3.org/2000/xmlns/`});e.assign=r,e.find=t,e.freeze=n,e.MIME_TYPE=i,e.NAMESPACE=a})),Od=x((e=>{var t=Dd(),n=t.find,r=t.NAMESPACE;function i(e){return e!==``}function a(e){return e?e.split(/[\t\n\f\r ]+/).filter(i):[]}function o(e,t){return e.hasOwnProperty(t)||(e[t]=!0),e}function s(e){if(!e)return[];var t=a(e);return Object.keys(t.reduce(o,{}))}function c(e){return function(t){return e&&e.indexOf(t)!==-1}}function l(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}function u(e,t){var n=e.prototype;if(!(n instanceof t)){function r(){}r.prototype=t.prototype,r=new r,l(n,r),e.prototype=n=r}n.constructor!=e&&(typeof e!=`function`&&console.error(`unknown Class:`+e),n.constructor=e)}var d={},f=d.ELEMENT_NODE=1,p=d.ATTRIBUTE_NODE=2,m=d.TEXT_NODE=3,h=d.CDATA_SECTION_NODE=4,g=d.ENTITY_REFERENCE_NODE=5,_=d.ENTITY_NODE=6,v=d.PROCESSING_INSTRUCTION_NODE=7,y=d.COMMENT_NODE=8,b=d.DOCUMENT_NODE=9,x=d.DOCUMENT_TYPE_NODE=10,S=d.DOCUMENT_FRAGMENT_NODE=11,ee=d.NOTATION_NODE=12,C={},w={};C.INDEX_SIZE_ERR=(w[1]=`Index size error`,1),C.DOMSTRING_SIZE_ERR=(w[2]=`DOMString size error`,2);var T=C.HIERARCHY_REQUEST_ERR=(w[3]=`Hierarchy request error`,3);C.WRONG_DOCUMENT_ERR=(w[4]=`Wrong document`,4),C.INVALID_CHARACTER_ERR=(w[5]=`Invalid character`,5),C.NO_DATA_ALLOWED_ERR=(w[6]=`No data allowed`,6),C.NO_MODIFICATION_ALLOWED_ERR=(w[7]=`No modification allowed`,7);var E=C.NOT_FOUND_ERR=(w[8]=`Not found`,8);C.NOT_SUPPORTED_ERR=(w[9]=`Not supported`,9);var D=C.INUSE_ATTRIBUTE_ERR=(w[10]=`Attribute in use`,10);C.INVALID_STATE_ERR=(w[11]=`Invalid state`,11),C.SYNTAX_ERR=(w[12]=`Syntax error`,12),C.INVALID_MODIFICATION_ERR=(w[13]=`Invalid modification`,13),C.NAMESPACE_ERR=(w[14]=`Invalid namespace`,14),C.INVALID_ACCESS_ERR=(w[15]=`Invalid access`,15);function O(e,t){if(t instanceof Error)var n=t;else n=this,Error.call(this,w[e]),this.message=w[e],Error.captureStackTrace&&Error.captureStackTrace(this,O);return n.code=e,t&&(this.message=this.message+`: `+t),n}O.prototype=Error.prototype,l(C,O);function k(){}k.prototype={length:0,item:function(e){return e>=0&&e<this.length?this[e]:null},toString:function(e,t){for(var n=[],r=0;r<this.length;r++)Ne(this[r],n,e,t);return n.join(``)},filter:function(e){return Array.prototype.filter.call(this,e)},indexOf:function(e){return Array.prototype.indexOf.call(this,e)}};function A(e,t){this._node=e,this._refresh=t,j(this)}function j(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!==t){var n=e._refresh(e._node);if(Ie(e,`length`,n.length),!e.$$length||n.length<e.$$length)for(var r=n.length;r in e;r++)Object.prototype.hasOwnProperty.call(e,r)&&delete e[r];l(n,e),e._inc=t}}A.prototype.item=function(e){return j(this),this[e]||null},u(A,k);function te(){}function ne(e,t){for(var n=e.length;n--;)if(e[n]===t)return n}function M(e,t,n,r){if(r?t[ne(t,r)]=n:t[t.length++]=n,e){n.ownerElement=e;var i=e.ownerDocument;i&&(r&&F(i,e,r),se(i,e,n))}}function re(e,t,n){var r=ne(t,n);if(r>=0){for(var i=t.length-1;r<i;)t[r]=t[++r];if(t.length=i,e){var a=e.ownerDocument;a&&(F(a,e,n),n.ownerElement=null)}}else throw new O(E,Error(e.tagName+`@`+n))}te.prototype={length:0,item:k.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var n=this[t];if(n.nodeName==e)return n}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new O(D);var n=this.getNamedItem(e.nodeName);return M(this._ownerElement,this,e,n),n},setNamedItemNS:function(e){var t=e.ownerElement,n;if(t&&t!=this._ownerElement)throw new O(D);return n=this.getNamedItemNS(e.namespaceURI,e.localName),M(this._ownerElement,this,e,n),n},removeNamedItem:function(e){var t=this.getNamedItem(e);return re(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var n=this.getNamedItemNS(e,t);return re(this._ownerElement,this,n),n},getNamedItemNS:function(e,t){for(var n=this.length;n--;){var r=this[n];if(r.localName==t&&r.namespaceURI==e)return r}return null}};function ie(){}ie.prototype={hasFeature:function(e,t){return!0},createDocument:function(e,t,n){var r=new oe;if(r.implementation=this,r.childNodes=new k,r.doctype=n||null,n&&r.appendChild(n),t){var i=r.createElementNS(e,t);r.appendChild(i)}return r},createDocumentType:function(e,t,n){var r=new we;return r.name=e,r.nodeName=e,r.publicId=t||``,r.systemId=n||``,r}};function N(){}N.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return ve(this,e,t)},replaceChild:function(e,t){ve(this,e,t,_e),t&&this.removeChild(t)},removeChild:function(e){return le(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(e){return Fe(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==m&&e.nodeType==m?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var t=this;t;){var n=t._nsMap;if(n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)&&n[r]===e)return r}t=t.nodeType==p?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var n=t._nsMap;if(n&&Object.prototype.hasOwnProperty.call(n,e))return n[e];t=t.nodeType==p?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return this.lookupPrefix(e)==null}};function ae(e){return e==`<`&&`&lt;`||e==`>`&&`&gt;`||e==`&`&&`&amp;`||e==`"`&&`&quot;`||`&#`+e.charCodeAt()+`;`}l(d,N),l(d,N.prototype);function P(e,t){if(t(e))return!0;if(e=e.firstChild)do if(P(e,t))return!0;while(e=e.nextSibling)}function oe(){this.ownerDocument=this}function se(e,t,n){e&&e._inc++,n.namespaceURI===r.XMLNS&&(t._nsMap[n.prefix?n.localName:``]=n.value)}function F(e,t,n,i){e&&e._inc++,n.namespaceURI===r.XMLNS&&delete t._nsMap[n.prefix?n.localName:``]}function ce(e,t,n){if(e&&e._inc){e._inc++;var r=t.childNodes;if(n)r[r.length++]=n;else{for(var i=t.firstChild,a=0;i;)r[a++]=i,i=i.nextSibling;r.length=a,delete r[r.length]}}}function le(e,t){var n=t.previousSibling,r=t.nextSibling;return n?n.nextSibling=r:e.firstChild=r,r?r.previousSibling=n:e.lastChild=n,t.parentNode=null,t.previousSibling=null,t.nextSibling=null,ce(e.ownerDocument,e),t}function ue(e){return e&&(e.nodeType===N.DOCUMENT_NODE||e.nodeType===N.DOCUMENT_FRAGMENT_NODE||e.nodeType===N.ELEMENT_NODE)}function de(e){return e&&(L(e)||fe(e)||I(e)||e.nodeType===N.DOCUMENT_FRAGMENT_NODE||e.nodeType===N.COMMENT_NODE||e.nodeType===N.PROCESSING_INSTRUCTION_NODE)}function I(e){return e&&e.nodeType===N.DOCUMENT_TYPE_NODE}function L(e){return e&&e.nodeType===N.ELEMENT_NODE}function fe(e){return e&&e.nodeType===N.TEXT_NODE}function pe(e,t){var r=e.childNodes||[];if(n(r,L)||I(t))return!1;var i=n(r,I);return!(t&&i&&r.indexOf(i)>r.indexOf(t))}function me(e,t){var r=e.childNodes||[];function i(e){return L(e)&&e!==t}if(n(r,i))return!1;var a=n(r,I);return!(t&&a&&r.indexOf(a)>r.indexOf(t))}function he(e,t,n){if(!ue(e))throw new O(T,`Unexpected parent node type `+e.nodeType);if(n&&n.parentNode!==e)throw new O(E,`child not in parent`);if(!de(t)||I(t)&&e.nodeType!==N.DOCUMENT_NODE)throw new O(T,`Unexpected node type `+t.nodeType+` for parent node type `+e.nodeType)}function ge(e,t,r){var i=e.childNodes||[],a=t.childNodes||[];if(t.nodeType===N.DOCUMENT_FRAGMENT_NODE){var o=a.filter(L);if(o.length>1||n(a,fe))throw new O(T,`More than one element or text in fragment`);if(o.length===1&&!pe(e,r))throw new O(T,`Element in fragment can not be inserted before doctype`)}if(L(t)&&!pe(e,r))throw new O(T,`Only one element can be added and only after doctype`);if(I(t)){if(n(i,I))throw new O(T,`Only one doctype is allowed`);var s=n(i,L);if(r&&i.indexOf(s)<i.indexOf(r))throw new O(T,`Doctype can only be inserted before an element`);if(!r&&s)throw new O(T,`Doctype can not be appended since element is present`)}}function _e(e,t,r){var i=e.childNodes||[],a=t.childNodes||[];if(t.nodeType===N.DOCUMENT_FRAGMENT_NODE){var o=a.filter(L);if(o.length>1||n(a,fe))throw new O(T,`More than one element or text in fragment`);if(o.length===1&&!me(e,r))throw new O(T,`Element in fragment can not be inserted before doctype`)}if(L(t)&&!me(e,r))throw new O(T,`Only one element can be added and only after doctype`);if(I(t)){function e(e){return I(e)&&e!==r}if(n(i,e))throw new O(T,`Only one doctype is allowed`);var s=n(i,L);if(r&&i.indexOf(s)<i.indexOf(r))throw new O(T,`Doctype can only be inserted before an element`)}}function ve(e,t,n,r){he(e,t,n),e.nodeType===N.DOCUMENT_NODE&&(r||ge)(e,t,n);var i=t.parentNode;if(i&&i.removeChild(t),t.nodeType===S){var a=t.firstChild;if(a==null)return t;var o=t.lastChild}else a=o=t;var s=n?n.previousSibling:e.lastChild;a.previousSibling=s,o.nextSibling=n,s?s.nextSibling=a:e.firstChild=a,n==null?e.lastChild=o:n.previousSibling=o;do{a.parentNode=e;var c=e.ownerDocument||e;ye(a,c)}while(a!==o&&(a=a.nextSibling));return ce(e.ownerDocument||e,e),t.nodeType==S&&(t.firstChild=t.lastChild=null),t}function ye(e,t){if(e.ownerDocument!==t){if(e.ownerDocument=t,e.nodeType===f&&e.attributes)for(var n=0;n<e.attributes.length;n++){var r=e.attributes.item(n);r&&(r.ownerDocument=t)}for(var i=e.firstChild;i;)ye(i,t),i=i.nextSibling}}function be(e,t){return t.parentNode&&t.parentNode.removeChild(t),t.parentNode=e,t.previousSibling=e.lastChild,t.nextSibling=null,t.previousSibling?t.previousSibling.nextSibling=t:e.firstChild=t,e.lastChild=t,ce(e.ownerDocument,e,t),ye(t,e.ownerDocument||e),t}oe.prototype={nodeName:`#document`,nodeType:b,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==S){for(var n=e.firstChild;n;){var r=n.nextSibling;this.insertBefore(n,t),n=r}return e}return ve(this,e,t),ye(e,this),this.documentElement===null&&e.nodeType===f&&(this.documentElement=e),e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),le(this,e)},replaceChild:function(e,t){ve(this,e,t,_e),ye(e,this),t&&this.removeChild(t),L(e)&&(this.documentElement=e)},importNode:function(e,t){return Pe(this,e,t)},getElementById:function(e){var t=null;return P(this.documentElement,function(n){if(n.nodeType==f&&n.getAttribute(`id`)==e)return t=n,!0}),t},getElementsByClassName:function(e){var t=s(e);return new A(this,function(n){var r=[];return t.length>0&&P(n.documentElement,function(i){if(i!==n&&i.nodeType===f){var a=i.getAttribute(`class`);if(a){var o=e===a;if(!o){var l=s(a);o=t.every(c(l))}o&&r.push(i)}}}),r})},createElement:function(e){var t=new xe;t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.localName=e,t.childNodes=new k;var n=t.attributes=new te;return n._ownerElement=t,t},createDocumentFragment:function(){var e=new Oe;return e.ownerDocument=this,e.childNodes=new k,e},createTextNode:function(e){var t=new B;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new Se;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new Ce;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var n=new V;return n.ownerDocument=this,n.tagName=n.nodeName=n.target=e,n.nodeValue=n.data=t,n},createAttribute:function(e){var t=new R;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new De;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var n=new xe,r=t.split(`:`),i=n.attributes=new te;return n.childNodes=new k,n.ownerDocument=this,n.nodeName=t,n.tagName=t,n.namespaceURI=e,r.length==2?(n.prefix=r[0],n.localName=r[1]):n.localName=t,i._ownerElement=n,n},createAttributeNS:function(e,t){var n=new R,r=t.split(`:`);return n.ownerDocument=this,n.nodeName=t,n.name=t,n.namespaceURI=e,n.specified=!0,r.length==2?(n.prefix=r[0],n.localName=r[1]):n.localName=t,n}},u(oe,N);function xe(){this._nsMap={}}xe.prototype={nodeType:f,hasAttribute:function(e){return this.getAttributeNode(e)!=null},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||``},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var n=this.ownerDocument.createAttribute(e);n.value=n.nodeValue=``+t,this.setAttributeNode(n)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===S?this.insertBefore(e,null):be(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);n&&this.removeAttributeNode(n)},hasAttributeNS:function(e,t){return this.getAttributeNodeNS(e,t)!=null},getAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);return n&&n.value||``},setAttributeNS:function(e,t,n){var r=this.ownerDocument.createAttributeNS(e,t);r.value=r.nodeValue=``+n,this.setAttributeNode(r)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new A(this,function(t){var n=[];return P(t,function(r){r!==t&&r.nodeType==f&&(e===`*`||r.tagName==e)&&n.push(r)}),n})},getElementsByTagNameNS:function(e,t){return new A(this,function(n){var r=[];return P(n,function(i){i!==n&&i.nodeType===f&&(e===`*`||i.namespaceURI===e)&&(t===`*`||i.localName==t)&&r.push(i)}),r})}},oe.prototype.getElementsByTagName=xe.prototype.getElementsByTagName,oe.prototype.getElementsByTagNameNS=xe.prototype.getElementsByTagNameNS,u(xe,N);function R(){}R.prototype.nodeType=p,u(R,N);function z(){}z.prototype={data:``,substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw Error(w[T])},deleteData:function(e,t){this.replaceData(e,t,``)},replaceData:function(e,t,n){var r=this.data.substring(0,e),i=this.data.substring(e+t);n=r+n+i,this.nodeValue=this.data=n,this.length=n.length}},u(z,N);function B(){}B.prototype={nodeName:`#text`,nodeType:m,splitText:function(e){var t=this.data,n=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var r=this.ownerDocument.createTextNode(n);return this.parentNode&&this.parentNode.insertBefore(r,this.nextSibling),r}},u(B,z);function Se(){}Se.prototype={nodeName:`#comment`,nodeType:y},u(Se,z);function Ce(){}Ce.prototype={nodeName:`#cdata-section`,nodeType:h},u(Ce,z);function we(){}we.prototype.nodeType=x,u(we,N);function Te(){}Te.prototype.nodeType=ee,u(Te,N);function Ee(){}Ee.prototype.nodeType=_,u(Ee,N);function De(){}De.prototype.nodeType=g,u(De,N);function Oe(){}Oe.prototype.nodeName=`#document-fragment`,Oe.prototype.nodeType=S,u(Oe,N);function V(){}V.prototype.nodeType=v,u(V,N);function ke(){}ke.prototype.serializeToString=function(e,t,n){return Ae.call(e,t,n)},N.prototype.toString=Ae;function Ae(e,t){var n=[],r=this.nodeType==9&&this.documentElement||this,i=r.prefix,a=r.namespaceURI;if(a&&i==null){var i=r.lookupPrefix(a);if(i==null)var o=[{namespace:a,prefix:null}]}return Ne(this,n,e,t,o),n.join(``)}function je(e,t,n){var i=e.prefix||``,a=e.namespaceURI;if(!a||i===`xml`&&a===r.XML||a===r.XMLNS)return!1;for(var o=n.length;o--;){var s=n[o];if(s.prefix===i)return s.namespace!==a}return!0}function Me(e,t,n){e.push(` `,t,`="`,n.replace(/[<>&"\t\n\r]/g,ae),`"`)}function Ne(e,t,n,i,a){if(a||=[],i)if(e=i(e),e){if(typeof e==`string`){t.push(e);return}}else return;switch(e.nodeType){case f:var o=e.attributes,s=o.length,c=e.firstChild,l=e.tagName;n=r.isHTML(e.namespaceURI)||n;var u=l;if(!n&&!e.prefix&&e.namespaceURI){for(var d,_=0;_<o.length;_++)if(o.item(_).name===`xmlns`){d=o.item(_).value;break}if(!d)for(var ee=a.length-1;ee>=0;ee--){var C=a[ee];if(C.prefix===``&&C.namespace===e.namespaceURI){d=C.namespace;break}}if(d!==e.namespaceURI)for(var ee=a.length-1;ee>=0;ee--){var C=a[ee];if(C.namespace===e.namespaceURI){C.prefix&&(u=C.prefix+`:`+l);break}}}t.push(`<`,u);for(var w=0;w<s;w++){var T=o.item(w);T.prefix==`xmlns`?a.push({prefix:T.localName,namespace:T.value}):T.nodeName==`xmlns`&&a.push({prefix:``,namespace:T.value})}for(var w=0;w<s;w++){var T=o.item(w);if(je(T,n,a)){var E=T.prefix||``,D=T.namespaceURI;Me(t,E?`xmlns:`+E:`xmlns`,D),a.push({prefix:E,namespace:D})}Ne(T,t,n,i,a)}if(l===u&&je(e,n,a)){var E=e.prefix||``,D=e.namespaceURI;Me(t,E?`xmlns:`+E:`xmlns`,D),a.push({prefix:E,namespace:D})}if(c||n&&!/^(?:meta|link|img|br|hr|input)$/i.test(l)){if(t.push(`>`),n&&/^script$/i.test(l))for(;c;)c.data?t.push(c.data):Ne(c,t,n,i,a.slice()),c=c.nextSibling;else for(;c;)Ne(c,t,n,i,a.slice()),c=c.nextSibling;t.push(`</`,u,`>`)}else t.push(`/>`);return;case b:case S:for(var c=e.firstChild;c;)Ne(c,t,n,i,a.slice()),c=c.nextSibling;return;case p:return Me(t,e.name,e.value);case m:return t.push(e.data.replace(/[<&>]/g,ae));case h:return t.push(`<![CDATA[`,e.data,`]]>`);case y:return t.push(`<!--`,e.data,`-->`);case x:var O=e.publicId,k=e.systemId;if(t.push(`<!DOCTYPE `,e.name),O)t.push(` PUBLIC `,O),k&&k!=`.`&&t.push(` `,k),t.push(`>`);else if(k&&k!=`.`)t.push(` SYSTEM `,k,`>`);else{var A=e.internalSubset;A&&t.push(` [`,A,`]`),t.push(`>`)}return;case v:return t.push(`<?`,e.target,` `,e.data,`?>`);case g:return t.push(`&`,e.nodeName,`;`);default:t.push(`??`,e.nodeName)}}function Pe(e,t,n){var r;switch(t.nodeType){case f:r=t.cloneNode(!1),r.ownerDocument=e;case S:break;case p:n=!0;break}if(r||=t.cloneNode(!1),r.ownerDocument=e,r.parentNode=null,n)for(var i=t.firstChild;i;)r.appendChild(Pe(e,i,n)),i=i.nextSibling;return r}function Fe(e,t,n){var r=new t.constructor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var a=t[i];typeof a!=`object`&&a!=r[i]&&(r[i]=a)}switch(t.childNodes&&(r.childNodes=new k),r.ownerDocument=e,r.nodeType){case f:var o=t.attributes,s=r.attributes=new te,c=o.length;s._ownerElement=r;for(var l=0;l<c;l++)r.setAttributeNode(Fe(e,o.item(l),!0));break;case p:n=!0}if(n)for(var u=t.firstChild;u;)r.appendChild(Fe(e,u,n)),u=u.nextSibling;return r}function Ie(e,t,n){e[t]=n}try{if(Object.defineProperty){Object.defineProperty(A.prototype,`length`,{get:function(){return j(this),this.$$length}}),Object.defineProperty(N.prototype,`textContent`,{get:function(){return e(this)},set:function(e){switch(this.nodeType){case f:case S:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}});function e(t){switch(t.nodeType){case f:case S:var n=[];for(t=t.firstChild;t;)t.nodeType!==7&&t.nodeType!==8&&n.push(e(t)),t=t.nextSibling;return n.join(``);default:return t.nodeValue}}Ie=function(e,t,n){e[`$$`+t]=n}}}catch{}e.DocumentType=we,e.DOMException=O,e.DOMImplementation=ie,e.Element=xe,e.Node=N,e.NodeList=k,e.XMLSerializer=ke})),kd=x((e=>{var t=Dd().freeze;e.XML_ENTITIES=t({amp:`&`,apos:`'`,gt:`>`,lt:`<`,quot:`"`}),e.HTML_ENTITIES=t({Aacute:``,aacute:``,Abreve:``,abreve:``,ac:``,acd:``,acE:``,Acirc:``,acirc:``,acute:``,Acy:``,acy:``,AElig:``,aelig:``,af:``,Afr:``,afr:``,Agrave:``,agrave:``,alefsym:``,aleph:``,Alpha:``,alpha:``,Amacr:``,amacr:``,amalg:``,AMP:`&`,amp:`&`,And:``,and:``,andand:``,andd:``,andslope:``,andv:``,ang:``,ange:``,angle:``,angmsd:``,angmsdaa:``,angmsdab:``,angmsdac:``,angmsdad:``,angmsdae:``,angmsdaf:``,angmsdag:``,angmsdah:``,angrt:``,angrtvb:``,angrtvbd:``,angsph:``,angst:``,angzarr:``,Aogon:``,aogon:``,Aopf:``,aopf:``,ap:``,apacir:``,apE:``,ape:``,apid:``,apos:`'`,ApplyFunction:``,approx:``,approxeq:``,Aring:``,aring:``,Ascr:``,ascr:``,Assign:``,ast:`*`,asymp:``,asympeq:``,Atilde:``,atilde:``,Auml:``,auml:``,awconint:``,awint:``,backcong:``,backepsilon:``,backprime:``,backsim:``,backsimeq:``,Backslash:``,Barv:``,barvee:``,Barwed:``,barwed:``,barwedge:``,bbrk:``,bbrktbrk:``,bcong:``,Bcy:``,bcy:``,bdquo:``,becaus:``,Because:``,because:``,bemptyv:``,bepsi:``,bernou:``,Bernoullis:``,Beta:``,beta:``,beth:``,between:``,Bfr:``,bfr:``,bigcap:``,bigcirc:``,bigcup:``,bigodot:``,bigoplus:``,bigotimes:``,bigsqcup:``,bigstar:``,bigtriangledown:``,bigtriangleup:``,biguplus:``,bigvee:``,bigwedge:``,bkarow:``,blacklozenge:``,blacksquare:``,blacktriangle:``,blacktriangledown:``,blacktriangleleft:``,blacktriangleright:``,blank:``,blk12:``,blk14:``,blk34:``,block:``,bne:`=`,bnequiv:``,bNot:``,bnot:``,Bopf:``,bopf:``,bot:``,bottom:``,bowtie:``,boxbox:``,boxDL:``,boxDl:``,boxdL:``,boxdl:``,boxDR:``,boxDr:``,boxdR:``,boxdr:``,boxH:``,boxh:``,boxHD:``,boxHd:``,boxhD:``,boxhd:``,boxHU:``,boxHu:``,boxhU:``,boxhu:``,boxminus:``,boxplus:``,boxtimes:``,boxUL:``,boxUl:``,boxuL:``,boxul:``,boxUR:``,boxUr:``,boxuR:``,boxur:``,boxV:``,boxv:``,boxVH:``,boxVh:``,boxvH:``,boxvh:``,boxVL:``,boxVl:``,boxvL:``,boxvl:``,boxVR:``,boxVr:``,boxvR:``,boxvr:``,bprime:``,Breve:``,breve:``,brvbar:``,Bscr:``,bscr:``,bsemi:``,bsim:``,bsime:``,bsol:`\\`,bsolb:``,bsolhsub:``,bull:``,bullet:``,bump:``,bumpE:``,bumpe:``,Bumpeq:``,bumpeq:``,Cacute:``,cacute:``,Cap:``,cap:``,capand:``,capbrcup:``,capcap:``,capcup:``,capdot:``,CapitalDifferentialD:``,caps:``,caret:``,caron:``,Cayleys:``,ccaps:``,Ccaron:``,ccaron:``,Ccedil:``,ccedil:``,Ccirc:``,ccirc:``,Cconint:``,ccups:``,ccupssm:``,Cdot:``,cdot:``,cedil:``,Cedilla:``,cemptyv:``,cent:``,CenterDot:``,centerdot:``,Cfr:``,cfr:``,CHcy:``,chcy:``,check:``,checkmark:``,Chi:``,chi:``,cir:``,circ:``,circeq:``,circlearrowleft:``,circlearrowright:``,circledast:``,circledcirc:``,circleddash:``,CircleDot:``,circledR:``,circledS:``,CircleMinus:``,CirclePlus:``,CircleTimes:``,cirE:``,cire:``,cirfnint:``,cirmid:``,cirscir:``,ClockwiseContourIntegral:``,CloseCurlyDoubleQuote:``,CloseCurlyQuote:``,clubs:``,clubsuit:``,Colon:``,colon:`:`,Colone:``,colone:``,coloneq:``,comma:`,`,commat:`@`,comp:``,compfn:``,complement:``,complexes:``,cong:``,congdot:``,Congruent:``,Conint:``,conint:``,ContourIntegral:``,Copf:``,copf:``,coprod:``,Coproduct:``,COPY:``,copy:``,copysr:``,CounterClockwiseContourIntegral:``,crarr:``,Cross:``,cross:``,Cscr:``,cscr:``,csub:``,csube:``,csup:``,csupe:``,ctdot:``,cudarrl:``,cudarrr:``,cuepr:``,cuesc:``,cularr:``,cularrp:``,Cup:``,cup:``,cupbrcap:``,CupCap:``,cupcap:``,cupcup:``,cupdot:``,cupor:``,cups:``,curarr:``,curarrm:``,curlyeqprec:``,curlyeqsucc:``,curlyvee:``,curlywedge:``,curren:``,curvearrowleft:``,curvearrowright:``,cuvee:``,cuwed:``,cwconint:``,cwint:``,cylcty:``,Dagger:``,dagger:``,daleth:``,Darr:``,dArr:``,darr:``,dash:``,Dashv:``,dashv:``,dbkarow:``,dblac:``,Dcaron:``,dcaron:``,Dcy:``,dcy:``,DD:``,dd:``,ddagger:``,ddarr:``,DDotrahd:``,ddotseq:``,deg:``,Del:``,Delta:``,delta:``,demptyv:``,dfisht:``,Dfr:``,dfr:``,dHar:``,dharl:``,dharr:``,DiacriticalAcute:``,DiacriticalDot:``,DiacriticalDoubleAcute:``,DiacriticalGrave:"`",DiacriticalTilde:``,diam:``,Diamond:``,diamond:``,diamondsuit:``,diams:``,die:``,DifferentialD:``,digamma:``,disin:``,div:``,divide:``,divideontimes:``,divonx:``,DJcy:``,djcy:``,dlcorn:``,dlcrop:``,dollar:`$`,Dopf:``,dopf:``,Dot:``,dot:``,DotDot:``,doteq:``,doteqdot:``,DotEqual:``,dotminus:``,dotplus:``,dotsquare:``,doublebarwedge:``,DoubleContourIntegral:``,DoubleDot:``,DoubleDownArrow:``,DoubleLeftArrow:``,DoubleLeftRightArrow:``,DoubleLeftTee:``,DoubleLongLeftArrow:``,DoubleLongLeftRightArrow:``,DoubleLongRightArrow:``,DoubleRightArrow:``,DoubleRightTee:``,DoubleUpArrow:``,DoubleUpDownArrow:``,DoubleVerticalBar:``,DownArrow:``,Downarrow:``,downarrow:``,DownArrowBar:``,DownArrowUpArrow:``,DownBreve:``,downdownarrows:``,downharpoonleft:``,downharpoonright:``,DownLeftRightVector:``,DownLeftTeeVector:``,DownLeftVector:``,DownLeftVectorBar:``,DownRightTeeVector:``,DownRightVector:``,DownRightVectorBar:``,DownTee:``,DownTeeArrow:``,drbkarow:``,drcorn:``,drcrop:``,Dscr:``,dscr:``,DScy:``,dscy:``,dsol:``,Dstrok:``,dstrok:``,dtdot:``,dtri:``,dtrif:``,duarr:``,duhar:``,dwangle:``,DZcy:``,dzcy:``,dzigrarr:``,Eacute:``,eacute:``,easter:``,Ecaron:``,ecaron:``,ecir:``,Ecirc:``,ecirc:``,ecolon:``,Ecy:``,ecy:``,eDDot:``,Edot:``,eDot:``,edot:``,ee:``,efDot:``,Efr:``,efr:``,eg:``,Egrave:``,egrave:``,egs:``,egsdot:``,el:``,Element:``,elinters:``,ell:``,els:``,elsdot:``,Emacr:``,emacr:``,empty:``,emptyset:``,EmptySmallSquare:``,emptyv:``,EmptyVerySmallSquare:``,emsp:``,emsp13:``,emsp14:``,ENG:``,eng:``,ensp:``,Eogon:``,eogon:``,Eopf:``,eopf:``,epar:``,eparsl:``,eplus:``,epsi:``,Epsilon:``,epsilon:``,epsiv:``,eqcirc:``,eqcolon:``,eqsim:``,eqslantgtr:``,eqslantless:``,Equal:``,equals:`=`,EqualTilde:``,equest:``,Equilibrium:``,equiv:``,equivDD:``,eqvparsl:``,erarr:``,erDot:``,Escr:``,escr:``,esdot:``,Esim:``,esim:``,Eta:``,eta:``,ETH:``,eth:``,Euml:``,euml:``,euro:``,excl:`!`,exist:``,Exists:``,expectation:``,ExponentialE:``,exponentiale:``,fallingdotseq:``,Fcy:``,fcy:``,female:``,ffilig:``,fflig:``,ffllig:``,Ffr:``,ffr:``,filig:``,FilledSmallSquare:``,FilledVerySmallSquare:``,fjlig:`fj`,flat:``,fllig:``,fltns:``,fnof:``,Fopf:``,fopf:``,ForAll:``,forall:``,fork:``,forkv:``,Fouriertrf:``,fpartint:``,frac12:``,frac13:``,frac14:``,frac15:``,frac16:``,frac18:``,frac23:``,frac25:``,frac34:``,frac35:``,frac38:``,frac45:``,frac56:``,frac58:``,frac78:``,frasl:``,frown:``,Fscr:``,fscr:``,gacute:``,Gamma:``,gamma:``,Gammad:``,gammad:``,gap:``,Gbreve:``,gbreve:``,Gcedil:``,Gcirc:``,gcirc:``,Gcy:``,gcy:``,Gdot:``,gdot:``,gE:``,ge:``,gEl:``,gel:``,geq:``,geqq:``,geqslant:``,ges:``,gescc:``,gesdot:``,gesdoto:``,gesdotol:``,gesl:``,gesles:``,Gfr:``,gfr:``,Gg:``,gg:``,ggg:``,gimel:``,GJcy:``,gjcy:``,gl:``,gla:``,glE:``,glj:``,gnap:``,gnapprox:``,gnE:``,gne:``,gneq:``,gneqq:``,gnsim:``,Gopf:``,gopf:``,grave:"`",GreaterEqual:``,GreaterEqualLess:``,GreaterFullEqual:``,GreaterGreater:``,GreaterLess:``,GreaterSlantEqual:``,GreaterTilde:``,Gscr:``,gscr:``,gsim:``,gsime:``,gsiml:``,Gt:``,GT:`>`,gt:`>`,gtcc:``,gtcir:``,gtdot:``,gtlPar:``,gtquest:``,gtrapprox:``,gtrarr:``,gtrdot:``,gtreqless:``,gtreqqless:``,gtrless:``,gtrsim:``,gvertneqq:``,gvnE:``,Hacek:``,hairsp:``,half:``,hamilt:``,HARDcy:``,hardcy:``,hArr:``,harr:``,harrcir:``,harrw:``,Hat:`^`,hbar:``,Hcirc:``,hcirc:``,hearts:``,heartsuit:``,hellip:``,hercon:``,Hfr:``,hfr:``,HilbertSpace:``,hksearow:``,hkswarow:``,hoarr:``,homtht:``,hookleftarrow:``,hookrightarrow:``,Hopf:``,hopf:``,horbar:``,HorizontalLine:``,Hscr:``,hscr:``,hslash:``,Hstrok:``,hstrok:``,HumpDownHump:``,HumpEqual:``,hybull:``,hyphen:``,Iacute:``,iacute:``,ic:``,Icirc:``,icirc:``,Icy:``,icy:``,Idot:``,IEcy:``,iecy:``,iexcl:``,iff:``,Ifr:``,ifr:``,Igrave:``,igrave:``,ii:``,iiiint:``,iiint:``,iinfin:``,iiota:``,IJlig:``,ijlig:``,Im:``,Imacr:``,imacr:``,image:``,ImaginaryI:``,imagline:``,imagpart:``,imath:``,imof:``,imped:``,Implies:``,in:``,incare:``,infin:``,infintie:``,inodot:``,Int:``,int:``,intcal:``,integers:``,Integral:``,intercal:``,Intersection:``,intlarhk:``,intprod:``,InvisibleComma:``,InvisibleTimes:``,IOcy:``,iocy:``,Iogon:``,iogon:``,Iopf:``,iopf:``,Iota:``,iota:``,iprod:``,iquest:``,Iscr:``,iscr:``,isin:``,isindot:``,isinE:``,isins:``,isinsv:``,isinv:``,it:``,Itilde:``,itilde:``,Iukcy:``,iukcy:``,Iuml:``,iuml:``,Jcirc:``,jcirc:``,Jcy:``,jcy:``,Jfr:``,jfr:``,jmath:``,Jopf:``,jopf:``,Jscr:``,jscr:``,Jsercy:``,jsercy:``,Jukcy:``,jukcy:``,Kappa:``,kappa:``,kappav:``,Kcedil:``,kcedil:``,Kcy:``,kcy:``,Kfr:``,kfr:``,kgreen:``,KHcy:``,khcy:``,KJcy:``,kjcy:``,Kopf:``,kopf:``,Kscr:``,kscr:``,lAarr:``,Lacute:``,lacute:``,laemptyv:``,lagran:``,Lambda:``,lambda:``,Lang:``,lang:``,langd:``,langle:``,lap:``,Laplacetrf:``,laquo:``,Larr:``,lArr:``,larr:``,larrb:``,larrbfs:``,larrfs:``,larrhk:``,larrlp:``,larrpl:``,larrsim:``,larrtl:``,lat:``,lAtail:``,latail:``,late:``,lates:``,lBarr:``,lbarr:``,lbbrk:``,lbrace:`{`,lbrack:`[`,lbrke:``,lbrksld:``,lbrkslu:``,Lcaron:``,lcaron:``,Lcedil:``,lcedil:``,lceil:``,lcub:`{`,Lcy:``,lcy:``,ldca:``,ldquo:``,ldquor:``,ldrdhar:``,ldrushar:``,ldsh:``,lE:``,le:``,LeftAngleBracket:``,LeftArrow:``,Leftarrow:``,leftarrow:``,LeftArrowBar:``,LeftArrowRightArrow:``,leftarrowtail:``,LeftCeiling:``,LeftDoubleBracket:``,LeftDownTeeVector:``,LeftDownVector:``,LeftDownVectorBar:``,LeftFloor:``,leftharpoondown:``,leftharpoonup:``,leftleftarrows:``,LeftRightArrow:``,Leftrightarrow:``,leftrightarrow:``,leftrightarrows:``,leftrightharpoons:``,leftrightsquigarrow:``,LeftRightVector:``,LeftTee:``,LeftTeeArrow:``,LeftTeeVector:``,leftthreetimes:``,LeftTriangle:``,LeftTriangleBar:``,LeftTriangleEqual:``,LeftUpDownVector:``,LeftUpTeeVector:``,LeftUpVector:``,LeftUpVectorBar:``,LeftVector:``,LeftVectorBar:``,lEg:``,leg:``,leq:``,leqq:``,leqslant:``,les:``,lescc:``,lesdot:``,lesdoto:``,lesdotor:``,lesg:``,lesges:``,lessapprox:``,lessdot:``,lesseqgtr:``,lesseqqgtr:``,LessEqualGreater:``,LessFullEqual:``,LessGreater:``,lessgtr:``,LessLess:``,lesssim:``,LessSlantEqual:``,LessTilde:``,lfisht:``,lfloor:``,Lfr:``,lfr:``,lg:``,lgE:``,lHar:``,lhard:``,lharu:``,lharul:``,lhblk:``,LJcy:``,ljcy:``,Ll:``,ll:``,llarr:``,llcorner:``,Lleftarrow:``,llhard:``,lltri:``,Lmidot:``,lmidot:``,lmoust:``,lmoustache:``,lnap:``,lnapprox:``,lnE:``,lne:``,lneq:``,lneqq:``,lnsim:``,loang:``,loarr:``,lobrk:``,LongLeftArrow:``,Longleftarrow:``,longleftarrow:``,LongLeftRightArrow:``,Longleftrightarrow:``,longleftrightarrow:``,longmapsto:``,LongRightArrow:``,Longrightarrow:``,longrightarrow:``,looparrowleft:``,looparrowright:``,lopar:``,Lopf:``,lopf:``,loplus:``,lotimes:``,lowast:``,lowbar:`_`,LowerLeftArrow:``,LowerRightArrow:``,loz:``,lozenge:``,lozf:``,lpar:`(`,lparlt:``,lrarr:``,lrcorner:``,lrhar:``,lrhard:``,lrm:``,lrtri:``,lsaquo:``,Lscr:``,lscr:``,Lsh:``,lsh:``,lsim:``,lsime:``,lsimg:``,lsqb:`[`,lsquo:``,lsquor:``,Lstrok:``,lstrok:``,Lt:``,LT:`<`,lt:`<`,ltcc:``,ltcir:``,ltdot:``,lthree:``,ltimes:``,ltlarr:``,ltquest:``,ltri:``,ltrie:``,ltrif:``,ltrPar:``,lurdshar:``,luruhar:``,lvertneqq:``,lvnE:``,macr:``,male:``,malt:``,maltese:``,Map:``,map:``,mapsto:``,mapstodown:``,mapstoleft:``,mapstoup:``,marker:``,mcomma:``,Mcy:``,mcy:``,mdash:``,mDDot:``,measuredangle:``,MediumSpace:``,Mellintrf:``,Mfr:``,mfr:``,mho:``,micro:``,mid:``,midast:`*`,midcir:``,middot:``,minus:``,minusb:``,minusd:``,minusdu:``,MinusPlus:``,mlcp:``,mldr:``,mnplus:``,models:``,Mopf:``,mopf:``,mp:``,Mscr:``,mscr:``,mstpos:``,Mu:``,mu:``,multimap:``,mumap:``,nabla:``,Nacute:``,nacute:``,nang:``,nap:``,napE:``,napid:``,napos:``,napprox:``,natur:``,natural:``,naturals:``,nbsp:`\xA0`,nbump:``,nbumpe:``,ncap:``,Ncaron:``,ncaron:``,Ncedil:``,ncedil:``,ncong:``,ncongdot:``,ncup:``,Ncy:``,ncy:``,ndash:``,ne:``,nearhk:``,neArr:``,nearr:``,nearrow:``,nedot:``,NegativeMediumSpace:``,NegativeThickSpace:``,NegativeThinSpace:``,NegativeVeryThinSpace:``,nequiv:``,nesear:``,nesim:``,NestedGreaterGreater:``,NestedLessLess:``,NewLine:`
`,nexist:``,nexists:``,Nfr:``,nfr:``,ngE:``,nge:``,ngeq:``,ngeqq:``,ngeqslant:``,nges:``,nGg:``,ngsim:``,nGt:``,ngt:``,ngtr:``,nGtv:``,nhArr:``,nharr:``,nhpar:``,ni:``,nis:``,nisd:``,niv:``,NJcy:``,njcy:``,nlArr:``,nlarr:``,nldr:``,nlE:``,nle:``,nLeftarrow:``,nleftarrow:``,nLeftrightarrow:``,nleftrightarrow:``,nleq:``,nleqq:``,nleqslant:``,nles:``,nless:``,nLl:``,nlsim:``,nLt:``,nlt:``,nltri:``,nltrie:``,nLtv:``,nmid:``,NoBreak:``,NonBreakingSpace:`\xA0`,Nopf:``,nopf:``,Not:``,not:``,NotCongruent:``,NotCupCap:``,NotDoubleVerticalBar:``,NotElement:``,NotEqual:``,NotEqualTilde:``,NotExists:``,NotGreater:``,NotGreaterEqual:``,NotGreaterFullEqual:``,NotGreaterGreater:``,NotGreaterLess:``,NotGreaterSlantEqual:``,NotGreaterTilde:``,NotHumpDownHump:``,NotHumpEqual:``,notin:``,notindot:``,notinE:``,notinva:``,notinvb:``,notinvc:``,NotLeftTriangle:``,NotLeftTriangleBar:``,NotLeftTriangleEqual:``,NotLess:``,NotLessEqual:``,NotLessGreater:``,NotLessLess:``,NotLessSlantEqual:``,NotLessTilde:``,NotNestedGreaterGreater:``,NotNestedLessLess:``,notni:``,notniva:``,notnivb:``,notnivc:``,NotPrecedes:``,NotPrecedesEqual:``,NotPrecedesSlantEqual:``,NotReverseElement:``,NotRightTriangle:``,NotRightTriangleBar:``,NotRightTriangleEqual:``,NotSquareSubset:``,NotSquareSubsetEqual:``,NotSquareSuperset:``,NotSquareSupersetEqual:``,NotSubset:``,NotSubsetEqual:``,NotSucceeds:``,NotSucceedsEqual:``,NotSucceedsSlantEqual:``,NotSucceedsTilde:``,NotSuperset:``,NotSupersetEqual:``,NotTilde:``,NotTildeEqual:``,NotTildeFullEqual:``,NotTildeTilde:``,NotVerticalBar:``,npar:``,nparallel:``,nparsl:``,npart:``,npolint:``,npr:``,nprcue:``,npre:``,nprec:``,npreceq:``,nrArr:``,nrarr:``,nrarrc:``,nrarrw:``,nRightarrow:``,nrightarrow:``,nrtri:``,nrtrie:``,nsc:``,nsccue:``,nsce:``,Nscr:``,nscr:``,nshortmid:``,nshortparallel:``,nsim:``,nsime:``,nsimeq:``,nsmid:``,nspar:``,nsqsube:``,nsqsupe:``,nsub:``,nsubE:``,nsube:``,nsubset:``,nsubseteq:``,nsubseteqq:``,nsucc:``,nsucceq:``,nsup:``,nsupE:``,nsupe:``,nsupset:``,nsupseteq:``,nsupseteqq:``,ntgl:``,Ntilde:``,ntilde:``,ntlg:``,ntriangleleft:``,ntrianglelefteq:``,ntriangleright:``,ntrianglerighteq:``,Nu:``,nu:``,num:`#`,numero:``,numsp:``,nvap:``,nVDash:``,nVdash:``,nvDash:``,nvdash:``,nvge:``,nvgt:`>`,nvHarr:``,nvinfin:``,nvlArr:``,nvle:``,nvlt:`<`,nvltrie:``,nvrArr:``,nvrtrie:``,nvsim:``,nwarhk:``,nwArr:``,nwarr:``,nwarrow:``,nwnear:``,Oacute:``,oacute:``,oast:``,ocir:``,Ocirc:``,ocirc:``,Ocy:``,ocy:``,odash:``,Odblac:``,odblac:``,odiv:``,odot:``,odsold:``,OElig:``,oelig:``,ofcir:``,Ofr:``,ofr:``,ogon:``,Ograve:``,ograve:``,ogt:``,ohbar:``,ohm:``,oint:``,olarr:``,olcir:``,olcross:``,oline:``,olt:``,Omacr:``,omacr:``,Omega:``,omega:``,Omicron:``,omicron:``,omid:``,ominus:``,Oopf:``,oopf:``,opar:``,OpenCurlyDoubleQuote:``,OpenCurlyQuote:``,operp:``,oplus:``,Or:``,or:``,orarr:``,ord:``,order:``,orderof:``,ordf:``,ordm:``,origof:``,oror:``,orslope:``,orv:``,oS:``,Oscr:``,oscr:``,Oslash:``,oslash:``,osol:``,Otilde:``,otilde:``,Otimes:``,otimes:``,otimesas:``,Ouml:``,ouml:``,ovbar:``,OverBar:``,OverBrace:``,OverBracket:``,OverParenthesis:``,par:``,para:``,parallel:``,parsim:``,parsl:``,part:``,PartialD:``,Pcy:``,pcy:``,percnt:`%`,period:`.`,permil:``,perp:``,pertenk:``,Pfr:``,pfr:``,Phi:``,phi:``,phiv:``,phmmat:``,phone:``,Pi:``,pi:``,pitchfork:``,piv:``,planck:``,planckh:``,plankv:``,plus:`+`,plusacir:``,plusb:``,pluscir:``,plusdo:``,plusdu:``,pluse:``,PlusMinus:``,plusmn:``,plussim:``,plustwo:``,pm:``,Poincareplane:``,pointint:``,Popf:``,popf:``,pound:``,Pr:``,pr:``,prap:``,prcue:``,prE:``,pre:``,prec:``,precapprox:``,preccurlyeq:``,Precedes:``,PrecedesEqual:``,PrecedesSlantEqual:``,PrecedesTilde:``,preceq:``,precnapprox:``,precneqq:``,precnsim:``,precsim:``,Prime:``,prime:``,primes:``,prnap:``,prnE:``,prnsim:``,prod:``,Product:``,profalar:``,profline:``,profsurf:``,prop:``,Proportion:``,Proportional:``,propto:``,prsim:``,prurel:``,Pscr:``,pscr:``,Psi:``,psi:``,puncsp:``,Qfr:``,qfr:``,qint:``,Qopf:``,qopf:``,qprime:``,Qscr:``,qscr:``,quaternions:``,quatint:``,quest:`?`,questeq:``,QUOT:`"`,quot:`"`,rAarr:``,race:``,Racute:``,racute:``,radic:``,raemptyv:``,Rang:``,rang:``,rangd:``,range:``,rangle:``,raquo:``,Rarr:``,rArr:``,rarr:``,rarrap:``,rarrb:``,rarrbfs:``,rarrc:``,rarrfs:``,rarrhk:``,rarrlp:``,rarrpl:``,rarrsim:``,Rarrtl:``,rarrtl:``,rarrw:``,rAtail:``,ratail:``,ratio:``,rationals:``,RBarr:``,rBarr:``,rbarr:``,rbbrk:``,rbrace:`}`,rbrack:`]`,rbrke:``,rbrksld:``,rbrkslu:``,Rcaron:``,rcaron:``,Rcedil:``,rcedil:``,rceil:``,rcub:`}`,Rcy:``,rcy:``,rdca:``,rdldhar:``,rdquo:``,rdquor:``,rdsh:``,Re:``,real:``,realine:``,realpart:``,reals:``,rect:``,REG:``,reg:``,ReverseElement:``,ReverseEquilibrium:``,ReverseUpEquilibrium:``,rfisht:``,rfloor:``,Rfr:``,rfr:``,rHar:``,rhard:``,rharu:``,rharul:``,Rho:``,rho:``,rhov:``,RightAngleBracket:``,RightArrow:``,Rightarrow:``,rightarrow:``,RightArrowBar:``,RightArrowLeftArrow:``,rightarrowtail:``,RightCeiling:``,RightDoubleBracket:``,RightDownTeeVector:``,RightDownVector:``,RightDownVectorBar:``,RightFloor:``,rightharpoondown:``,rightharpoonup:``,rightleftarrows:``,rightleftharpoons:``,rightrightarrows:``,rightsquigarrow:``,RightTee:``,RightTeeArrow:``,RightTeeVector:``,rightthreetimes:``,RightTriangle:``,RightTriangleBar:``,RightTriangleEqual:``,RightUpDownVector:``,RightUpTeeVector:``,RightUpVector:``,RightUpVectorBar:``,RightVector:``,RightVectorBar:``,ring:``,risingdotseq:``,rlarr:``,rlhar:``,rlm:``,rmoust:``,rmoustache:``,rnmid:``,roang:``,roarr:``,robrk:``,ropar:``,Ropf:``,ropf:``,roplus:``,rotimes:``,RoundImplies:``,rpar:`)`,rpargt:``,rppolint:``,rrarr:``,Rrightarrow:``,rsaquo:``,Rscr:``,rscr:``,Rsh:``,rsh:``,rsqb:`]`,rsquo:``,rsquor:``,rthree:``,rtimes:``,rtri:``,rtrie:``,rtrif:``,rtriltri:``,RuleDelayed:``,ruluhar:``,rx:``,Sacute:``,sacute:``,sbquo:``,Sc:``,sc:``,scap:``,Scaron:``,scaron:``,sccue:``,scE:``,sce:``,Scedil:``,scedil:``,Scirc:``,scirc:``,scnap:``,scnE:``,scnsim:``,scpolint:``,scsim:``,Scy:``,scy:``,sdot:``,sdotb:``,sdote:``,searhk:``,seArr:``,searr:``,searrow:``,sect:``,semi:`;`,seswar:``,setminus:``,setmn:``,sext:``,Sfr:``,sfr:``,sfrown:``,sharp:``,SHCHcy:``,shchcy:``,SHcy:``,shcy:``,ShortDownArrow:``,ShortLeftArrow:``,shortmid:``,shortparallel:``,ShortRightArrow:``,ShortUpArrow:``,shy:``,Sigma:``,sigma:``,sigmaf:``,sigmav:``,sim:``,simdot:``,sime:``,simeq:``,simg:``,simgE:``,siml:``,simlE:``,simne:``,simplus:``,simrarr:``,slarr:``,SmallCircle:``,smallsetminus:``,smashp:``,smeparsl:``,smid:``,smile:``,smt:``,smte:``,smtes:``,SOFTcy:``,softcy:``,sol:`/`,solb:``,solbar:``,Sopf:``,sopf:``,spades:``,spadesuit:``,spar:``,sqcap:``,sqcaps:``,sqcup:``,sqcups:``,Sqrt:``,sqsub:``,sqsube:``,sqsubset:``,sqsubseteq:``,sqsup:``,sqsupe:``,sqsupset:``,sqsupseteq:``,squ:``,Square:``,square:``,SquareIntersection:``,SquareSubset:``,SquareSubsetEqual:``,SquareSuperset:``,SquareSupersetEqual:``,SquareUnion:``,squarf:``,squf:``,srarr:``,Sscr:``,sscr:``,ssetmn:``,ssmile:``,sstarf:``,Star:``,star:``,starf:``,straightepsilon:``,straightphi:``,strns:``,Sub:``,sub:``,subdot:``,subE:``,sube:``,subedot:``,submult:``,subnE:``,subne:``,subplus:``,subrarr:``,Subset:``,subset:``,subseteq:``,subseteqq:``,SubsetEqual:``,subsetneq:``,subsetneqq:``,subsim:``,subsub:``,subsup:``,succ:``,succapprox:``,succcurlyeq:``,Succeeds:``,SucceedsEqual:``,SucceedsSlantEqual:``,SucceedsTilde:``,succeq:``,succnapprox:``,succneqq:``,succnsim:``,succsim:``,SuchThat:``,Sum:``,sum:``,sung:``,Sup:``,sup:``,sup1:``,sup2:``,sup3:``,supdot:``,supdsub:``,supE:``,supe:``,supedot:``,Superset:``,SupersetEqual:``,suphsol:``,suphsub:``,suplarr:``,supmult:``,supnE:``,supne:``,supplus:``,Supset:``,supset:``,supseteq:``,supseteqq:``,supsetneq:``,supsetneqq:``,supsim:``,supsub:``,supsup:``,swarhk:``,swArr:``,swarr:``,swarrow:``,swnwar:``,szlig:``,Tab:`	`,target:``,Tau:``,tau:``,tbrk:``,Tcaron:``,tcaron:``,Tcedil:``,tcedil:``,Tcy:``,tcy:``,tdot:``,telrec:``,Tfr:``,tfr:``,there4:``,Therefore:``,therefore:``,Theta:``,theta:``,thetasym:``,thetav:``,thickapprox:``,thicksim:``,ThickSpace:``,thinsp:``,ThinSpace:``,thkap:``,thksim:``,THORN:``,thorn:``,Tilde:``,tilde:``,TildeEqual:``,TildeFullEqual:``,TildeTilde:``,times:``,timesb:``,timesbar:``,timesd:``,tint:``,toea:``,top:``,topbot:``,topcir:``,Topf:``,topf:``,topfork:``,tosa:``,tprime:``,TRADE:``,trade:``,triangle:``,triangledown:``,triangleleft:``,trianglelefteq:``,triangleq:``,triangleright:``,trianglerighteq:``,tridot:``,trie:``,triminus:``,TripleDot:``,triplus:``,trisb:``,tritime:``,trpezium:``,Tscr:``,tscr:``,TScy:``,tscy:``,TSHcy:``,tshcy:``,Tstrok:``,tstrok:``,twixt:``,twoheadleftarrow:``,twoheadrightarrow:``,Uacute:``,uacute:``,Uarr:``,uArr:``,uarr:``,Uarrocir:``,Ubrcy:``,ubrcy:``,Ubreve:``,ubreve:``,Ucirc:``,ucirc:``,Ucy:``,ucy:``,udarr:``,Udblac:``,udblac:``,udhar:``,ufisht:``,Ufr:``,ufr:``,Ugrave:``,ugrave:``,uHar:``,uharl:``,uharr:``,uhblk:``,ulcorn:``,ulcorner:``,ulcrop:``,ultri:``,Umacr:``,umacr:``,uml:``,UnderBar:`_`,UnderBrace:``,UnderBracket:``,UnderParenthesis:``,Union:``,UnionPlus:``,Uogon:``,uogon:``,Uopf:``,uopf:``,UpArrow:``,Uparrow:``,uparrow:``,UpArrowBar:``,UpArrowDownArrow:``,UpDownArrow:``,Updownarrow:``,updownarrow:``,UpEquilibrium:``,upharpoonleft:``,upharpoonright:``,uplus:``,UpperLeftArrow:``,UpperRightArrow:``,Upsi:``,upsi:``,upsih:``,Upsilon:``,upsilon:``,UpTee:``,UpTeeArrow:``,upuparrows:``,urcorn:``,urcorner:``,urcrop:``,Uring:``,uring:``,urtri:``,Uscr:``,uscr:``,utdot:``,Utilde:``,utilde:``,utri:``,utrif:``,uuarr:``,Uuml:``,uuml:``,uwangle:``,vangrt:``,varepsilon:``,varkappa:``,varnothing:``,varphi:``,varpi:``,varpropto:``,vArr:``,varr:``,varrho:``,varsigma:``,varsubsetneq:``,varsubsetneqq:``,varsupsetneq:``,varsupsetneqq:``,vartheta:``,vartriangleleft:``,vartriangleright:``,Vbar:``,vBar:``,vBarv:``,Vcy:``,vcy:``,VDash:``,Vdash:``,vDash:``,vdash:``,Vdashl:``,Vee:``,vee:``,veebar:``,veeeq:``,vellip:``,Verbar:``,verbar:`|`,Vert:``,vert:`|`,VerticalBar:``,VerticalLine:`|`,VerticalSeparator:``,VerticalTilde:``,VeryThinSpace:``,Vfr:``,vfr:``,vltri:``,vnsub:``,vnsup:``,Vopf:``,vopf:``,vprop:``,vrtri:``,Vscr:``,vscr:``,vsubnE:``,vsubne:``,vsupnE:``,vsupne:``,Vvdash:``,vzigzag:``,Wcirc:``,wcirc:``,wedbar:``,Wedge:``,wedge:``,wedgeq:``,weierp:``,Wfr:``,wfr:``,Wopf:``,wopf:``,wp:``,wr:``,wreath:``,Wscr:``,wscr:``,xcap:``,xcirc:``,xcup:``,xdtri:``,Xfr:``,xfr:``,xhArr:``,xharr:``,Xi:``,xi:``,xlArr:``,xlarr:``,xmap:``,xnis:``,xodot:``,Xopf:``,xopf:``,xoplus:``,xotime:``,xrArr:``,xrarr:``,Xscr:``,xscr:``,xsqcup:``,xuplus:``,xutri:``,xvee:``,xwedge:``,Yacute:``,yacute:``,YAcy:``,yacy:``,Ycirc:``,ycirc:``,Ycy:``,ycy:``,yen:``,Yfr:``,yfr:``,YIcy:``,yicy:``,Yopf:``,yopf:``,Yscr:``,yscr:``,YUcy:``,yucy:``,Yuml:``,yuml:``,Zacute:``,zacute:``,Zcaron:``,zcaron:``,Zcy:``,zcy:``,Zdot:``,zdot:``,zeetrf:``,ZeroWidthSpace:``,Zeta:``,zeta:``,Zfr:``,zfr:``,ZHcy:``,zhcy:``,zigrarr:``,Zopf:``,zopf:``,Zscr:``,zscr:``,zwj:``,zwnj:``}),e.entityMap=e.HTML_ENTITIES})),Ad=x((e=>{var t=Dd().NAMESPACE,n=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,r=RegExp(`[\\-\\.0-9`+n.source.slice(1,-1)+`\\u00B7\\u0300-\\u036F\\u203F-\\u2040]`),i=RegExp(`^`+n.source+r.source+`*(?::`+n.source+r.source+`*)?$`),a=0,o=1,s=2,c=3,l=4,u=5,d=6,f=7;function p(e,t){this.message=e,this.locator=t,Error.captureStackTrace&&Error.captureStackTrace(this,p)}p.prototype=Error(),p.prototype.name=p.name;function m(){}m.prototype={parse:function(e,t,n){var r=this.domBuilder;r.startDocument(),x(t,t={}),h(e,t,n,r,this.errorHandler),r.endDocument()}};function h(e,n,r,i,a){function o(e){if(e>65535){e-=65536;var t=55296+(e>>10),n=56320+(e&1023);return String.fromCharCode(t,n)}else return String.fromCharCode(e)}function s(e){var t=e.slice(1,-1);return Object.hasOwnProperty.call(r,t)?r[t]:t.charAt(0)===`#`?o(parseInt(t.substr(1).replace(`x`,`0x`))):(a.error(`entity not found:`+e),e)}function c(t){if(t>w){var n=e.substring(w,t).replace(/&#?\w+;/g,s);m&&l(w),i.characters(n,0,t-w),w=t}}function l(t,n){for(;t>=d&&(n=f.exec(e));)u=n.index,d=u+n[0].length,m.lineNumber++;m.columnNumber=t-u+1}for(var u=0,d=0,f=/.*(?:\r\n?|\n)|.*$/g,m=i.locator,h=[{currentNSMap:n}],x={},w=0;;){try{var T=e.indexOf(`<`,w);if(T<0){if(!e.substr(w).match(/^\s*$/)){var E=i.doc,D=E.createTextNode(e.substr(w));E.appendChild(D),i.currentElement=D}return}switch(T>w&&c(T),e.charAt(T+1)){case`/`:var O=e.indexOf(`>`,T+3),k=e.substring(T+2,O).replace(/[ \t\n\r]+$/g,``),A=h.pop();O<0?(k=e.substring(T+2).replace(/[\s<].*/,``),a.error(`end tag name: `+k+` is not complete:`+A.tagName),O=T+1+k.length):k.match(/\s</)&&(k=k.replace(/[\s<].*/,``),a.error(`end tag name: `+k+` maybe not complete`),O=T+1+k.length);var j=A.localNSMap,te=A.tagName==k;if(te||A.tagName&&A.tagName.toLowerCase()==k.toLowerCase()){if(i.endElement(A.uri,A.localName,k),j)for(var ne in j)Object.prototype.hasOwnProperty.call(j,ne)&&i.endPrefixMapping(ne);te||a.fatalError(`end tag name: `+k+` is not match the current start tagName:`+A.tagName)}else h.push(A);O++;break;case`?`:m&&l(T),O=ee(e,T,i);break;case`!`:m&&l(T),O=S(e,T,i,a);break;default:m&&l(T);var M=new C,re=h[h.length-1].currentNSMap,O=_(e,T,M,re,s,a),ie=M.length;if(!M.closed&&b(e,O,M.tagName,x)&&(M.closed=!0,r.nbsp||a.warning(`unclosed xml attribute`)),m&&ie){for(var N=g(m,{}),ae=0;ae<ie;ae++){var P=M[ae];l(P.offset),P.locator=g(m,{})}i.locator=N,v(M,i,re)&&h.push(M),i.locator=m}else v(M,i,re)&&h.push(M);t.isHTML(M.uri)&&!M.closed?O=y(e,O,M.tagName,s,i):O++}}catch(e){if(e instanceof p)throw e;a.error(`element parse error: `+e),O=-1}O>w?w=O:c(Math.max(T,w)+1)}}function g(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function _(e,n,r,i,p,m){function h(e,t,n){r.attributeNames.hasOwnProperty(e)&&m.fatalError(`Attribute `+e+` redefined`),r.addValue(e,t.replace(/[\t\n\r]/g,` `).replace(/&#?\w+;/g,p),n)}for(var g,_,v=++n,y=a;;){var b=e.charAt(v);switch(b){case`=`:if(y===o)g=e.slice(n,v),y=c;else if(y===s)y=c;else throw Error(`attribute equal must after attrName`);break;case`'`:case`"`:if(y===c||y===o)if(y===o&&(m.warning(`attribute value must after "="`),g=e.slice(n,v)),n=v+1,v=e.indexOf(b,n),v>0)_=e.slice(n,v),h(g,_,n-1),y=u;else throw Error(`attribute value no end '`+b+`' match`);else if(y==l)_=e.slice(n,v),h(g,_,n),m.warning(`attribute "`+g+`" missed start quot(`+b+`)!!`),n=v+1,y=u;else throw Error(`attribute value must after "="`);break;case`/`:switch(y){case a:r.setTagName(e.slice(n,v));case u:case d:case f:y=f,r.closed=!0;case l:case o:break;case s:r.closed=!0;break;default:throw Error(`attribute invalid close char('/')`)}break;case``:return m.error(`unexpected end of input`),y==a&&r.setTagName(e.slice(n,v)),v;case`>`:switch(y){case a:r.setTagName(e.slice(n,v));case u:case d:case f:break;case l:case o:_=e.slice(n,v),_.slice(-1)===`/`&&(r.closed=!0,_=_.slice(0,-1));case s:y===s&&(_=g),y==l?(m.warning(`attribute "`+_+`" missed quot(")!`),h(g,_,n)):((!t.isHTML(i[``])||!_.match(/^(?:disabled|checked|selected)$/i))&&m.warning(`attribute "`+_+`" missed value!! "`+_+`" instead!!`),h(_,_,n));break;case c:throw Error(`attribute value missed!!`)}return v;case``:b=` `;default:if(b<=` `)switch(y){case a:r.setTagName(e.slice(n,v)),y=d;break;case o:g=e.slice(n,v),y=s;break;case l:var _=e.slice(n,v);m.warning(`attribute "`+_+`" missed quot(")!!`),h(g,_,n);case u:y=d;break}else switch(y){case s:r.tagName,(!t.isHTML(i[``])||!g.match(/^(?:disabled|checked|selected)$/i))&&m.warning(`attribute "`+g+`" missed value!! "`+g+`" instead2!!`),h(g,g,n),n=v,y=o;break;case u:m.warning(`attribute space is required"`+g+`"!!`);case d:y=o,n=v;break;case c:y=l,n=v;break;case f:throw Error(`elements closed character '/' and '>' must be connected to`)}}v++}}function v(e,n,r){for(var i=e.tagName,a=null,o=e.length;o--;){var s=e[o],c=s.qName,l=s.value,u=c.indexOf(`:`);if(u>0)var d=s.prefix=c.slice(0,u),f=c.slice(u+1),p=d===`xmlns`&&f;else f=c,d=null,p=c===`xmlns`&&``;s.localName=f,p!==!1&&(a??(a={},x(r,r={})),r[p]=a[p]=l,s.uri=t.XMLNS,n.startPrefixMapping(p,l))}for(var o=e.length;o--;){s=e[o];var d=s.prefix;d&&(d===`xml`&&(s.uri=t.XML),d!==`xmlns`&&(s.uri=r[d||``]))}var u=i.indexOf(`:`);u>0?(d=e.prefix=i.slice(0,u),f=e.localName=i.slice(u+1)):(d=null,f=e.localName=i);var m=e.uri=r[d||``];if(n.startElement(m,f,i,e),e.closed){if(n.endElement(m,f,i),a)for(d in a)Object.prototype.hasOwnProperty.call(a,d)&&n.endPrefixMapping(d)}else return e.currentNSMap=r,e.localNSMap=a,!0}function y(e,t,n,r,i){if(/^(?:script|textarea)$/i.test(n)){var a=e.indexOf(`</`+n+`>`,t),o=e.substring(t+1,a);if(/[&<]/.test(o))return/^script$/i.test(n)?(i.characters(o,0,o.length),a):(o=o.replace(/&#?\w+;/g,r),i.characters(o,0,o.length),a)}return t+1}function b(e,t,n,r){var i=r[n];return i??(i=e.lastIndexOf(`</`+n+`>`),i<t&&(i=e.lastIndexOf(`</`+n)),r[n]=i),i<t}function x(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}function S(e,t,n,r){switch(e.charAt(t+2)){case`-`:if(e.charAt(t+3)===`-`){var i=e.indexOf(`-->`,t+4);return i>t?(n.comment(e,t+4,i-t-4),i+3):(r.error(`Unclosed comment`),-1)}else return-1;default:if(e.substr(t+3,6)==`CDATA[`){var i=e.indexOf(`]]>`,t+9);return n.startCDATA(),n.characters(e,t+9,i-t-9),n.endCDATA(),i+3}var a=w(e,t),o=a.length;if(o>1&&/!doctype/i.test(a[0][0])){var s=a[1][0],c=!1,l=!1;o>3&&(/^public$/i.test(a[2][0])?(c=a[3][0],l=o>4&&a[4][0]):/^system$/i.test(a[2][0])&&(l=a[3][0]));var u=a[o-1];return n.startDTD(s,c,l),n.endDTD(),u.index+u[0].length}}return-1}function ee(e,t,n){var r=e.indexOf(`?>`,t);if(r){var i=e.substring(t,r).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return i?(i[0].length,n.processingInstruction(i[1],i[2]),r+2):-1}return-1}function C(){this.attributeNames={}}C.prototype={setTagName:function(e){if(!i.test(e))throw Error(`invalid tagName:`+e);this.tagName=e},addValue:function(e,t,n){if(!i.test(e))throw Error(`invalid attribute:`+e);this.attributeNames[e]=this.length,this[this.length++]={qName:e,value:t,offset:n}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}};function w(e,t){var n,r=[],i=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(i.lastIndex=t,i.exec(e);n=i.exec(e);)if(r.push(n),n[1])return r}e.XMLReader=m,e.ParseError=p})),jd=x((e=>{var t=Dd(),n=Od(),r=kd(),i=Ad(),a=n.DOMImplementation,o=t.NAMESPACE,s=i.ParseError,c=i.XMLReader;function l(e){return e.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028]/g,`
`)}function u(e){this.options=e||{locator:{}}}u.prototype.parseFromString=function(e,t){var n=this.options,i=new c,a=n.domBuilder||new f,s=n.errorHandler,u=n.locator,p=n.xmlns||{},m=/\/x?html?$/.test(t),h=m?r.HTML_ENTITIES:r.XML_ENTITIES;u&&a.setDocumentLocator(u),i.errorHandler=d(s,a,u),i.domBuilder=n.domBuilder||a,m&&(p[``]=o.HTML),p.xml=p.xml||o.XML;var g=n.normalizeLineEndings||l;return e&&typeof e==`string`?i.parse(g(e),p,h):i.errorHandler.error(`invalid doc source`),a.doc};function d(e,t,n){if(!e){if(t instanceof f)return t;e=t}var r={},i=e instanceof Function;n||={};function a(t){var a=e[t];!a&&i&&(a=e.length==2?function(n){e(t,n)}:e),r[t]=a&&function(e){a(`[xmldom `+t+`]	`+e+m(n))}||function(){}}return a(`warning`),a(`error`),a(`fatalError`),r}function f(){this.cdata=!1}function p(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}f.prototype={startDocument:function(){this.doc=new a().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,n,r){var i=this.doc,a=i.createElementNS(e,n||t),o=r.length;g(this,a),this.currentElement=a,this.locator&&p(this.locator,a);for(var s=0;s<o;s++){var e=r.getURI(s),c=r.getValue(s),n=r.getQName(s),l=i.createAttributeNS(e,n);this.locator&&p(r.getLocator(s),l),l.value=l.nodeValue=c,a.setAttributeNode(l)}},endElement:function(e,t,n){var r=this.currentElement;r.tagName,this.currentElement=r.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var n=this.doc.createProcessingInstruction(e,t);this.locator&&p(this.locator,n),g(this,n)},ignorableWhitespace:function(e,t,n){},characters:function(e,t,n){if(e=h.apply(this,arguments),e){if(this.cdata)var r=this.doc.createCDATASection(e);else var r=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(r):/^\s*$/.test(e)&&this.doc.appendChild(r),this.locator&&p(this.locator,r)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,n){e=h.apply(this,arguments);var r=this.doc.createComment(e);this.locator&&p(this.locator,r),g(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,n){var r=this.doc.implementation;if(r&&r.createDocumentType){var i=r.createDocumentType(e,t,n);this.locator&&p(this.locator,i),g(this,i),this.doc.doctype=i}},warning:function(e){console.warn(`[xmldom warning]	`+e,m(this.locator))},error:function(e){console.error(`[xmldom error]	`+e,m(this.locator))},fatalError:function(e){throw new s(e,this.locator)}};function m(e){if(e)return`
@`+(e.systemId||``)+`#[line:`+e.lineNumber+`,col:`+e.columnNumber+`]`}function h(e,t,n){return typeof e==`string`?e.substr(t,n):e.length>=t+n||t?new java.lang.String(e,t,n)+``:e}`endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl`.replace(/\w+/g,function(e){f.prototype[e]=function(){return null}});function g(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}e.__DOMHandler=f,e.normalizeLineEndings=l,e.DOMParser=u})),Md=x((e=>{var t=Od();e.DOMImplementation=t.DOMImplementation,e.XMLSerializer=t.XMLSerializer,e.DOMParser=jd().DOMParser}))(),Nd={createCanvas:(e,t)=>new OffscreenCanvas(e??0,t??0),createImage:()=>new Image,getCanvasRenderingContext2D:()=>OffscreenCanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>globalThis.location.href,getFontFaceSet:()=>globalThis.fonts,fetch:(e,t)=>fetch(e,t),parseXML:e=>new Md.DOMParser().parseFromString(e,`text/xml`)},Pd=`
in vec2 vTextureCoord;

out vec4 finalColor;

uniform float uAlpha;
uniform sampler2D uTexture;

void main()
{
    finalColor =  texture(uTexture, vTextureCoord) * uAlpha;
}
`,Fd=`struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct AlphaUniforms {
  uAlpha:f32,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;

@group(1) @binding(0) var<uniform> alphaUniforms : AlphaUniforms;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}
  
@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition)
  );
}

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {
 
    var sample = textureSample(uTexture, uSampler, uv);
    
    return sample * alphaUniforms.uAlpha;
}`,Id=class e extends Ft{constructor(t){t={...e.defaultOptions,...t};let n=B.from({vertex:{source:Fd,entryPoint:`mainVertex`},fragment:{source:Fd,entryPoint:`mainFragment`}}),r=V.from({vertex:wi,fragment:Pd,name:`alpha-filter`}),{alpha:i,...a}=t,o=new tt({uAlpha:{value:i,type:`f32`}});super({...a,gpuProgram:n,glProgram:r,resources:{alphaUniforms:o}})}get alpha(){return this.resources.alphaUniforms.uniforms.uAlpha}set alpha(e){this.resources.alphaUniforms.uniforms.uAlpha=e}};Id.defaultOptions={alpha:1};var Ld=Id,Rd={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},zd=[`in vec2 vBlurTexCoords[%size%];`,`uniform sampler2D uTexture;`,`out vec4 finalColor;`,`void main(void)`,`{`,`    finalColor = vec4(0.0);`,`    %blur%`,`}`].join(`
`);function Bd(e){let t=Rd[e],n=t.length,r=zd,i=``,a;for(let r=0;r<e;r++){let o=`finalColor += texture(uTexture, vBlurTexCoords[%index%]) * %value%;`.replace(`%index%`,r.toString());a=r,r>=n&&(a=e-r-1),o=o.replace(`%value%`,t[a].toString()),i+=o,i+=`
`}return r=r.replace(`%blur%`,i),r=r.replace(`%size%`,e.toString()),r}var Vd=`
    in vec2 aPosition;

    uniform float uStrength;

    out vec2 vBlurTexCoords[%size%];

    uniform vec4 uInputSize;
    uniform vec4 uOutputFrame;
    uniform vec4 uOutputTexture;

    vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;

    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

    vec2 filterTextureCoord( void )
    {
        return aPosition * (uOutputFrame.zw * uInputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        float pixelStrength = uInputSize.%dimension% * uStrength;

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function Hd(e,t){let n=Math.ceil(e/2),r=Vd,i=``,a;a=t?`vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * pixelStrength, 0.0);`:`vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * pixelStrength);`;for(let t=0;t<e;t++){let e=a.replace(`%index%`,t.toString());e=e.replace(`%sampleIndex%`,`${t-(n-1)}.0`),i+=e,i+=`
`}return r=r.replace(`%blur%`,i),r=r.replace(`%size%`,e.toString()),r=r.replace(`%dimension%`,t?`z`:`w`),r}function Ud(e,t){let n=Hd(t,e),r=Bd(t);return V.from({vertex:n,fragment:r,name:`blur-${e?`horizontal`:`vertical`}-pass-filter`})}var Wd=`

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct BlurUniforms {
  uStrength:f32,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;

@group(1) @binding(0) var<uniform> blurUniforms : BlurUniforms;


struct VSOutput {
    @builtin(position) position: vec4<f32>,
    %blur-struct%
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}


@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {

  let filteredCord = filterTextureCoord(aPosition);

  let pixelStrength = gfu.uInputSize.%dimension% * blurUniforms.uStrength;

  return VSOutput(
   filterVertexPosition(aPosition),
    %blur-vertex-out%
  );
}

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  %blur-fragment-in%
) -> @location(0) vec4<f32> {

    var   finalColor = vec4(0.0);

    %blur-sampling%

    return finalColor;
}`;function Gd(e,t){let n=Rd[t],r=n.length,i=[],a=[],o=[];for(let s=0;s<t;s++){i[s]=`@location(${s}) offset${s}: vec2<f32>,`,e?a[s]=`filteredCord + vec2(${s-r+1} * pixelStrength, 0.0),`:a[s]=`filteredCord + vec2(0.0, ${s-r+1} * pixelStrength),`;let c=n[s<r?s:t-s-1].toString();o[s]=`finalColor += textureSample(uTexture, uSampler, offset${s}) * ${c};`}let s=i.join(`
`),c=a.join(`
`),l=o.join(`
`),u=Wd.replace(`%blur-struct%`,s).replace(`%blur-vertex-out%`,c).replace(`%blur-fragment-in%`,s).replace(`%blur-sampling%`,l).replace(`%dimension%`,e?`z`:`w`);return B.from({vertex:{source:u,entryPoint:`mainVertex`},fragment:{source:u,entryPoint:`mainFragment`}})}var Kd=class e extends Ft{constructor(t){t={...e.defaultOptions,...t};let n=Ud(t.horizontal,t.kernelSize),r=Gd(t.horizontal,t.kernelSize);super({glProgram:n,gpuProgram:r,resources:{blurUniforms:{uStrength:{value:0,type:`f32`}}},...t}),this.horizontal=t.horizontal,this._quality=0,this.quality=t.quality,this.blur=t.strength,this._uniforms=this.resources.blurUniforms.uniforms}apply(e,t,n,r){if(this._uniforms.uStrength=this.strength/this.passes,this.passes===1)e.applyFilter(this,t,n,r);else{let i=M.getSameSizeTexture(t),a=t,o=i;this._state.blend=!1;let s=e.renderer.type===wt.WEBGPU;for(let t=0;t<this.passes-1;t++){e.applyFilter(this,a,o,t===0?!0:s);let n=o;o=a,a=n}this._state.blend=!0,e.applyFilter(this,a,n,r),M.returnTexture(i)}}get blur(){return this.strength}set blur(e){this.padding=1+Math.abs(e)*2,this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}};Kd.defaultOptions={strength:8,quality:4,kernelSize:5};var qd=Kd,Jd=class extends Ft{constructor(...e){let t=e[0]??{};typeof t==`number`&&(F(H,`BlurFilter constructor params are now options object. See params: { strength, quality, resolution, kernelSize }`),t={strength:t},e[1]!==void 0&&(t.quality=e[1]),e[2]!==void 0&&(t.resolution=e[2]||`inherit`),e[3]!==void 0&&(t.kernelSize=e[3])),t={...qd.defaultOptions,...t};let{strength:n,strengthX:r,strengthY:i,quality:a,...o}=t;super({...o,compatibleRenderers:wt.BOTH,resources:{}}),this._repeatEdgePixels=!1,this.blurXFilter=new qd({horizontal:!0,...t}),this.blurYFilter=new qd({horizontal:!1,...t}),this.quality=a,this.strengthX=r??n,this.strengthY=i??n,this.repeatEdgePixels=!1}apply(e,t,n,r){let i=Math.abs(this.blurXFilter.strength),a=Math.abs(this.blurYFilter.strength);if(i&&a){let i=M.getSameSizeTexture(t);this.blurXFilter.blendMode=`normal`,this.blurXFilter.apply(e,t,i,!0),this.blurYFilter.blendMode=this.blendMode,this.blurYFilter.apply(e,i,n,r),M.returnTexture(i)}else a?(this.blurYFilter.blendMode=this.blendMode,this.blurYFilter.apply(e,t,n,r)):(this.blurXFilter.blendMode=this.blendMode,this.blurXFilter.apply(e,t,n,r))}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.blur),Math.abs(this.blurYFilter.blur))*2}get strength(){if(this.strengthX!==this.strengthY)throw Error(`BlurFilter's strengthX and strengthY are different`);return this.strengthX}set strength(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get strengthX(){return this.blurXFilter.blur}set strengthX(e){this.blurXFilter.blur=e,this.updatePadding()}get strengthY(){return this.blurYFilter.blur}set strengthY(e){this.blurYFilter.blur=e,this.updatePadding()}get blur(){return F(`8.3.0`,`BlurFilter.blur is deprecated, please use BlurFilter.strength instead.`),this.strength}set blur(e){F(`8.3.0`,`BlurFilter.blur is deprecated, please use BlurFilter.strength instead.`),this.strength=e}get blurX(){return F(`8.3.0`,`BlurFilter.blurX is deprecated, please use BlurFilter.strengthX instead.`),this.strengthX}set blurX(e){F(`8.3.0`,`BlurFilter.blurX is deprecated, please use BlurFilter.strengthX instead.`),this.strengthX=e}get blurY(){return F(`8.3.0`,`BlurFilter.blurY is deprecated, please use BlurFilter.strengthY instead.`),this.strengthY}set blurY(e){F(`8.3.0`,`BlurFilter.blurY is deprecated, please use BlurFilter.strengthY instead.`),this.strengthY=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}};Jd.defaultOptions={strength:8,quality:4,kernelSize:5};var Yd=`
in vec2 vTextureCoord;
in vec4 vColor;

out vec4 finalColor;

uniform float uColorMatrix[20];
uniform float uAlpha;

uniform sampler2D uTexture;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture(uTexture, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * 0.2);
    float diff = (randomValue - 0.5) *  0.5;

    if (uAlpha == 0.0) {
        finalColor = color;
        return;
    }

    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    vec4 result;

    result.r = (uColorMatrix[0] * color.r);
        result.r += (uColorMatrix[1] * color.g);
        result.r += (uColorMatrix[2] * color.b);
        result.r += (uColorMatrix[3] * color.a);
        result.r += uColorMatrix[4];

    result.g = (uColorMatrix[5] * color.r);
        result.g += (uColorMatrix[6] * color.g);
        result.g += (uColorMatrix[7] * color.b);
        result.g += (uColorMatrix[8] * color.a);
        result.g += uColorMatrix[9];

    result.b = (uColorMatrix[10] * color.r);
       result.b += (uColorMatrix[11] * color.g);
       result.b += (uColorMatrix[12] * color.b);
       result.b += (uColorMatrix[13] * color.a);
       result.b += uColorMatrix[14];

    result.a = (uColorMatrix[15] * color.r);
       result.a += (uColorMatrix[16] * color.g);
       result.a += (uColorMatrix[17] * color.b);
       result.a += (uColorMatrix[18] * color.a);
       result.a += uColorMatrix[19];

    vec3 rgb = mix(color.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    finalColor = vec4(rgb, result.a);
}
`,Xd=`struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct ColorMatrixUniforms {
  uColorMatrix:array<vec4<f32>, 5>,
  uAlpha:f32,
};


@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;
@group(1) @binding(0) var<uniform> colorMatrixUniforms : ColorMatrixUniforms;


struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>,
  };
  
fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition),
  );
}


@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
) -> @location(0) vec4<f32> {


  var c = textureSample(uTexture, uSampler, uv);
  
  if (colorMatrixUniforms.uAlpha == 0.0) {
    return c;
  }

 
    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.r /= c.a;
      c.g /= c.a;
      c.b /= c.a;
    }

    var cm = colorMatrixUniforms.uColorMatrix;


    var result = vec4<f32>(0.);

    result.r = (cm[0][0] * c.r);
    result.r += (cm[0][1] * c.g);
    result.r += (cm[0][2] * c.b);
    result.r += (cm[0][3] * c.a);
    result.r += cm[1][0];

    result.g = (cm[1][1] * c.r);
    result.g += (cm[1][2] * c.g);
    result.g += (cm[1][3] * c.b);
    result.g += (cm[2][0] * c.a);
    result.g += cm[2][1];

    result.b = (cm[2][2] * c.r);
    result.b += (cm[2][3] * c.g);
    result.b += (cm[3][0] * c.b);
    result.b += (cm[3][1] * c.a);
    result.b += cm[3][2];

    result.a = (cm[3][3] * c.r);
    result.a += (cm[4][0] * c.g);
    result.a += (cm[4][1] * c.b);
    result.a += (cm[4][2] * c.a);
    result.a += cm[4][3];

    var rgb = mix(c.rgb, result.rgb, colorMatrixUniforms.uAlpha);

    rgb.r *= result.a;
    rgb.g *= result.a;
    rgb.b *= result.a;

    return vec4(rgb, result.a);
}`,Zd=class extends Ft{constructor(e={}){let t=new tt({uColorMatrix:{value:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],type:`f32`,size:20},uAlpha:{value:1,type:`f32`}}),n=B.from({vertex:{source:Xd,entryPoint:`mainVertex`},fragment:{source:Xd,entryPoint:`mainFragment`}}),r=V.from({vertex:wi,fragment:Yd,name:`color-matrix-filter`});super({...e,gpuProgram:n,glProgram:r,resources:{colorMatrixUniforms:t}}),this.alpha=1}_loadMatrix(e,t=!1){let n=e;t&&(this._multiply(n,this.matrix,e),n=this._colorMatrix(n)),this.resources.colorMatrixUniforms.uniforms.uColorMatrix=n,this.resources.colorMatrixUniforms.update()}_multiply(e,t,n){return e[0]=t[0]*n[0]+t[1]*n[5]+t[2]*n[10]+t[3]*n[15],e[1]=t[0]*n[1]+t[1]*n[6]+t[2]*n[11]+t[3]*n[16],e[2]=t[0]*n[2]+t[1]*n[7]+t[2]*n[12]+t[3]*n[17],e[3]=t[0]*n[3]+t[1]*n[8]+t[2]*n[13]+t[3]*n[18],e[4]=t[0]*n[4]+t[1]*n[9]+t[2]*n[14]+t[3]*n[19]+t[4],e[5]=t[5]*n[0]+t[6]*n[5]+t[7]*n[10]+t[8]*n[15],e[6]=t[5]*n[1]+t[6]*n[6]+t[7]*n[11]+t[8]*n[16],e[7]=t[5]*n[2]+t[6]*n[7]+t[7]*n[12]+t[8]*n[17],e[8]=t[5]*n[3]+t[6]*n[8]+t[7]*n[13]+t[8]*n[18],e[9]=t[5]*n[4]+t[6]*n[9]+t[7]*n[14]+t[8]*n[19]+t[9],e[10]=t[10]*n[0]+t[11]*n[5]+t[12]*n[10]+t[13]*n[15],e[11]=t[10]*n[1]+t[11]*n[6]+t[12]*n[11]+t[13]*n[16],e[12]=t[10]*n[2]+t[11]*n[7]+t[12]*n[12]+t[13]*n[17],e[13]=t[10]*n[3]+t[11]*n[8]+t[12]*n[13]+t[13]*n[18],e[14]=t[10]*n[4]+t[11]*n[9]+t[12]*n[14]+t[13]*n[19]+t[14],e[15]=t[15]*n[0]+t[16]*n[5]+t[17]*n[10]+t[18]*n[15],e[16]=t[15]*n[1]+t[16]*n[6]+t[17]*n[11]+t[18]*n[16],e[17]=t[15]*n[2]+t[16]*n[7]+t[17]*n[12]+t[18]*n[17],e[18]=t[15]*n[3]+t[16]*n[8]+t[17]*n[13]+t[18]*n[18],e[19]=t[15]*n[4]+t[16]*n[9]+t[17]*n[14]+t[18]*n[19]+t[19],e}_colorMatrix(e){let t=new Float32Array(e);return t[4]/=255,t[9]/=255,t[14]/=255,t[19]/=255,t}brightness(e,t){let n=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(n,t)}tint(e,t){let[n,r,i]=o.shared.setValue(e).toArray(),a=[n,0,0,0,0,0,r,0,0,0,0,0,i,0,0,0,0,0,1,0];this._loadMatrix(a,t)}greyscale(e,t){let n=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(n,t)}grayscale(e,t){this.greyscale(e,t)}blackAndWhite(e){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],e)}hue(e,t){e=(e||0)/180*Math.PI;let n=Math.cos(e),r=Math.sin(e),i=Math.sqrt,a=1/3,o=i(a),s=[n+(1-n)*a,a*(1-n)-o*r,a*(1-n)+o*r,0,0,a*(1-n)+o*r,n+a*(1-n),a*(1-n)-o*r,0,0,a*(1-n)-o*r,a*(1-n)+o*r,n+a*(1-n),0,0,0,0,0,1,0];this._loadMatrix(s,t)}contrast(e,t){let n=(e||0)+1,r=-.5*(n-1),i=[n,0,0,0,r,0,n,0,0,r,0,0,n,0,r,0,0,0,1,0];this._loadMatrix(i,t)}saturate(e=0,t){let n=e*2/3+1,r=(n-1)*-.5,i=[n,r,r,0,0,r,n,r,0,0,r,r,n,0,0,0,0,0,1,0];this._loadMatrix(i,t)}desaturate(){this.saturate(-1)}negative(e){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],e)}sepia(e){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],e)}technicolor(e){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],e)}polaroid(e){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],e)}toBGR(e){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],e)}kodachrome(e){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],e)}browni(e){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],e)}vintage(e){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],e)}colorTone(e,t,n,r,i){e||=.2,t||=.15,n||=16770432,r||=3375104;let a=o.shared,[s,c,l]=a.setValue(n).toArray(),[u,d,f]=a.setValue(r).toArray(),p=[.3,.59,.11,0,0,s,c,l,e,0,u,d,f,t,0,s-u,c-d,l-f,0,0];this._loadMatrix(p,i)}night(e,t){e||=.1;let n=[e*-2,-e,0,0,0,-e,0,e,0,0,0,e,e*2,0,0,0,0,0,1,0];this._loadMatrix(n,t)}predator(e,t){let n=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(n,t)}lsd(e){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],e)}reset(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)}get matrix(){return this.resources.colorMatrixUniforms.uniforms.uColorMatrix}set matrix(e){this.resources.colorMatrixUniforms.uniforms.uColorMatrix=e}get alpha(){return this.resources.colorMatrixUniforms.uniforms.uAlpha}set alpha(e){this.resources.colorMatrixUniforms.uniforms.uAlpha=e}},Qd=`
in vec2 vTextureCoord;
in vec2 vFilterUv;

out vec4 finalColor;

uniform sampler2D uTexture;
uniform sampler2D uMapTexture;

uniform vec4 uInputClamp;
uniform highp vec4 uInputSize;
uniform mat2 uRotation;
uniform vec2 uScale;

void main()
{
    vec4 map = texture(uMapTexture, vFilterUv);
    
    vec2 offset = uInputSize.zw * (uRotation * (map.xy - 0.5)) * uScale; 

    finalColor = texture(uTexture, clamp(vTextureCoord + offset, uInputClamp.xy, uInputClamp.zw));
}
`,$d=`in vec2 aPosition;
out vec2 vTextureCoord;
out vec2 vFilterUv;


uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

uniform mat3 uFilterMatrix;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

vec2 getFilterCoord( void )
{
  return ( uFilterMatrix * vec3( filterTextureCoord(), 1.0)  ).xy;
}


void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
    vFilterUv = getFilterCoord();
}
`,ef=`
struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct DisplacementUniforms {
  uFilterMatrix:mat3x3<f32>,
  uScale:vec2<f32>,
  uRotation:mat2x2<f32>
};



@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;

@group(1) @binding(0) var<uniform> filterUniforms : DisplacementUniforms;
@group(1) @binding(1) var uMapTexture: texture_2d<f32>;
@group(1) @binding(2) var uMapSampler : sampler;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>,
    @location(1) filterUv : vec2<f32>,
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getFilterCoord(aPosition:vec2<f32> ) -> vec2<f32>
{
  return ( filterUniforms.uFilterMatrix * vec3( filterTextureCoord(aPosition), 1.0)  ).xy;
}

fn getSize() -> vec2<f32>
{

  
  return gfu.uGlobalFrame.zw;
}
  
@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition),
   getFilterCoord(aPosition)
  );
}

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @location(1) filterUv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {

    var map = textureSample(uMapTexture, uMapSampler, filterUv);

    var offset =  gfu.uInputSize.zw * (filterUniforms.uRotation * (map.xy - 0.5)) * filterUniforms.uScale; 
   
    return textureSample(uTexture, uSampler, clamp(uv + offset, gfu.uInputClamp.xy, gfu.uInputClamp.zw));
}`,tf=class extends Ft{constructor(...e){let t=e[0];t instanceof _e&&(e[1]&&F(H,`DisplacementFilter now uses options object instead of params. {sprite, scale}`),t={sprite:t,scale:e[1]});let{sprite:n,scale:r,...i}=t,a=r??20;typeof a==`number`&&(a=new v(a,a));let o=new tt({uFilterMatrix:{value:new ue,type:`mat3x3<f32>`},uScale:{value:a,type:`vec2<f32>`},uRotation:{value:new Float32Array([0,0,0,0]),type:`mat2x2<f32>`}}),s=V.from({vertex:$d,fragment:Qd,name:`displacement-filter`}),c=B.from({vertex:{source:ef,entryPoint:`mainVertex`},fragment:{source:ef,entryPoint:`mainFragment`}}),l=n.texture.source;super({...i,gpuProgram:c,glProgram:s,resources:{filterUniforms:o,uMapTexture:l,uMapSampler:l.style}}),this._sprite=t.sprite,this._sprite.renderable=!1}apply(e,t,n,r){let i=this.resources.filterUniforms.uniforms;e.calculateSpriteMatrix(i.uFilterMatrix,this._sprite);let a=this._sprite.worldTransform,o=Math.sqrt(a.a*a.a+a.b*a.b),s=Math.sqrt(a.c*a.c+a.d*a.d);o!==0&&s!==0&&(i.uRotation[0]=a.a/o,i.uRotation[1]=a.b/o,i.uRotation[2]=a.c/s,i.uRotation[3]=a.d/s),this.resources.uMapTexture=this._sprite.texture.source,e.applyFilter(this,t,n,r)}get scale(){return this.resources.filterUniforms.uniforms.uScale}},nf=`
in vec2 vTextureCoord;
in vec4 vColor;

out vec4 finalColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uTexture;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture(uTexture, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) *  uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    finalColor = color;
}
`,rf=`

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct NoiseUniforms {
  uNoise:f32,
  uSeed:f32,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;

@group(1) @binding(0) var<uniform> noiseUniforms : NoiseUniforms;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}
  
@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition)
  );
}

fn rand(co:vec2<f32>) -> f32
{
  return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}



@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {

    var pixelPosition =  globalTextureCoord(position.xy);// / (getSize());//-  gfu.uOutputFrame.xy);
  
    
    var sample = textureSample(uTexture, uSampler, uv);
    var randomValue =  rand(pixelPosition.xy * noiseUniforms.uSeed);
    var diff = (randomValue - 0.5) * noiseUniforms.uNoise;
  
    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (sample.a > 0.0) {
      sample.r /= sample.a;
      sample.g /= sample.a;
      sample.b /= sample.a;
    }

    sample.r += diff;
    sample.g += diff;
    sample.b += diff;

    // Premultiply alpha again.
    sample.r *= sample.a;
    sample.g *= sample.a;
    sample.b *= sample.a;
    
    return sample;
}`,af=class e extends Ft{constructor(t={}){t={...e.defaultOptions,...t};let n=B.from({vertex:{source:rf,entryPoint:`mainVertex`},fragment:{source:rf,entryPoint:`mainFragment`}}),r=V.from({vertex:wi,fragment:nf,name:`noise-filter`}),{noise:i,seed:a,...o}=t;super({...o,gpuProgram:n,glProgram:r,resources:{noiseUniforms:new tt({uNoise:{value:1,type:`f32`},uSeed:{value:1,type:`f32`}})}}),this.noise=i,this.seed=a??Math.random()}get noise(){return this.resources.noiseUniforms.uniforms.uNoise}set noise(e){this.resources.noiseUniforms.uniforms.uNoise=e}get seed(){return this.resources.noiseUniforms.uniforms.uSeed}set seed(e){this.resources.noiseUniforms.uniforms.uSeed=e}};af.defaultOptions={noise:.5};var of=af,sf=`fn getLuminosity(c: vec3<f32>) -> f32 {
  return 0.3 * c.r + 0.59 * c.g + 0.11 * c.b;
}

fn setLuminosity(c: vec3<f32>, lum: f32) -> vec3<f32> {
  let d: f32 = lum - getLuminosity(c);
  let newColor: vec3<f32> = c.rgb + vec3<f32>(d, d, d);

  // clip back into legal range
  let newLum: f32 = getLuminosity(newColor);
  let cMin: f32 = min(newColor.r, min(newColor.g, newColor.b));
  let cMax: f32 = max(newColor.r, max(newColor.g, newColor.b));

  let t1: f32 = newLum / (newLum - cMin);
  let t2: f32 = (1.0 - newLum) / (cMax - newLum);

  let finalColor = mix(vec3<f32>(newLum, newLum, newLum), newColor, select(select(1.0, t2, cMax > 1.0), t1, cMin < 0.0));

  return finalColor;
}

fn getSaturation(c: vec3<f32>) -> f32 {
  return max(c.r, max(c.g, c.b)) - min(c.r, min(c.g, c.b));
}

// Set saturation if color components are sorted in ascending order.
fn setSaturationMinMidMax(cSorted: vec3<f32>, s: f32) -> vec3<f32> {
  var result: vec3<f32>;
  if (cSorted.z > cSorted.x) {
    let newY = (((cSorted.y - cSorted.x) * s) / (cSorted.z - cSorted.x));
    result = vec3<f32>(0.0, newY, s);
  } else {
    result = vec3<f32>(0.0, 0.0, 0.0);
  }
  return vec3<f32>(result.x, result.y, result.z);
}

fn setSaturation(c: vec3<f32>, s: f32) -> vec3<f32> {
    var result: vec3<f32> = c;

    if (c.r <= c.g && c.r <= c.b) {
        if (c.g <= c.b) {
            result = setSaturationMinMidMax(result, s);
        } else {
            var temp: vec3<f32> = vec3<f32>(result.r, result.b, result.g);
            temp = setSaturationMinMidMax(temp, s);
            result = vec3<f32>(temp.r, temp.b, temp.g);
        }
    } else if (c.g <= c.r && c.g <= c.b) {
        if (c.r <= c.b) {
            var temp: vec3<f32> = vec3<f32>(result.g, result.r, result.b);
            temp = setSaturationMinMidMax(temp, s);
            result = vec3<f32>(temp.g, temp.r, temp.b);
        } else {
            var temp: vec3<f32> = vec3<f32>(result.g, result.b, result.r);
            temp = setSaturationMinMidMax(temp, s);
            result = vec3<f32>(temp.g, temp.b, temp.r);
        }
    } else {
        if (c.r <= c.g) {
            var temp: vec3<f32> = vec3<f32>(result.b, result.r, result.g);
            temp = setSaturationMinMidMax(temp, s);
            result = vec3<f32>(temp.b, temp.r, temp.g);
        } else {
            var temp: vec3<f32> = vec3<f32>(result.b, result.g, result.r);
            temp = setSaturationMinMidMax(temp, s);
            result = vec3<f32>(temp.b, temp.g, temp.r);
        }
    }

    return result;
}`,cf=class e{constructor(t){this._tick=()=>{this._destroyed||(this.timeout=setTimeout(this._processQueue,0))},this._processQueue=()=>{if(this._destroyed)return;let{queue:t}=this,n=0;for(;t.length&&n<e.uploadsPerFrame;){let e=t.shift();this.uploadQueueItem(e),n++}t.length?p.system.addOnce(this._tick,this,dt.UTILITY):this._resolve()},this.renderer=t,this.queue=[],this.resolves=[]}getQueue(){return[...this.queue]}add(e){let t=Array.isArray(e)?e:[e];for(let e of t)e instanceof i?this._addContainer(e):this.resolveQueueItem(e,this.queue);return this}_addContainer(e){this.resolveQueueItem(e,this.queue);for(let t of e.children)this._addContainer(t)}upload(e){return e&&this.add(e),new Promise(e=>{this.queue.length?(this.resolves.push(e),this.dedupeQueue(),p.system.addOnce(this._tick,this,dt.UTILITY)):e()})}dedupeQueue(){let e=Object.create(null),t=0;for(let n=0;n<this.queue.length;n++){let r=this.queue[n];e[r.uid]||(e[r.uid]=!0,this.queue[t++]=r)}this.queue.length=t}destroy(){this._destroyed=!0,clearTimeout(this.timeout)}_resolve(){let{resolves:e}=this,t=e.slice(0);e.length=0;for(let e of t)e()}};cf.uploadsPerFrame=4;var lf=cf,uf=class extends g{constructor(...e){let t=e[0];t instanceof ot&&(F(H,`Mesh: use new Mesh({ geometry, shader }) instead`),t={geometry:t,shader:e[1]},e[3]&&(F(H,`Mesh: drawMode argument has been removed, use geometry.topology instead`),t.geometry.topology=e[3]));let{geometry:n,shader:r,texture:i,roundPixels:a,state:o,...s}=t;super({label:`Mesh`,...s}),this.renderPipeId=`mesh`,this._shader=null,this.allowChildren=!1,this.shader=r??null,this.texture=i??r?.texture??W.WHITE,this.state=o??Ve.for2d(),this._geometry=n,this._geometry.on(`update`,this.onViewUpdate,this),this.roundPixels=a??!1}get material(){return F(H,`mesh.material property has been removed, use mesh.shader instead`),this._shader}set shader(e){this._shader!==e&&(this._shader=e,this.onViewUpdate())}get shader(){return this._shader}set geometry(e){this._geometry!==e&&(this._geometry?.off(`update`,this.onViewUpdate,this),e.on(`update`,this.onViewUpdate,this),this._geometry=e,this.onViewUpdate())}get geometry(){return this._geometry}set texture(e){e||=W.EMPTY;let t=this._texture;t!==e&&(t&&t.dynamic&&t.off(`update`,this.onViewUpdate,this),e.dynamic&&e.on(`update`,this.onViewUpdate,this),this.shader&&(this.shader.texture=e),this._texture=e,this.onViewUpdate())}get texture(){return this._texture}get batched(){return this._shader||this.state.data&12?!1:this._geometry instanceof Xi?this._geometry.batchMode===`auto`?this._geometry.positions.length/2<=100:this._geometry.batchMode===`batch`:!1}get bounds(){return this._geometry.bounds}updateBounds(){this._bounds=this._geometry.bounds}containsPoint(e){let{x:t,y:n}=e;if(!this.bounds.containsPoint(t,n))return!1;let r=this.geometry.getBuffer(`aPosition`).data,i=this.geometry.topology===`triangle-strip`?3:1;if(this.geometry.getIndex()){let e=this.geometry.getIndex().data,a=e.length;for(let o=0;o+2<a;o+=i){let i=e[o]*2,a=e[o+1]*2,s=e[o+2]*2;if(ec(t,n,r[i],r[i+1],r[a],r[a+1],r[s],r[s+1]))return!0}}else{let e=r.length/2;for(let a=0;a+2<e;a+=i){let e=a*2,i=(a+1)*2,o=(a+2)*2;if(ec(t,n,r[e],r[e+1],r[i],r[i+1],r[o],r[o+1]))return!0}}return!1}destroy(e){if(super.destroy(e),typeof e==`boolean`?e:e?.texture){let t=typeof e==`boolean`?e:e?.textureSource;this._texture.destroy(t)}this._geometry?.off(`update`,this.onViewUpdate,this),this._texture=null,this._geometry=null,this._shader=null,this._gpuData=null}},df=class e extends _e{constructor(...e){let t=e[0];Array.isArray(e[0])&&(t={textures:e[0],autoUpdate:e[1]});let{animationSpeed:n=1,autoPlay:r=!1,autoUpdate:i=!0,loop:a=!0,onComplete:o=null,onFrameChange:s=null,onLoop:c=null,textures:l,updateAnchor:u=!1,...d}=t,[f]=l;super({...d,texture:f instanceof W?f:f.texture}),this._textures=null,this._durations=null,this._autoUpdate=i,this._isConnectedToTicker=!1,this.animationSpeed=n,this.loop=a,this.updateAnchor=u,this.onComplete=o,this.onFrameChange=s,this.onLoop=c,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=l,r&&this.play()}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(p.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(p.shared.add(this.update,this,dt.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(e){this.stop(),this.currentFrame=e}gotoAndPlay(e){this.currentFrame=e,this.play()}update(e){if(!this._playing)return;let t=e.deltaTime,n=this.animationSpeed*t,r=this.currentFrame;if(this._durations!==null){let e=this._currentTime%1*this._durations[this.currentFrame];for(e+=n/60*1e3;e<0;)this._currentTime--,e+=this._durations[this.currentFrame];let r=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);e>=this._durations[this.currentFrame];)e-=this._durations[this.currentFrame]*r,this._currentTime+=r;this._currentTime+=e/this._durations[this.currentFrame]}else this._currentTime+=n;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):r!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<r||this.animationSpeed<0&&this.currentFrame>r)&&this.onLoop(),this._updateTexture())}_updateTexture(){let e=this.currentFrame;this._previousFrame!==e&&(this._previousFrame=e,this.texture=this._textures[e],this.updateAnchor&&this.texture.defaultAnchor&&this.anchor.copyFrom(this.texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(e=!1){if(typeof e==`boolean`?e:e?.texture){let t=typeof e==`boolean`?e:e?.textureSource;this._textures.forEach(e=>{this.texture!==e&&e.destroy(t)})}this._textures=[],this._durations=null,this.stop(),super.destroy(e),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(t){let n=[];for(let e=0;e<t.length;++e)n.push(W.from(t[e]));return new e(n)}static fromImages(t){let n=[];for(let e=0;e<t.length;++e)n.push(W.from(t[e]));return new e(n)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(e){if(e[0]instanceof W)this._textures=e,this._durations=null;else{this._textures=[],this._durations=[];for(let t=0;t<e.length;t++)this._textures.push(e[t].texture),this._durations.push(e[t].time)}this._previousFrame=null,this.gotoAndStop(0),this._updateTexture()}get currentFrame(){let e=Math.floor(this._currentTime)%this._textures.length;return e<0&&(e+=this._textures.length),e}set currentFrame(e){if(e<0||e>this.totalFrames-1)throw Error(`[AnimatedSprite]: Invalid frame index value ${e}, expected to be between 0 and totalFrames ${this.totalFrames}.`);let t=this.currentFrame;this._currentTime=e,t!==this.currentFrame&&this._updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(p.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(p.shared.add(this.update,this),this._isConnectedToTicker=!0))}},ff=class{constructor({matrix:e,observer:t}={}){this.dirty=!0,this._matrix=e??new ue,this.observer=t,this.position=new P(this,0,0),this.scale=new P(this,1,1),this.pivot=new P(this,0,0),this.skew=new P(this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1}get matrix(){let e=this._matrix;return this.dirty?(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this.dirty=!1,e):e}_onUpdate(e){this.dirty=!0,e===this.skew&&this.updateSkew(),this.observer?._onUpdate(this)}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this.dirty=!0}toString(){return`[pixi.js/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}setFromMatrix(e){e.decompose(this),this.dirty=!0}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this._onUpdate(this.skew))}},pf=class e extends g{constructor(...t){let n=t[0]||{};n instanceof W&&(n={texture:n}),t.length>1&&(F(H,`use new TilingSprite({ texture, width:100, height:100 }) instead`),n.width=t[1],n.height=t[2]),n={...e.defaultOptions,...n};let{texture:r,anchor:i,tilePosition:a,tileScale:o,tileRotation:s,width:c,height:l,applyAnchorToTexture:u,roundPixels:d,...f}=n??{};super({label:`TilingSprite`,...f}),this.renderPipeId=`tilingSprite`,this.batched=!0,this.allowChildren=!1,this._anchor=new P({_onUpdate:()=>{this.onViewUpdate()}}),this.applyAnchorToTexture=u,this.texture=r,this._width=c??r.width,this._height=l??r.height,this._tileTransform=new ff({observer:{_onUpdate:()=>this.onViewUpdate()}}),i&&(this.anchor=i),this.tilePosition=a,this.tileScale=o,this.tileRotation=s,this.roundPixels=d??!1}static from(t,n={}){return typeof t==`string`?new e({texture:G.get(t),...n}):new e({texture:t,...n})}get uvRespectAnchor(){return F(H,`uvRespectAnchor is deprecated, please use applyAnchorToTexture instead`),this.applyAnchorToTexture}set uvRespectAnchor(e){F(H,`uvRespectAnchor is deprecated, please use applyAnchorToTexture instead`),this.applyAnchorToTexture=e}get clampMargin(){return this._texture.textureMatrix.clampMargin}set clampMargin(e){this._texture.textureMatrix.clampMargin=e}get anchor(){return this._anchor}set anchor(e){typeof e==`number`?this._anchor.set(e):this._anchor.copyFrom(e)}get tilePosition(){return this._tileTransform.position}set tilePosition(e){this._tileTransform.position.copyFrom(e)}get tileScale(){return this._tileTransform.scale}set tileScale(e){typeof e==`number`?this._tileTransform.scale.set(e):this._tileTransform.scale.copyFrom(e)}set tileRotation(e){this._tileTransform.rotation=e}get tileRotation(){return this._tileTransform.rotation}get tileTransform(){return this._tileTransform}set texture(e){e||=W.EMPTY;let t=this._texture;t!==e&&(t&&t.dynamic&&t.off(`update`,this.onViewUpdate,this),e.dynamic&&e.on(`update`,this.onViewUpdate,this),this._texture=e,this.onViewUpdate())}get texture(){return this._texture}set width(e){this._width=e,this.onViewUpdate()}get width(){return this._width}set height(e){this._height=e,this.onViewUpdate()}get height(){return this._height}setSize(e,t){typeof e==`object`&&(t=e.height??e.width,e=e.width),this._width=e,this._height=t??e,this.onViewUpdate()}getSize(e){return e||={},e.width=this._width,e.height=this._height,e}updateBounds(){let e=this._bounds,t=this._anchor,n=this._width,r=this._height;e.minX=-t._x*n,e.maxX=e.minX+n,e.minY=-t._y*r,e.maxY=e.minY+r}containsPoint(e){let t=this._width,n=this._height,r=-t*this._anchor._x,i=0;return e.x>=r&&e.x<=r+t&&(i=-n*this._anchor._y,e.y>=i&&e.y<=i+n)}destroy(e=!1){if(super.destroy(e),this._anchor=null,this._tileTransform=null,this._bounds=null,typeof e==`boolean`?e:e?.texture){let t=typeof e==`boolean`?e:e?.textureSource;this._texture.destroy(t)}this._texture=null}};pf.defaultOptions={texture:W.EMPTY,anchor:{x:0,y:0},tilePosition:{x:0,y:0},tileScale:{x:1,y:1},tileRotation:0,applyAnchorToTexture:!1};var mf=pf,hf=class extends g{constructor(e,t){let{text:n,resolution:r,style:i,anchor:a,width:o,height:s,roundPixels:c,...l}=e;super({...l}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=t,this.text=n??``,this.style=i,this.resolution=r??null,this.allowChildren=!1,this._anchor=new P({_onUpdate:()=>{this.onViewUpdate()}}),a&&(this.anchor=a),this.roundPixels=c??!1,o!==void 0&&(this.width=o),s!==void 0&&(this.height=s)}get anchor(){return this._anchor}set anchor(e){typeof e==`number`?this._anchor.set(e):this._anchor.copyFrom(e)}set text(e){e=e.toString(),this._text!==e&&(this._text=e,this.onViewUpdate())}get text(){return this._text}set resolution(e){this._autoResolution=e===null,this._resolution=e,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(e){e||={},this._style?.off(`update`,this.onViewUpdate,this),e instanceof this._styleClass?this._style=e:this._style=new this._styleClass(e),this._style.on(`update`,this.onViewUpdate,this),this.onViewUpdate()}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(e){this._setWidth(e,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(e){this._setHeight(e,this.bounds.height)}getSize(e){return e||={},e.width=Math.abs(this.scale.x)*this.bounds.width,e.height=Math.abs(this.scale.y)*this.bounds.height,e}setSize(e,t){typeof e==`object`?(t=e.height??e.width,e=e.width):t??=e,e!==void 0&&this._setWidth(e,this.bounds.width),t!==void 0&&this._setHeight(t,this.bounds.height)}containsPoint(e){let t=this.bounds.width,n=this.bounds.height,r=-t*this.anchor.x,i=0;return e.x>=r&&e.x<=r+t&&(i=-n*this.anchor.y,e.y>=i&&e.y<=i+n)}onViewUpdate(){this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}destroy(e=!1){super.destroy(e),this.owner=null,this._bounds=null,this._anchor=null,(typeof e==`boolean`?e:e?.style)&&this._style.destroy(e),this._style=null,this._text=null}get styleKey(){return`${this._text}:${this._style.styleKey}:${this._resolution}`}};function gf(e,t){let n=e[0]??{};return(typeof n==`string`||e[1])&&(F(H,`use new ${t}({ text: "hi!", style }) instead`),n={text:n,style:e[1]}),n}var _f=class extends hf{constructor(...e){let t=gf(e,`Text`);super(t,Ci),this.renderPipeId=`text`,t.textureStyle&&(this.textureStyle=t.textureStyle instanceof S?t.textureStyle:new S(t.textureStyle))}updateBounds(){let e=this._bounds,t=this._anchor,n=0,r=0;if(this._style.trim){let{frame:e,canvasAndContext:t}=Or.getCanvasAndContext({text:this.text,style:this._style,resolution:1});Or.returnCanvasAndContext(t),n=e.width,r=e.height}else{let e=ur.measureText(this._text,this._style);n=e.width,r=e.height}e.minX=-t._x*n,e.maxX=e.minX+n,e.minY=-t._y*r,e.maxY=e.minY+r}},vf=class extends lf{resolveQueueItem(e,t){return e instanceof i?this.resolveContainerQueueItem(e,t):e instanceof Ee||e instanceof W?t.push(e.source):e instanceof Pi&&t.push(e),null}resolveContainerQueueItem(e,t){e instanceof _e||e instanceof mf||e instanceof uf?t.push(e.texture.source):e instanceof _f?t.push(e):e instanceof Gn?t.push(e.context):e instanceof df&&e.textures.forEach(e=>{e.source?t.push(e.source):t.push(e.texture.source)})}resolveGraphicsContextQueueItem(e){this.renderer.graphicsContext.getGpuContext(e);let{instructions:t}=e;for(let e of t)if(e.action===`texture`){let{image:t}=e.data;return t.source}else if(e.action===`fill`){let{texture:t}=e.data.style;return t.source}return null}},yf=class extends hf{constructor(...e){var t;let n=gf(e,`BitmapText`);n.style??=n.style||{},(t=n.style).fill??(t.fill=16777215),super(n,Ci),this.renderPipeId=`bitmapText`}updateBounds(){let e=this._bounds,t=this._anchor,n=fr.measureText(this.text,this._style),r=n.scale,i=n.offsetY*r,a=n.width*r,o=n.height*r,s=this._style._stroke;s&&(a+=s.width,o+=s.width),e.minX=-t._x*a,e.maxX=e.minX+a,e.minY=-t._y*(o+i),e.maxY=e.minY+o}set resolution(e){e!==null&&f(`[BitmapText] dynamically updating the resolution is not supported. Resolution should be managed by the BitmapFont.`)}get resolution(){return this._resolution}};function bf(e){let t=e._stroke,n=e._fill,r=[`div { ${[`color: ${o.shared.setValue(n.color).toHex()}`,`font-size: ${e.fontSize}px`,`font-family: ${e.fontFamily}`,`font-weight: ${e.fontWeight}`,`font-style: ${e.fontStyle}`,`font-variant: ${e.fontVariant}`,`letter-spacing: ${e.letterSpacing}px`,`text-align: ${e.align}`,`padding: ${e.padding}px`,`white-space: ${e.whiteSpace===`pre`&&e.wordWrap?`pre-wrap`:e.whiteSpace}`,...e.lineHeight?[`line-height: ${e.lineHeight}px`]:[],...e.wordWrap?[`word-wrap: ${e.breakWords?`break-all`:`break-word`}`,`max-width: ${e.wordWrapWidth}px`]:[],...t?[Sf(t)]:[],...e.dropShadow?[xf(e.dropShadow)]:[],...e.cssOverrides].join(`;`)} }`];return Tf(e.tagStyles,r),r.join(` `)}function xf(e){let t=o.shared.setValue(e.color).setAlpha(e.alpha).toHexa(),n=`${Math.round(Math.cos(e.angle)*e.distance)}px ${Math.round(Math.sin(e.angle)*e.distance)}px`;return e.blur>0?`text-shadow: ${n} ${e.blur}px ${t}`:`text-shadow: ${n} ${t}`}function Sf(e){return[`-webkit-text-stroke-width: ${e.width}px`,`-webkit-text-stroke-color: ${o.shared.setValue(e.color).toHex()}`,`text-stroke-width: ${e.width}px`,`text-stroke-color: ${o.shared.setValue(e.color).toHex()}`,`paint-order: stroke`].join(`;`)}var Cf={fontSize:`font-size: {{VALUE}}px`,fontFamily:`font-family: {{VALUE}}`,fontWeight:`font-weight: {{VALUE}}`,fontStyle:`font-style: {{VALUE}}`,fontVariant:`font-variant: {{VALUE}}`,letterSpacing:`letter-spacing: {{VALUE}}px`,align:`text-align: {{VALUE}}`,padding:`padding: {{VALUE}}px`,whiteSpace:`white-space: {{VALUE}}`,lineHeight:`line-height: {{VALUE}}px`,wordWrapWidth:`max-width: {{VALUE}}px`},wf={fill:e=>`color: ${o.shared.setValue(e).toHex()}`,breakWords:e=>`word-wrap: ${e?`break-all`:`break-word`}`,stroke:Sf,dropShadow:xf};function Tf(e,t){for(let n in e){let r=e[n],i=[];for(let e in r)wf[e]?i.push(wf[e](r[e])):Cf[e]&&i.push(Cf[e].replace(`{{VALUE}}`,r[e]));t.push(`${n} { ${i.join(`;`)} }`)}}var Ef=class e extends Ci{constructor(e={}){super(e),this._cssOverrides=[],this.cssOverrides=e.cssOverrides??[],this.tagStyles=e.tagStyles??{}}set cssOverrides(e){this._cssOverrides=e instanceof Array?e:[e],this.update()}get cssOverrides(){return this._cssOverrides}update(){this._cssStyle=null,super.update()}clone(){return new e({align:this.align,breakWords:this.breakWords,dropShadow:this.dropShadow?{...this.dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,cssOverrides:this.cssOverrides,tagStyles:{...this.tagStyles}})}get cssStyle(){return this._cssStyle||=bf(this),this._cssStyle}addOverride(...e){let t=e.filter(e=>!this.cssOverrides.includes(e));t.length>0&&(this.cssOverrides.push(...t),this.update())}removeOverride(...e){let t=e.filter(e=>this.cssOverrides.includes(e));t.length>0&&(this.cssOverrides=this.cssOverrides.filter(e=>!t.includes(e)),this.update())}set fill(e){typeof e!=`string`&&typeof e!=`number`&&f(`[HTMLTextStyle] only color fill is not supported by HTMLText`),super.fill=e}set stroke(e){e&&typeof e!=`string`&&typeof e!=`number`&&f(`[HTMLTextStyle] only color stroke is not supported by HTMLText`),super.stroke=e}},Df=class extends hf{constructor(...e){let t=gf(e,`HtmlText`);super(t,Ef),this.renderPipeId=`htmlText`,t.textureStyle&&(this.textureStyle=t.textureStyle instanceof S?t.textureStyle:new S(t.textureStyle))}updateBounds(){let e=this._bounds,t=this._anchor,{width:n,height:r}=wn(this.text,this._style);e.minX=-t._x*n,e.maxX=e.minX+n,e.minY=-t._y*r,e.maxY=e.minY+r}get text(){return this._text}set text(e){super.text=this._sanitiseText(e.toString())}_sanitiseText(e){return this._removeInvalidHtmlTags(e.replace(/<br>/gi,`<br/>`).replace(/<hr>/gi,`<hr/>`).replace(/&nbsp;/gi,`&#160;`))}_removeInvalidHtmlTags(e){return e.replace(/<[^>]*?(?=<|$)/g,``)}},Of=class extends vf{uploadQueueItem(e){e instanceof Ee?this.uploadTextureSource(e):e instanceof _f?this.uploadText(e):e instanceof Df?this.uploadHTMLText(e):e instanceof yf?this.uploadBitmapText(e):e instanceof Pi&&this.uploadGraphicsContext(e)}uploadTextureSource(e){this.renderer.texture.initSource(e)}uploadText(e){this.renderer.renderPipes.text.initGpuText(e)}uploadBitmapText(e){this.renderer.renderPipes.bitmapText.initGpuText(e)}uploadHTMLText(e){this.renderer.renderPipes.htmlText.initGpuText(e)}uploadGraphicsContext(e){this.renderer.graphicsContext.getGpuContext(e);let{instructions:t}=e;for(let e of t)if(e.action===`texture`){let{image:t}=e.data;this.uploadTextureSource(t.source)}else if(e.action===`fill`){let{texture:t}=e.data.style;this.uploadTextureSource(t.source)}return null}},kf=class extends Of{destroy(){super.destroy(),clearTimeout(this.timeout),this.renderer=null,this.queue=null,this.resolves=null}};kf.extension={type:[C.WebGLSystem,C.WebGPUSystem],name:`prepare`};function Af(e){let t=[],n=0;for(let r=0;r<e;r++)t[n]={texture:{sampleType:`float`,viewDimension:`2d`,multisampled:!1},binding:n,visibility:GPUShaderStage.FRAGMENT},n++,t[n]={sampler:{type:`filtering`},binding:n,visibility:GPUShaderStage.FRAGMENT},n++;return t}function jf(e){let t={},n=0;for(let r=0;r<e;r++)t[`textureSource${r+1}`]=n++,t[`textureSampler${r+1}`]=n++;return t}function Mf(e){let t=e.split(/([\n{}])/g).map(e=>e.trim()).filter(e=>e.length),n=``;return t.map(e=>{let t=n+e;return e===`{`?n+=`    `:e===`}`&&(n=n.substr(0,n.length-4),t=n+e),t}).join(`
`)}var Nf=class{constructor(e){this.priority=0,this.pipe=`scissorMask`,this.mask=e,this.mask.renderable=!1,this.mask.measurable=!1}addBounds(e,t){nr(this.mask,e,t)}addLocalBounds(e,t){$n(this.mask,e,t)}containsPoint(e,t){let n=this.mask;return t(n,e)}reset(){this.mask!==null&&(this.mask.measurable=!0,this.mask=null)}destroy(){this.reset()}};function Pf(e){return e=e.replaceAll(`texture2D`,`texture`).replaceAll(`gl_FragColor`,`finalColor`).replaceAll(`varying`,`in`),e=`
        out vec4 finalColor;
    ${e}
    `,e}var Ff={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function If(e){return Ff[e]}var Lf={POINTS:`point-list`,LINES:`line-list`,LINE_STRIP:`line-strip`,TRIANGLES:`triangle-list`,TRIANGLE_STRIP:`triangle-strip`},Rf=new Proxy(Lf,{get(e,t){return F(H,`DRAW_MODES.${t} is deprecated, use '${Lf[t]}' instead`),e[t]}}),zf=(e=>(e.CLAMP=`clamp-to-edge`,e.REPEAT=`repeat`,e.MIRRORED_REPEAT=`mirror-repeat`,e))(zf||{}),Bf=new Proxy(zf,{get(e,t){return F(H,`DRAW_MODES.${t} is deprecated, use '${zf[t]}' instead`),e[t]}}),Vf=(e=>(e.NEAREST=`nearest`,e.LINEAR=`linear`,e))(Vf||{}),Hf=new Proxy(Vf,{get(e,t){return F(H,`DRAW_MODES.${t} is deprecated, use '${Vf[t]}' instead`),e[t]}}),Uf=class{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,t,n){let r=t.width,i=t.height;if(n){let t=e.width/2/r,a=e.height/2/i,o=e.x/r+t,s=e.y/i+a;n=z.add(n,z.NW),this.x0=o+t*z.uX(n),this.y0=s+a*z.uY(n),n=z.add(n,2),this.x1=o+t*z.uX(n),this.y1=s+a*z.uY(n),n=z.add(n,2),this.x2=o+t*z.uX(n),this.y2=s+a*z.uY(n),n=z.add(n,2),this.x3=o+t*z.uX(n),this.y3=s+a*z.uY(n)}else this.x0=e.x/r,this.y0=e.y/i,this.x1=(e.x+e.width)/r,this.y1=e.y/i,this.x2=(e.x+e.width)/r,this.y2=(e.y+e.height)/i,this.x3=e.x/r,this.y3=(e.y+e.height)/i;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[pixi.js/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}};function Wf(e){let t=e.toString(),n=t.indexOf(`{`),r=t.lastIndexOf(`}`);if(n===-1||r===-1)throw Error(`getFunctionBody: No body found in function definition`);return t.slice(n+1,r).trim()}function Gf(e,t){return F(`8.7.0`,`Use container.getFastGlobalBounds() instead`),e.getFastGlobalBounds(!0,t)}var Kf=class extends g{constructor(e){typeof e==`function`&&(e={render:e});let{render:t,...n}=e;super({label:`RenderContainer`,...n}),this.renderPipeId=`customRender`,this.batched=!1,t&&(this.render=t),this.containsPoint=e.containsPoint??(()=>!1),this.addBounds=e.addBounds??(()=>!1)}updateBounds(){this._bounds.clear(),this.addBounds(this._bounds)}render(e){}};function qf(e,t,n){F(`8.7.0`,`Please use container.collectRenderables instead.`);let r=n.renderPipes?n:n.batch.renderer;return e.collectRenderables(t,r,null)}function Jf(e,t){let n=t._scale,r=t._pivot,i=t._position,a=n._x,o=n._y,s=r._x,c=r._y;e.a=t._cx*a,e.b=t._sx*a,e.c=t._cy*o,e.d=t._sy*o,e.tx=i._x-(s*e.a+c*e.c),e.ty=i._y-(s*e.b+c*e.d)}function Yf(e,t,n){let r=e.a,i=e.b,a=e.c,o=e.d,s=e.tx,c=e.ty,l=t.a,u=t.b,d=t.c,f=t.d;n.a=r*l+i*d,n.b=r*u+i*f,n.c=a*l+o*d,n.d=a*u+o*f,n.tx=s*l+c*d+t.tx,n.ty=s*u+c*f+t.ty}function Xf(e){e instanceof Ir&&(e={path:e,textureMatrix:null,out:null});let t=[],n=[],r=[],i=e.path.shapePath,a=e.textureMatrix;i.shapePrimitives.forEach(({shape:e,transform:i})=>{let o=r.length,s=t.length/2,c=[],l=Ni[e.type];l.build(e,c),i&&ea(c,i),l.triangulate(c,t,2,s,r,o);let u=n.length/2;a?(i&&a.append(i.clone().invert()),Zi(t,2,s,n,u,2,t.length/2-s,a)):Vr(n,u,2,t.length/2-s)});let o=e.out;return o?(o.positions=new Float32Array(t),o.uvs=new Float32Array(n),o.indices=new Uint32Array(r),o):new Xi({positions:new Float32Array(t),uvs:new Float32Array(n),indices:new Uint32Array(r)})}var Zf=class e extends i{constructor(t={}){t={...e.defaultOptions,...t},super(),this.renderLayerChildren=[],this.sortableChildren=t.sortableChildren,this.sortFunction=t.sortFunction}attach(...e){for(let t=0;t<e.length;t++){let n=e[t];if(n.parentRenderLayer){if(n.parentRenderLayer===this)continue;n.parentRenderLayer.detach(n)}this.renderLayerChildren.push(n),n.parentRenderLayer=this;let r=this.renderGroup||this.parentRenderGroup;r&&(r.structureDidChange=!0)}return e[0]}detach(...e){for(let t=0;t<e.length;t++){let n=e[t],r=this.renderLayerChildren.indexOf(n);r!==-1&&this.renderLayerChildren.splice(r,1),n.parentRenderLayer=null;let i=this.renderGroup||this.parentRenderGroup;i&&(i.structureDidChange=!0)}return e[0]}detachAll(){let e=this.renderLayerChildren;for(let t=0;t<e.length;t++)e[t].parentRenderLayer=null;this.renderLayerChildren.length=0}collectRenderables(e,t,n){let r=this.renderLayerChildren,i=r.length;this.sortableChildren&&this.sortRenderLayerChildren();for(let n=0;n<i;n++)r[n].parent||f(`Container must be added to both layer and scene graph. Layers only handle render order - the scene graph is required for transforms (addChild)`,r[n]),r[n].collectRenderables(e,t,this)}sortRenderLayerChildren(){this.renderLayerChildren.sort(this.sortFunction)}_getGlobalBoundsRecursive(e,t,n){if(!e)return;let r=this.renderLayerChildren;for(let e=0;e<r.length;e++)r[e]._getGlobalBoundsRecursive(!0,t,this)}getFastGlobalBounds(e,t){return super.getFastGlobalBounds(e,t)}addChild(...e){throw Error(`RenderLayer.addChild() is not available. Please use RenderLayer.attach()`)}removeChild(...e){throw Error(`RenderLayer.removeChild() is not available. Please use RenderLayer.detach()`)}removeChildren(e,t){throw Error(`RenderLayer.removeChildren() is not available. Please use RenderLayer.detach()`)}removeChildAt(e){throw Error(`RenderLayer.removeChildAt() is not available`)}getChildAt(e){throw Error(`RenderLayer.getChildAt() is not available`)}setChildIndex(e,t){throw Error(`RenderLayer.setChildIndex() is not available`)}getChildIndex(e){throw Error(`RenderLayer.getChildIndex() is not available`)}addChildAt(e,t){throw Error(`RenderLayer.addChildAt() is not available`)}swapChildren(e,t){throw Error(`RenderLayer.swapChildren() is not available`)}reparentChild(...e){throw Error(`RenderLayer.reparentChild() is not available with the render layer`)}reparentChildAt(e,t){throw Error(`RenderLayer.reparentChildAt() is not available with the render layer`)}};Zf.defaultOptions={sortableChildren:!1,sortFunction:(e,t)=>e.zIndex-t.zIndex};var Qf=Zf;function $f(e,t,n,r){let i=n.buffers[0],a=i.data,{verticesX:o,verticesY:s}=n,c=e/(o-1),l=t/(s-1),u=0,d=r[0],f=r[1],p=r[2],m=r[3],h=r[4],g=r[5],_=r[6],v=r[7],y=r[8];for(let e=0;e<a.length;e+=2){let t=u%o*c,n=(u/o|0)*l,r=d*t+f*n+p,i=m*t+h*n+g,s=_*t+v*n+y;a[e]=r/s,a[e+1]=i/s,u++}i.update()}function ep(e,t){let n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],l=t[7],u=t[8];return e[0]=o*u-s*l,e[1]=i*l-r*u,e[2]=r*s-i*o,e[3]=s*c-a*u,e[4]=n*u-i*c,e[5]=i*a-n*s,e[6]=a*l-o*c,e[7]=r*c-n*l,e[8]=n*o-r*a,e}function tp(e,t,n){let r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],l=t[6],u=t[7],d=t[8],f=n[0],p=n[1],m=n[2],h=n[3],g=n[4],_=n[5],v=n[6],y=n[7],b=n[8];return e[0]=f*r+p*o+m*l,e[1]=f*i+p*s+m*u,e[2]=f*a+p*c+m*d,e[3]=h*r+g*o+_*l,e[4]=h*i+g*s+_*u,e[5]=h*a+g*c+_*d,e[6]=v*r+y*o+b*l,e[7]=v*i+y*s+b*u,e[8]=v*a+y*c+b*d,e}function np(e,t,n){let r=n[0],i=n[1],a=n[2];return e[0]=t[0]*r+t[1]*i+t[2]*a,e[1]=t[3]*r+t[4]*i+t[5]*a,e[2]=t[6]*r+t[7]*i+t[8]*a,e}var rp=[0,0,0,0,0,0,0,0,0],ip=[0,0,0],ap=[0,0,0];function op(e,t,n,r,i,a,o,s,c){let l=rp;l[0]=t,l[1]=r,l[2]=a,l[3]=n,l[4]=i,l[5]=o,l[6]=1,l[7]=1,l[8]=1;let u=ep(e,l);ap[0]=s,ap[1]=c,ap[2]=1;let d=np(ip,u,ap),f=e;return e[0]=d[0],e[1]=0,e[2]=0,e[3]=0,e[4]=d[1],e[5]=0,e[6]=0,e[7]=0,e[8]=d[2],tp(e,f,l)}var sp=[0,0,0,0,0,0,0,0,0],cp=[0,0,0,0,0,0,0,0,0];function lp(e,t,n,r,i,a,o,s,c,l,u,d,f,p,m,h,g){let _=op(sp,t,n,a,o,l,u,p,m),v=op(cp,r,i,s,c,d,f,h,g);return tp(e,ep(_,_),v)}var up=class extends Kr{constructor(e){super(e),this._projectionMatrix=[0,0,0,0,0,0,0,0,0];let{width:t,height:n}=e;this.corners=[0,0,t,0,t,n,0,n]}setCorners(e,t,n,r,i,a,o,s){let c=this.corners;c[0]=e,c[1]=t,c[2]=n,c[3]=r,c[4]=i,c[5]=a,c[6]=o,c[7]=s,this.updateProjection()}updateProjection(){let{width:e,height:t}=this,n=this.corners,r=lp(this._projectionMatrix,0,0,n[0],n[1],e,0,n[2],n[3],e,t,n[4],n[5],0,t,n[6],n[7]);$f(e,t,this,r)}},dp=class e extends uf{constructor(t){t={...e.defaultOptions,...t};let{texture:n,verticesX:r,verticesY:i,...a}=t,o=new up(j({width:n.width,height:n.height,verticesX:r,verticesY:i}));super(j({...a,geometry:o})),this._texture=n,this.geometry.setCorners(t.x0,t.y0,t.x1,t.y1,t.x2,t.y2,t.x3,t.y3)}textureUpdated(){let e=this.geometry;if(!e)return;let{width:t,height:n}=this.texture;(e.width!==t||e.height!==n)&&(e.width=t,e.height=n,e.updateProjection())}set texture(e){this._texture!==e&&(super.texture=e,this.textureUpdated())}get texture(){return this._texture}setCorners(e,t,n,r,i,a,o,s){this.geometry.setCorners(e,t,n,r,i,a,o,s)}};dp.defaultOptions={texture:W.WHITE,verticesX:10,verticesY:10,x0:0,y0:0,x1:100,y1:0,x2:100,y2:100,x3:0,y3:100};var fp=dp,pp=class extends uf{constructor(e){let{texture:t,verticesX:n,verticesY:r,...i}=e,a=new Kr(j({width:t.width,height:t.height,verticesX:n,verticesY:r}));super(j({...i,geometry:a,texture:t})),this.texture=t,this.autoResize=!0}textureUpdated(){let e=this.geometry,{width:t,height:n}=this.texture;this.autoResize&&(e.width!==t||e.height!==n)&&(e.width=t,e.height=n,e.build({}))}set texture(e){this._texture?.off(`update`,this.textureUpdated,this),super.texture=e,e.on(`update`,this.textureUpdated,this),this.textureUpdated()}get texture(){return this._texture}destroy(e){this.texture.off(`update`,this.textureUpdated,this),super.destroy(e)}},mp=class e extends Xi{constructor(t){let{width:n,points:r,textureScale:i}={...e.defaultOptions,...t};super({positions:new Float32Array(r.length*4),uvs:new Float32Array(r.length*4),indices:new Uint32Array((r.length-1)*6)}),this.points=r,this._width=n,this.textureScale=i,this._build()}get width(){return this._width}_build(){let e=this.points;if(!e)return;let t=this.getBuffer(`aPosition`),n=this.getBuffer(`aUV`),r=this.getIndex();if(e.length<1)return;t.data.length/4!==e.length&&(t.data=new Float32Array(e.length*4),n.data=new Float32Array(e.length*4),r.data=new Uint16Array((e.length-1)*6));let i=n.data,a=r.data;i[0]=0,i[1]=0,i[2]=0,i[3]=1;let o=0,s=e[0],c=this._width*this.textureScale,l=e.length;for(let t=0;t<l;t++){let n=t*4;if(this.textureScale>0){let n=s.x-e[t].x,r=s.y-e[t].y,i=Math.sqrt(n*n+r*r);s=e[t],o+=i/c}else o=t/(l-1);i[n]=o,i[n+1]=0,i[n+2]=o,i[n+3]=1}let u=0;for(let e=0;e<l-1;e++){let t=e*2;a[u++]=t,a[u++]=t+1,a[u++]=t+2,a[u++]=t+2,a[u++]=t+1,a[u++]=t+3}n.update(),r.update(),this.updateVertices()}updateVertices(){let e=this.points;if(e.length<1)return;let t=e[0],n,r=0,i=0,a=this.buffers[0].data,o=e.length,s=this.textureScale>0?this.textureScale*this._width/2:this._width/2;for(let c=0;c<o;c++){let l=e[c],u=c*4;n=c<e.length-1?e[c+1]:l,i=-(n.x-t.x),r=n.y-t.y;let d=(1-c/(o-1))*10;d>1&&(d=1);let f=Math.sqrt(r*r+i*i);f<1e-6?(r=0,i=0):(r/=f,i/=f,r*=s,i*=s),a[u]=l.x+r,a[u+1]=l.y+i,a[u+2]=l.x-r,a[u+3]=l.y-i,t=l}this.buffers[0].update()}update(){this.textureScale>0?this._build():this.updateVertices()}};mp.defaultOptions={width:200,points:[],textureScale:0};var hp=mp,gp=class e extends uf{constructor(t){let{texture:n,points:r,textureScale:i,...a}={...e.defaultOptions,...t},o=new hp(j({width:n.height,points:r,textureScale:i}));i>0&&(n.source.style.addressMode=`repeat`),super(j({...a,texture:n,geometry:o})),this.autoUpdate=!0,this.onRender=this._render}_render(){let e=this.geometry;(this.autoUpdate||e._width!==this.texture.height)&&(e._width=this.texture.height,e.update())}};gp.defaultOptions={textureScale:0};var _p=gp,vp=class extends uf{constructor(e){let{texture:t,vertices:n,uvs:r,indices:i,topology:a,...o}=e,s=new Xi(j({positions:n,uvs:r,indices:i,topology:a}));super(j({...o,texture:t,geometry:s})),this.autoUpdate=!0,this.onRender=this._render}get vertices(){return this.geometry.getBuffer(`aPosition`).data}set vertices(e){this.geometry.getBuffer(`aPosition`).data=e}_render(){this.autoUpdate&&this.geometry.getBuffer(`aPosition`).update()}};function yp(e,t){let{width:n,height:r}=e.frame;return t.scale(1/n,1/r),t}var bp=class e{constructor(t){if(t instanceof W)this.texture=t,y(this,e.defaultOptions,{});else{let n={...e.defaultOptions,...t};y(this,n,{})}}get alpha(){return this._alpha}set alpha(e){this._alpha=Math.min(Math.max(e,0),1),this._updateColor()}get tint(){return At(this._tint)}set tint(e){this._tint=o.shared.setValue(e??16777215).toBgrNumber(),this._updateColor()}_updateColor(){this.color=this._tint+((this._alpha*255|0)<<24)}};bp.defaultOptions={anchorX:0,anchorY:0,x:0,y:0,scaleX:1,scaleY:1,rotation:0,tint:16777215,alpha:1};var xp=bp,Sp={vertex:{attributeName:`aVertex`,format:`float32x2`,code:`
            const texture = p.texture;
            const sx = p.scaleX;
            const sy = p.scaleY;
            const ax = p.anchorX;
            const ay = p.anchorY;
            const trim = texture.trim;
            const orig = texture.orig;

            if (trim)
            {
                w1 = trim.x - (ax * orig.width);
                w0 = w1 + trim.width;

                h1 = trim.y - (ay * orig.height);
                h0 = h1 + trim.height;
            }
            else
            {
                w1 = -ax * (orig.width);
                w0 = w1 + orig.width;

                h1 = -ay * (orig.height);
                h0 = h1 + orig.height;
            }

            f32v[offset] = w1 * sx;
            f32v[offset + 1] = h1 * sy;

            f32v[offset + stride] = w0 * sx;
            f32v[offset + stride + 1] = h1 * sy;

            f32v[offset + (stride * 2)] = w0 * sx;
            f32v[offset + (stride * 2) + 1] = h0 * sy;

            f32v[offset + (stride * 3)] = w1 * sx;
            f32v[offset + (stride * 3) + 1] = h0 * sy;
        `,dynamic:!1},position:{attributeName:`aPosition`,format:`float32x2`,code:`
            var x = p.x;
            var y = p.y;

            f32v[offset] = x;
            f32v[offset + 1] = y;

            f32v[offset + stride] = x;
            f32v[offset + stride + 1] = y;

            f32v[offset + (stride * 2)] = x;
            f32v[offset + (stride * 2) + 1] = y;

            f32v[offset + (stride * 3)] = x;
            f32v[offset + (stride * 3) + 1] = y;
        `,dynamic:!0},rotation:{attributeName:`aRotation`,format:`float32`,code:`
            var rotation = p.rotation;

            f32v[offset] = rotation;
            f32v[offset + stride] = rotation;
            f32v[offset + (stride * 2)] = rotation;
            f32v[offset + (stride * 3)] = rotation;
        `,dynamic:!1},uvs:{attributeName:`aUV`,format:`float32x2`,code:`
            var uvs = p.texture.uvs;

            f32v[offset] = uvs.x0;
            f32v[offset + 1] = uvs.y0;

            f32v[offset + stride] = uvs.x1;
            f32v[offset + stride + 1] = uvs.y1;

            f32v[offset + (stride * 2)] = uvs.x2;
            f32v[offset + (stride * 2) + 1] = uvs.y2;

            f32v[offset + (stride * 3)] = uvs.x3;
            f32v[offset + (stride * 3) + 1] = uvs.y3;
        `,dynamic:!1},color:{attributeName:`aColor`,format:`unorm8x4`,code:`
            const c = p.color;

            u32v[offset] = c;
            u32v[offset + stride] = c;
            u32v[offset + (stride * 2)] = c;
            u32v[offset + (stride * 3)] = c;
        `,dynamic:!1}},Cp=new Xe(0,0,0,0),wp=class e extends g{constructor(t={}){t={...e.defaultOptions,...t,dynamicProperties:{...e.defaultOptions.dynamicProperties,...t?.dynamicProperties}};let{dynamicProperties:n,shader:r,roundPixels:i,texture:a,particles:o,...s}=t;for(let e in super({label:`ParticleContainer`,...s}),this.renderPipeId=`particle`,this.batched=!1,this._childrenDirty=!1,this.texture=a||null,this.shader=r,this._properties={},Sp){let t=Sp[e],r=n[e];this._properties[e]={...t,dynamic:r}}this.allowChildren=!0,this.roundPixels=i??!1,this.particleChildren=o??[]}addParticle(...e){for(let t=0;t<e.length;t++)this.particleChildren.push(e[t]);return this.onViewUpdate(),e[0]}removeParticle(...e){let t=!1;for(let n=0;n<e.length;n++){let r=this.particleChildren.indexOf(e[n]);r>-1&&(this.particleChildren.splice(r,1),t=!0)}return t&&this.onViewUpdate(),e[0]}update(){this._childrenDirty=!0}onViewUpdate(){this._childrenDirty=!0,super.onViewUpdate()}get bounds(){return Cp}updateBounds(){}destroy(e=!1){if(super.destroy(e),typeof e==`boolean`?e:e?.texture){let t=typeof e==`boolean`?e:e?.textureSource,n=this.texture??this.particleChildren[0]?.texture;n&&n.destroy(t)}this.texture=null,this.shader?.destroy()}removeParticles(e,t){e??=0,t??=this.particleChildren.length;let n=this.particleChildren.splice(e,t-e);return this.onViewUpdate(),n}removeParticleAt(e){let t=this.particleChildren.splice(e,1);return this.onViewUpdate(),t[0]}addParticleAt(e,t){return this.particleChildren.splice(t,0,e),this.onViewUpdate(),e}addChild(...e){throw Error(`ParticleContainer.addChild() is not available. Please use ParticleContainer.addParticle()`)}removeChild(...e){throw Error(`ParticleContainer.removeChild() is not available. Please use ParticleContainer.removeParticle()`)}removeChildren(e,t){throw Error(`ParticleContainer.removeChildren() is not available. Please use ParticleContainer.removeParticles()`)}removeChildAt(e){throw Error(`ParticleContainer.removeChildAt() is not available. Please use ParticleContainer.removeParticleAt()`)}getChildAt(e){throw Error(`ParticleContainer.getChildAt() is not available. Please use ParticleContainer.getParticleAt()`)}setChildIndex(e,t){throw Error(`ParticleContainer.setChildIndex() is not available. Please use ParticleContainer.setParticleIndex()`)}getChildIndex(e){throw Error(`ParticleContainer.getChildIndex() is not available. Please use ParticleContainer.getParticleIndex()`)}addChildAt(e,t){throw Error(`ParticleContainer.addChildAt() is not available. Please use ParticleContainer.addParticleAt()`)}swapChildren(e,t){throw Error(`ParticleContainer.swapChildren() is not available. Please use ParticleContainer.swapParticles()`)}reparentChild(...e){throw Error(`ParticleContainer.reparentChild() is not available with the particle container`)}reparentChildAt(e,t){throw Error(`ParticleContainer.reparentChildAt() is not available with the particle container`)}};wp.defaultOptions={dynamicProperties:{vertex:!1,position:!0,rotation:!1,uvs:!1,color:!1},roundPixels:!1};var Tp=wp,Ep=class e extends g{constructor(t){t instanceof W&&(t={texture:t});let{width:n,height:r,anchor:i,leftWidth:a,rightWidth:o,topHeight:s,bottomHeight:c,texture:l,roundPixels:u,...d}=t;super({label:`NineSliceSprite`,...d}),this.renderPipeId=`nineSliceSprite`,this.batched=!0,this._leftWidth=a??l?.defaultBorders?.left??Vi.defaultOptions.leftWidth,this._topHeight=s??l?.defaultBorders?.top??Vi.defaultOptions.topHeight,this._rightWidth=o??l?.defaultBorders?.right??Vi.defaultOptions.rightWidth,this._bottomHeight=c??l?.defaultBorders?.bottom??Vi.defaultOptions.bottomHeight,this._width=n??l.width??Vi.defaultOptions.width,this._height=r??l.height??Vi.defaultOptions.height,this.allowChildren=!1,this.texture=l??e.defaultOptions.texture,this.roundPixels=u??!1,this._anchor=new P({_onUpdate:()=>{this.onViewUpdate()}}),i?this.anchor=i:this.texture.defaultAnchor&&(this.anchor=this.texture.defaultAnchor)}get anchor(){return this._anchor}set anchor(e){typeof e==`number`?this._anchor.set(e):this._anchor.copyFrom(e)}get width(){return this._width}set width(e){this._width=e,this.onViewUpdate()}get height(){return this._height}set height(e){this._height=e,this.onViewUpdate()}setSize(e,t){typeof e==`object`&&(t=e.height??e.width,e=e.width),this._width=e,this._height=t??e,this.onViewUpdate()}getSize(e){return e||={},e.width=this._width,e.height=this._height,e}get leftWidth(){return this._leftWidth}set leftWidth(e){this._leftWidth=e,this.onViewUpdate()}get topHeight(){return this._topHeight}set topHeight(e){this._topHeight=e,this.onViewUpdate()}get rightWidth(){return this._rightWidth}set rightWidth(e){this._rightWidth=e,this.onViewUpdate()}get bottomHeight(){return this._bottomHeight}set bottomHeight(e){this._bottomHeight=e,this.onViewUpdate()}get texture(){return this._texture}set texture(e){e||=W.EMPTY;let t=this._texture;t!==e&&(t&&t.dynamic&&t.off(`update`,this.onViewUpdate,this),e.dynamic&&e.on(`update`,this.onViewUpdate,this),this._texture=e,this.onViewUpdate())}get originalWidth(){return this._texture.width}get originalHeight(){return this._texture.height}destroy(e){if(super.destroy(e),typeof e==`boolean`?e:e?.texture){let t=typeof e==`boolean`?e:e?.textureSource;this._texture.destroy(t)}this._texture=null}updateBounds(){let e=this._bounds,t=this._anchor,n=this._width,r=this._height;e.minX=-t._x*n,e.maxX=e.minX+n,e.minY=-t._y*r,e.maxY=e.minY+r}};Ep.defaultOptions={texture:W.EMPTY};var Dp=Ep,Op=class extends Dp{constructor(...e){let t=e[0];t instanceof W&&(F(H,`NineSlicePlane now uses the options object {texture, leftWidth, rightWidth, topHeight, bottomHeight}`),t={texture:t,leftWidth:e[1],topHeight:e[2],rightWidth:e[3],bottomHeight:e[4]}),F(H,`NineSlicePlane is deprecated. Use NineSliceSprite instead.`),super(t)}};function kp(e){let{text:t,style:n,chars:r}=e,a=n,o=fr.getFont(t,a),s=xn(ur.graphemeSegmenter(t),a,o,!0),c=s.scale,l=[],u=[],d=[],f=n.lineHeight?n.lineHeight:o.lineHeight*c,p=0;for(let e of s.lines){if(e.chars.length===0)continue;let t=new i({label:`line`});t.y=p,d.push(t);let n=new i({label:`word`}),s=0;for(let d=0;d<e.chars.length;d++){let f=e.chars[d];if(!f||!o.chars[f])continue;let p=f===` `,m=d===e.chars.length-1,h;r.length>0?(h=r.shift(),h.text=f,h.style=a,h.label=`char-${f}`,h.x=e.charPositions[d]*c-e.charPositions[s]*c):h=new yf({text:f,style:a,label:`char-${f}`,x:e.charPositions[d]*c-e.charPositions[s]*c}),p||(l.push(h),n.addChild(h)),(p||m)&&n.children.length>0&&(n.x=e.charPositions[s]*c,u.push(n),t.addChild(n),n=new i({label:`word`}),s=d+1)}p+=f}return{chars:l,lines:d,words:u}}var Ap=class extends i{constructor(e){let{text:t,style:n,autoSplit:r,lineAnchor:i,wordAnchor:a,charAnchor:o,...s}=e;super(s),this._dirty=!1,this._canReuseChars=!1,this.chars=[],this.words=[],this.lines=[],this._originalText=t,this._autoSplit=r,this._lineAnchor=i,this._wordAnchor=a,this._charAnchor=o,this.style=n}split(){let e=this.splitFn();this.chars=e.chars,this.words=e.words,this.lines=e.lines,this.addChild(...this.lines),this.charAnchor=this._charAnchor,this.wordAnchor=this._wordAnchor,this.lineAnchor=this._lineAnchor,this._dirty=!1,this._canReuseChars=!0}get text(){return this._originalText}set text(e){this._originalText=e,this.lines.forEach(e=>e.destroy({children:!0})),this.lines.length=0,this.words.length=0,this.chars.length=0,this._canReuseChars=!1,this.onTextUpdate()}_setOrigin(e,t,n){let r;r=typeof e==`number`?{x:e,y:e}:{x:e.x,y:e.y},t.forEach(e=>{let t=e.getLocalBounds(),n=t.minX+t.width*r.x,i=t.minY+t.height*r.y;e.origin.set(n,i)}),this[n]=e}get lineAnchor(){return this._lineAnchor}set lineAnchor(e){this._setOrigin(e,this.lines,`_lineAnchor`)}get wordAnchor(){return this._wordAnchor}set wordAnchor(e){this._setOrigin(e,this.words,`_wordAnchor`)}get charAnchor(){return this._charAnchor}set charAnchor(e){this._setOrigin(e,this.chars,`_charAnchor`)}get style(){return this._style}set style(e){e||={},this._style=new Ci(e),this.words.forEach(e=>e.destroy()),this.words.length=0,this.lines.forEach(e=>e.destroy()),this.lines.length=0,this._canReuseChars=!0,this.onTextUpdate()}onTextUpdate(){this._dirty=!0,this._autoSplit&&this.split()}destroy(e){super.destroy(e),this.chars=[],this.words=[],this.lines=[],(typeof e==`boolean`?e:e?.style)&&this._style.destroy(e),this._style=null,this._originalText=``}},jp=class e extends Ap{constructor(t){let n={...e.defaultOptions,...t};super(n)}static from(t,n){return new e({...e.defaultOptions,...n,text:t.text,style:new Ci(t.style)})}splitFn(){return kp({text:this._originalText,style:this._style,chars:this._canReuseChars?this.chars:[]})}};jp.defaultOptions={autoSplit:!0,lineAnchor:0,wordAnchor:0,charAnchor:0};var Mp=jp;function Np(e,t,n){switch(e){case`center`:return(n-t)/2;case`right`:return n-t;case`left`:default:return 0}}function Pp(e){return e===`\r`||e===`
`||e===`\r
`}function Fp(e,t,n){let r=[],i=t.lines[0],a=``,o=[],s=0;return n.wordWrap=!1,e.forEach(e=>{let c=/^\s*$/.test(e),l=Pp(e),u=a.length===0&&c;if(c&&!l&&u)return;l||(a+=e);let d=ur.measureText(e,n);o.push({char:e,metric:d}),a.length>=i.length&&(r.push({line:a,chars:o,width:o.reduce((e,t)=>e+t.metric.width,0)}),o=[],a=``,s++,i=t.lines[s])}),r}function Ip(e){let{text:t,style:n,chars:r}=e,a=n,o=ur.measureText(t,a),s=Fp(ur.graphemeSegmenter(t),o,a.clone()),c=a.align,l=o.lineWidths.reduce((e,t)=>Math.max(e,t),0),u=[],d=[],f=[],p=0,m=a.stroke?.width||0,h=a.dropShadow?.distance||0;return s.forEach((e,t)=>{let n=new i({label:`line-${t}`});n.y=p,d.push(n);let s=o.lineWidths[t],g=Np(c,s,l),_=new i({label:`word`});_.x=g,e.chars.forEach((e,t)=>{if(e.metric.width!==0){if(Pp(e.char)){g+=e.metric.width-m;return}if(e.char===` `)_.children.length>0&&(f.push(_),n.addChild(_)),g+=e.metric.width+a.letterSpacing-m,_=new i({label:`word`}),_.x=g;else{let n;r.length>0?(n=r.shift(),n.text=e.char,n.style=a,n.setFromMatrix(ue.IDENTITY),n.x=g-_.x-h*t):n=new _f({text:e.char,style:a,x:g-_.x-h*t}),u.push(n),_.addChild(n),g+=e.metric.width+a.letterSpacing-m}}}),_.children.length>0&&(f.push(_),n.addChild(_)),p+=o.lineHeight}),{chars:u,lines:d,words:f}}var Lp=class e extends Ap{constructor(t){let n={...e.defaultOptions,...t};super(n)}static from(t,n){return new e({...e.defaultOptions,...n,text:t.text,style:new Ci(t.style)})}splitFn(){return Ip({text:this._originalText,style:this._style,chars:this._canReuseChars?this.chars:[]})}};Lp.defaultOptions={autoSplit:!0,lineAnchor:0,wordAnchor:0,charAnchor:0};var Rp=Lp,zp=[`align`,`breakWords`,`cssOverrides`,`fontVariant`,`fontWeight`,`leading`,`letterSpacing`,`lineHeight`,`padding`,`textBaseline`,`trim`,`whiteSpace`,`wordWrap`,`wordWrapWidth`,`fontFamily`,`fontStyle`,`fontSize`];function Bp(e){let t=[],n=0;for(let r=0;r<zp.length;r++){let i=`_${zp[r]}`;t[n++]=e[i]}return n=Hp(e._fill,t,n),n=Up(e._stroke,t,n),n=Wp(e.dropShadow,t,n),n=Vp(e.filters,t,n),t.join(`-`)}function Vp(e,t,n){if(!e)return n;for(let r of e)t[n++]=r.uid;return n}function Hp(e,t,n){return e?(t[n++]=e.color,t[n++]=e.alpha,t[n++]=e.fill?.styleKey,n):n}function Up(e,t,n){return e?(n=Hp(e,t,n),t[n++]=e.width,t[n++]=e.alignment,t[n++]=e.cap,t[n++]=e.join,t[n++]=e.miterLimit,n):n}function Wp(e,t,n){return e?(t[n++]=e.alpha,t[n++]=e.angle,t[n++]=e.blur,t[n++]=e.distance,t[n++]=o.shared.setValue(e.color).toNumber(),n):n}async function Gp(e,t,n=200){let r=await t.extract.base64(e);await t.encoder.commandFinished;let i=n;console.log(`logging texture ${e.source.width}px ${e.source.height}px`);let a=[`font-size: 1px;`,`padding: ${i}px 300px;`,`background: url(${r}) no-repeat;`,`background-size: contain;`].join(` `);console.log(`%c `,a)}var Kp=[`#000080`,`#228B22`,`#8B0000`,`#4169E1`,`#008080`,`#800000`,`#9400D3`,`#FF8C00`,`#556B2F`,`#8B008B`],qp=0;function Jp(e,t=0,n={color:`#000000`}){e.renderGroup&&(n.color=Kp[qp++]);let r=``;for(let e=0;e<t;e++)r+=`    `;let i=e.label;!i&&e instanceof _e&&(i=`sprite:${e.texture.label}`);let a=`%c ${r}|- ${i} (worldX:${e.worldTransform.tx}, relativeRenderX:${e.relativeGroupTransform.tx}, renderX:${e.groupTransform.tx}, localX:${e.x})`;e.renderGroup&&(a+=` (RenderGroup)`),e.filters&&(a+=`(*filters)`),console.log(a,`color:${n.color}; font-weight:bold;`),t++;for(let r=0;r<e.children.length;r++){let i=e.children[r];Jp(i,t,{...n})}}function Yp(e,t=0,n={index:0,color:`#000000`}){let r=``;for(let e=0;e<t;e++)r+=`    `;let i=`%c ${r}- ${n.index}: ${e.root.label} worldX:${e.worldTransform.tx}`;console.log(i,`color:${n.color}; font-weight:bold;`),t++;for(let r=0;r<e.renderGroupChildren.length;r++){let i=e.renderGroupChildren[r];Yp(i,t,{...n,index:r})}}R.add(nc,rc);export{zn as AbstractBitmapFont,so as AbstractRenderer,Ap as AbstractSplitText,hf as AbstractText,rn as AccessibilitySystem,Ld as AlphaFilter,ui as AlphaMask,ka as AlphaMaskPipe,df as AnimatedSprite,Rc as Application,Pa as ApplicationInitHook,Ql as Assets,Zl as AssetsClass,et as BLEND_TO_NPM,ss as BUFFER_TYPE,Kc as BackgroundLoader,Ua as BackgroundSystem,mt as Batch,jt as BatchGeometry,Ke as BatchTextureArray,Gi as BatchableGraphics,Nn as BatchableHTMLText,kr as BatchableMesh,Fe as BatchableSprite,lr as BatchableText,Bt as Batcher,ya as BatcherPipe,l as BigPool,Be as BindGroup,zs as BindGroupSystem,zc as BitmapFont,fr as BitmapFontManager,yf as BitmapText,Hn as BitmapTextGraphics,Yn as BitmapTextPipe,q as BlendModeFilter,Wa as BlendModePipe,Jd as BlurFilter,qd as BlurFilterPass,Xe as Bounds,be as BrowserAdapter,Pt as Buffer,Ce as BufferImageSource,fa as BufferResource,Ue as BufferUsage,io as CLEAR,G as Cache,cn as CanvasObserver,sa as CanvasPool,aa as CanvasPoolClass,Jt as CanvasSource,Or as CanvasTextGenerator,ur as CanvasTextMetrics,rr as CanvasTextPipe,Ar as CanvasTextSystem,bn as Circle,o as Color,uc as ColorBlend,dc as ColorBurnBlend,fc as ColorDodgeBlend,yn as ColorMask,ga as ColorMaskPipe,Zd as ColorMatrixFilter,tu as CompressedSource,i as Container,Td as Culler,Ed as CullerPlugin,pa as CustomRenderPipe,Du as D3D10_RESOURCE_DIMENSION,X as D3DFMT,ca as DATA_URI,Q as DDS,E as DEG_TO_RAD,Vf as DEPRECATED_SCALE_MODES,zf as DEPRECATED_WRAP_MODES,U as DOMAdapter,mn as DOMContainer,ln as DOMPipe,Rf as DRAW_MODES,Eu as DXGI_FORMAT,Z as DXGI_TO_TEXTURE_FORMAT,pc as DarkenBlend,Rt as DefaultBatcher,We as DefaultShader,mc as DifferenceBlend,tf as DisplacementFilter,hc as DivideBlend,Sr as DynamicBitmapFont,mi as Ellipse,tn as EventBoundary,Se as EventEmitter,on as EventSystem,sn as EventsTicker,gc as ExclusionBlend,C as ExtensionType,Xa as ExtractSystem,Ou as FOURCC_TO_TEXTURE_FORMAT,fn as FederatedContainer,dn as FederatedEvent,nn as FederatedMouseEvent,pn as FederatedPointerEvent,un as FederatedWheelEvent,Rr as FillGradient,er as FillPattern,Ft as Filter,Ht as FilterEffect,Fi as FilterPipe,Ri as FilterSystem,Dn as FontStylePromiseCache,Rd as GAUSSIAN_VALUES,ho as GL_FORMATS,Iu as GL_INTERNAL_FORMAT,Jo as GL_TARGETS,hs as GL_TYPES,as as GL_WRAP_MODES,Ha as GenerateTextureSystem,ot as Geometry,zo as GlBackBufferSystem,ps as GlBatchAdaptor,Wo as GlBuffer,$o as GlBufferSystem,Bo as GlColorMaskSystem,ds as GlContextSystem,To as GlEncoderSystem,Vo as GlGeometrySystem,us as GlGraphicsAdaptor,ls as GlLimitsSystem,is as GlMeshAdaptor,ji as GlParticleContainerAdaptor,mr as GlParticleContainerPipe,V as GlProgram,xo as GlProgramData,Eo as GlRenderTarget,xs as GlRenderTargetAdaptor,No as GlRenderTargetSystem,Fo as GlShaderSystem,bs as GlStateSystem,So as GlStencilSystem,_s as GlTexture,Qo as GlTextureSystem,_o as GlUboSystem,ys as GlUniformGroupSystem,h as GlobalResourceRegistry,Ba as GlobalUniformSystem,Es as GpuBatchAdaptor,Fs as GpuBlendModesToPixi,Ss as GpuBufferSystem,Ds as GpuColorMaskSystem,ws as GpuDeviceSystem,Ts as GpuEncoderSystem,Ks as GpuGraphicsAdaptor,_n as GpuGraphicsContext,ks as GpuLimitsSystem,Us as GpuMeshAdapter,js as GpuMipmapGenerator,Zn as GpuParticleContainerAdaptor,Wn as GpuParticleContainerPipe,B as GpuProgram,Is as GpuRenderTarget,Ls as GpuRenderTargetAdaptor,Hs as GpuRenderTargetSystem,Gs as GpuShaderSystem,Ps as GpuStateSystem,mo as GpuStencilModesToPixi,Zs as GpuStencilSystem,Rs as GpuTextureSystem,$s as GpuUboSystem,Xs as GpuUniformBatchPipe,Gn as Graphics,Pi as GraphicsContext,Yr as GraphicsContextRenderData,zi as GraphicsContextSystem,Nr as GraphicsGpuData,Ir as GraphicsPath,dr as GraphicsPipe,Df as HTMLText,sr as HTMLTextPipe,Qn as HTMLTextRenderData,Ef as HTMLTextStyle,hr as HTMLTextSystem,_c as HardLightBlend,vc as HardMixBlend,za as HelloSystem,wo as IGLUniformData,ar as ImageSource,Oe as InstructionSet,$ as KTX,yc as LightenBlend,bc as LinearBurnBlend,xc as LinearDodgeBlend,Sc as LinearLightBlend,al as Loader,K as LoaderParserPriority,Cc as LuminosityBlend,$e as MaskEffectManager,Ne as MaskEffectManagerClass,no as MaskFilter,ue as Matrix,uf as Mesh,Xi as MeshGeometry,Kn as MeshGpuData,jr as MeshPipe,pp as MeshPlane,_p as MeshRope,vp as MeshSimple,w as NOOP,wc as NegationBlend,Vi as NineSliceGeometry,Op as NineSlicePlane,Dp as NineSliceSprite,Ur as NineSliceSpriteGpuData,hi as NineSliceSpritePipe,of as NoiseFilter,P as ObservablePoint,Tc as OverlayBlend,ne as PI_2,xp as Particle,Dr as ParticleBuffer,Tp as ParticleContainer,ia as ParticleContainerPipe,Cn as ParticleShader,Mi as PassthroughFilter,fp as PerspectiveMesh,up as PerspectivePlaneGeometry,Ec as PinLightBlend,As as PipelineSystem,Kr as PlaneGeometry,v as Point,kn as Polygon,ye as Pool,Gt as PoolGroupClass,lf as PrepareBase,vf as PrepareQueue,kf as PrepareSystem,Of as PrepareUpload,Pr as QuadGeometry,pe as RAD_TO_DEG,Tt as Rectangle,Kf as RenderContainer,D as RenderGroup,uo as RenderGroupPipe,lo as RenderGroupSystem,Qf as RenderLayer,Ja as RenderTarget,Ca as RenderTargetSystem,to as RenderTexture,Ia as RenderableGCSystem,Ta as RendererInitHook,wt as RendererType,Ln as ResizePlugin,Xn as Resolver,hp as RopeGeometry,Mn as RoundedRectangle,Hf as SCALE_MODES,Pe as STENCIL_MODES,Ei as SVGParser,Dc as SaturationBlend,co as SchedulerSystem,Nf as ScissorMask,br as SdfShader,Ye as Shader,b as ShaderStage,Ki as ShapePath,oo as SharedRenderPipes,Za as SharedSystems,Oc as SoftLightBlend,Mp as SplitBitmapText,Rp as SplitText,_e as Sprite,Fa as SpritePipe,Pn as Spritesheet,Ve as State,pi as StencilMask,Aa as StencilMaskPipe,kc as SubtractBlend,Qa as SystemRunner,ku as TEXTURE_FORMAT_BLOCK_SIZE,_f as Text,Ci as TextStyle,W as Texture,Ga as TextureGCSystem,s as TextureMatrix,M as TexturePool,me as TexturePoolClass,Ee as TextureSource,S as TextureStyle,Uf as TextureUvs,p as Ticker,ce as TickerListener,Er as TickerPlugin,mf as TilingSprite,Zr as TilingSpriteGpuData,Di as TilingSpritePipe,Wi as TilingSpriteShader,ff as Transform,tc as Triangle,vo as UNIFORM_TO_ARRAY_SETTERS,vs as UNIFORM_TO_SINGLE_SETTERS,Me as UNIFORM_TYPES_MAP,Vt as UNIFORM_TYPES_VALUES,lt as UPDATE_BLEND,N as UPDATE_COLOR,dt as UPDATE_PRIORITY,oe as UPDATE_TRANSFORM,de as UPDATE_VISIBLE,Bs as UboBatch,Ea as UboSystem,tt as UniformGroup,Va as VERSION,jn as VideoSource,g as ViewContainer,ro as ViewSystem,Zt as ViewableBuffer,Ac as VividLightBlend,Os as WGSL_ALIGN_SIZE_DATA,Io as WGSL_TO_STD40_SIZE,Bf as WRAP_MODES,ms as WebGLRenderer,Js as WebGPURenderer,Nd as WebWorkerAdapter,Il as WorkerManager,hn as accessibilityTarget,a as addBits,nr as addMaskBounds,$n as addMaskLocalBounds,Je as addProgramDefines,Pd as alphaFrag,Fd as alphaWgsl,Li as appendSVGPath,ri as applyMatrix,$f as applyProjectiveTransformationToPlane,ns as applyStyleParams,y as assignWithIgnore,La as autoDetectEnvironment,Ic as autoDetectRenderer,gr as autoDetectSource,mu as basisTranscoderUrls,At as bgr2rgb,Wc as bitmapFontCachePlugin,Bc as bitmapFontTextParser,Vc as bitmapFontXMLParser,Hc as bitmapFontXMLStringParser,kp as bitmapTextSplit,ic as blendTemplateFrag,ac as blendTemplateVert,oc as blendTemplateWgsl,Ns as blockDataMap,Wd as blurTemplateWgsl,zt as boundsPool,nc as browserExt,yr as buildAdaptiveBezier,Yi as buildAdaptiveQuadratic,En as buildArc,_r as buildArcTo,Qi as buildArcToSvg,ii as buildCircle,Si as buildContextBatches,ti as buildEllipse,Xf as buildGeometryFromPath,qr as buildLine,Hi as buildPixelLine,Wr as buildPolygon,Ii as buildRectangle,Fr as buildRoundedRectangle,Vr as buildSimpleUvs,Ti as buildTriangle,Zi as buildUvs,ge as cacheAsTextureMixin,qc as cacheTextureArray,Gr as calculatePathArea,Sa as calculateProjection,Ip as canvasTextSplit,It as checkChildrenDidChange,ol as checkDataUrl,J as checkExtension,Ui as checkForNestedPattern,Et as checkMaxIfStatementsInShader,ze as childrenHelperMixin,$a as cleanArray,ao as cleanHash,da as clearList,Oi as closePointEps,qf as collectAllRenderables,Xt as collectRenderablesMixin,xt as color32BitToUniform,c as colorBit,Wt as colorBitGl,Yd as colorMatrixFilterFrag,Xd as colorMatrixFilterWgsl,Mt as colorToUniform,gs as compareModeToGlCompare,le as compileHighShader,_ as compileHighShaderGl,ve as compileHighShaderGlProgram,m as compileHighShaderGpuProgram,Qt as compileHooks,fe as compileInputs,te as compileOutputs,jo as compileShader,lp as compute2DProjection,cd as convertFormatIfRequired,Cr as convertToList,Un as copySearchParams,bt as createIdFromString,Jn as createIndicesForQuads,xu as createLevelBuffers,ud as createLevelBuffersFromKTX,Sn as createStringVariations,Sl as createTexture,Ro as createUboElementsSTD40,Cs as createUboElementsWGSL,_a as createUboSyncFunction,Lo as createUboSyncFunctionSTD40,Ms as createUboSyncFunctionWGSL,Wl as crossOrigin,$t as cullingMixin,yi as curveEps,wi as defaultFilterVert,ko as defaultValue,j as definedProps,F as deprecation,Yc as detectAvif,eu as detectBasis,xd as detectCompressed,Zc as detectDefaults,el as detectMp4,tl as detectOgv,On as detectVideoAlphaMode,nl as detectWebm,rl as detectWebp,Kl as determineCrossOrigin,Qd as displacementFrag,$d as displacementVert,ef as displacementWgsl,ft as earcut,nt as effectsMixin,ua as ensureAttributes,Ct as ensureIsBuffer,e as ensurePrecision,gf as ensureTextOptions,Oa as executeInstructions,R as extensions,go as extractAttributesFromGlProgram,Dt as extractAttributesFromGpuProgram,li as extractFontFamilies,A as extractStructAndGroups,_i as extractSubpaths,bi as extractSvgUrlId,Ut as fastCopy,gt as findMixin,gn as fontStringFromTextStyle,Mf as formatShader,n as fragmentGPUTemplate,st as fragmentGlTemplate,Co as generateArraySyncSTD40,Qs as generateArraySyncWGSL,Bd as generateBlurFragSource,Ud as generateBlurGlProgram,Gd as generateBlurProgram,Hd as generateBlurVertSource,Af as generateGPULayout,we as generateGpuLayoutGroups,jf as generateLayout,xe as generateLayoutHash,Rn as generateParticleUpdateFunction,bo as generateProgram,Do as generateShaderSyncCode,Bp as generateTextStyleKey,Kt as generateTextureBatchBit,he as generateTextureBatchBitGl,si as generateTextureMatrix,Po as generateUniformsSync,rt as getAdjustedBlendModeBlend,O as getAttributeInfoFromFormat,ht as getBatchSamplersUniformGroup,xn as getBitmapTextLayout,Xr as getCanvasBoundingBox,Mr as getCanvasFillStyle,qa as getCanvasTexture,Qe as getDefaultUniformValue,Gf as getFastGlobalBounds,pt as getFastGlobalBoundsMixin,Jr as getFillInstructionData,ir as getFontCss,_l as getFontFamilyName,Le as getGeometryBounds,Mo as getGlTypeFromFormat,Nt as getGlobalBounds,at as getGlobalMixin,xi as getGlobalRenderableBounds,yt as getLocalBounds,Lt as getMaxFragmentPrecision,Ze as getMaxTexturesPerBatch,Qr as getOrientationOfPoints,Bi as getPo2TextureFromSource,xl as getResolutionOfUrl,An as getSVGUrl,su as getSupportedCompressedTextureFormats,au as getSupportedGPUCompressedTextureFormats,ru as getSupportedGlCompressedTextureFormats,uu as getSupportedTextureFormats,vr as getTemporaryCanvasFromImage,_t as getTestContext,oa as getTextureBatchBindGroup,yp as getTextureDefaultMatrix,hd as getTextureFormatFromKTXTexture,ts as getUboData,Ao as getUniformData,pr as getUrlExtension,fd as glFormatToGPUFormat,Ho as glUploadBufferImageResource,Xo as glUploadCompressedTextureResource,Zo as glUploadImageResource,rs as glUploadVideoResource,d as globalUniformsBit,se as globalUniformsBitGl,ut as globalUniformsUBOBitGl,Cu as gpuFormatToBasisTranscoderFormat,_d as gpuFormatToKTXBasisTranscoderFormat,Ys as gpuUploadBufferImageResource,Vs as gpuUploadCompressedTextureResource,qs as gpuUploadImageResource,Ws as gpuUploadVideoResource,z as groupD8,xa as hasCachedCanvasTexture,sf as hslWgsl,cc as hslgl,lc as hslgpu,T as injectBits,I as insertVersion,an as isMobile,Ot as isPow2,la as isRenderingToScreen,tr as isSafari,ra as isSingleItem,Mc as isWebGLSupported,Pc as isWebGPUSupported,ed as ktxTranscoderUrls,bu as loadBasis,yu as loadBasisOnWorker,Gc as loadBitmapFont,Fu as loadDDS,eo as loadEnvironmentExtensions,vn as loadFontAsBase64,fi as loadFontCSS,zl as loadImageBitmap,ll as loadJson,Xu as loadKTX,od as loadKTX2,ad as loadKTX2onWorker,qi as loadSVGImage,Tl as loadSvg,Bl as loadTextures,fl as loadTxt,Jl as loadVideoTextures,bl as loadWebFont,vt as localUniformBit,kt as localUniformBitGl,it as localUniformBitGroup2,qn as localUniformMSDFBit,Ai as localUniformMSDFBitGl,k as log2,Gp as logDebugTexture,yo as logProgramError,Yp as logRenderGroupScene,Jp as logScene,Tr as mSDFBit,In as mSDFBitGl,Ko as mapFormatToGlFormat,fs as mapFormatToGlInternalFormat,os as mapFormatToGlType,es as mapGlToVertexFormat,If as mapSize,Oo as mapType,Go as mapWebGLBlendModesToPixi,Ma as maskFrag,Na as maskVert,va as maskWgsl,Ge as matrixPool,wn as measureHtmlText,qe as measureMixin,Pf as migrateFragmentFromV7toV8,qo as mipmapScaleModeToGlFilter,Ie as multiplyColors,St as multiplyHexColors,ke as nextPow2,nf as noiseFrag,rf as noiseWgsl,cu as nonCompressedFormats,Te as normalizeExtensionPriority,t as onRenderMixin,Au as parseDDS,Wf as parseFunctionBody,Gu as parseKTX,ai as parseSVGDefinitions,ni as parseSVGFloatAttribute,di as parseSVGPath,$r as parseSVGStyle,Sp as particleData,xr as particlesFrag,Vn as particlesVert,wr as particlesWgsl,Lr as passthroughFrag,oi as passthroughWgsl,Bn as path,ec as pointInTriangle,Gl as preloadVideo,qt as removeItems,ee as removeStructAndGroupDuplicates,ct as resetUids,na as resolveCharacters,yd as resolveCompressedTextureUrl,Xl as resolveJsonUrl,Yl as resolveTextureUrl,Tn as resourceToTexture,Yt as roundPixelsBit,Re as roundPixelsBitGl,ta as roundedShapeArc,Hr as roundedShapeQuadraticCurve,Ya as sayHello,Yo as scaleModeToGlFilter,hu as setBasisTranscoderPath,td as setKTXTranscoderPath,ei as setPositions,Ae as setProgramName,vi as setUvs,Ni as shapeBuilders,L as sortMixin,cr as spritesheetAsset,or as squaredDistanceToLineSegment,De as stripVersion,ki as styleAttributes,Jc as testImageFormat,$c as testVideoFormat,bf as textStyleToCSS,ja as textureBit,ha as textureBitGl,Ji as textureFrom,$i as tilingBit,Br as tilingBitGl,ci as toFillStyle,je as toLocalGlobalMixin,zr as toStrokeStyle,ea as transformVertices,gi as triangulateWithHoles,wa as uboSyncFunctionsSTD40,ma as uboSyncFunctionsWGSL,ie as uid,ba as uniformParsers,Uo as unpremultiplyAlpha,Ka as unsafeEvalSupported,Jf as updateLocalTransform,u as updateQuadBounds,Ra as updateRenderGroupTransform,fo as updateRenderGroupTransforms,Fn as updateTextBounds,Da as updateTransformAndChildren,He as updateTransformBackwards,Yf as updateWorldTransform,H as v8_0_0,r as v8_3_4,vd as validFormats,po as validateRenderables,re as vertexGPUTemplate,ae as vertexGlTemplate,md as vkFormatToGPUFormat,f as warn,rc as webworkerExt,cs as wrapModeToGlAddress};